
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PEP 622 – Structural Pattern Matching &#8212; peps.python.org</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="PEP 623 – Remove wstr from Unicode" href="../pep-0623/" />
    <link rel="prev" title="PEP 621 – Storing project metadata in pyproject.toml" href="../pep-0621/" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pep-622-structural-pattern-matching">
<h1 class="page-title">PEP 622 – Structural Pattern Matching<a class="headerlink" href="#pep-622-structural-pattern-matching" title="Permalink to this headline">¶</a></h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd"><p>622</p>
</dd>
<dt class="field-even">Title</dt>
<dd class="field-even"><p>Structural Pattern Matching</p>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Brandt Bucher &lt;<a class="reference external" href="mailto:brandt&#37;&#52;&#48;python&#46;org?subject=PEP%20-1">brandt&#32;&#97;t&#32;python.org</a>&gt;,
Daniel F Moisset &lt;<a class="reference external" href="mailto:dfmoisset&#37;&#52;&#48;gmail&#46;com?subject=PEP%20-1">dfmoisset&#32;&#97;t&#32;gmail.com</a>&gt;,
Tobias Kohn &lt;<a class="reference external" href="mailto:kohnt&#37;&#52;&#48;tobiaskohn&#46;ch?subject=PEP%20-1">kohnt&#32;&#97;t&#32;tobiaskohn.ch</a>&gt;,
Ivan Levkivskyi &lt;<a class="reference external" href="mailto:levkivskyi&#37;&#52;&#48;gmail&#46;com?subject=PEP%20-1">levkivskyi&#32;&#97;t&#32;gmail.com</a>&gt;,
Guido van Rossum &lt;<a class="reference external" href="mailto:guido&#37;&#52;&#48;python&#46;org?subject=PEP%20-1">guido&#32;&#97;t&#32;python.org</a>&gt;,
Talin &lt;<a class="reference external" href="mailto:viridia&#37;&#52;&#48;gmail&#46;com?subject=PEP%20-1">viridia&#32;&#97;t&#32;gmail.com</a>&gt;</p>
</dd>
<dt class="field-even">BDFL-Delegate</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">Discussions-To</dt>
<dd class="field-odd"><p>Python-Dev &lt;<a class="reference external" href="mailto:python-dev&#37;&#52;&#48;python&#46;org">python-dev<span>&#64;</span>python<span>&#46;</span>org</a>&gt;</p>
</dd>
<dt class="field-even">Status</dt>
<dd class="field-even"><p>Superseded</p>
</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Standards Track</p>
</dd>
<dt class="field-even">Created</dt>
<dd class="field-even"><p>23-Jun-2020</p>
</dd>
<dt class="field-odd">Python-Version</dt>
<dd class="field-odd"><p>3.10</p>
</dd>
<dt class="field-even">Post-History</dt>
<dd class="field-even"><p>23-Jun-2020, 8-Jul-2020</p>
</dd>
<dt class="field-odd">Superseded-By</dt>
<dd class="field-odd"><p><a class="reference external" href="pep-0634.html">634</a></p>
</dd>
</dl>
<hr class="docutils" />
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#abstract" id="id33">Abstract</a></p>
<ul>
<li><p><a class="reference internal" href="#patterns-and-shapes" id="id34">Patterns and shapes</a></p></li>
<li><p><a class="reference internal" href="#syntax" id="id35">Syntax</a></p></li>
<li><p><a class="reference internal" href="#motivation" id="id36">Motivation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#overview" id="id37">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#pattern-a-new-syntactic-construct-and-destructuring" id="id38">Pattern, a new syntactic construct, and destructuring</a></p></li>
<li><p><a class="reference internal" href="#matching-process" id="id39">Matching process</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rationale-and-goals" id="id40">Rationale and Goals</a></p></li>
<li><p><a class="reference internal" href="#syntax-and-semantics" id="id41">Syntax and Semantics</a></p>
<ul>
<li><p><a class="reference internal" href="#patterns" id="id42">Patterns</a></p></li>
<li><p><a class="reference internal" href="#the-match-statement" id="id43">The <code class="docutils literal notranslate"><span class="pre">match</span></code> statement</a></p></li>
<li><p><a class="reference internal" href="#match-semantics" id="id44">Match semantics</a></p></li>
<li><p><a class="reference internal" href="#allowed-patterns" id="id45">Allowed patterns</a></p>
<ul>
<li><p><a class="reference internal" href="#literal-patterns" id="id46">Literal Patterns</a></p></li>
<li><p><a class="reference internal" href="#capture-patterns" id="id47">Capture Patterns</a></p></li>
<li><p><a class="reference internal" href="#wildcard-pattern" id="id48">Wildcard Pattern</a></p></li>
<li><p><a class="reference internal" href="#constant-value-patterns" id="id49">Constant Value Patterns</a></p></li>
<li><p><a class="reference internal" href="#sequence-patterns" id="id50">Sequence Patterns</a></p></li>
<li><p><a class="reference internal" href="#mapping-patterns" id="id51">Mapping Patterns</a></p></li>
<li><p><a class="reference internal" href="#class-patterns" id="id52">Class Patterns</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#combining-multiple-patterns-or-patterns" id="id53">Combining multiple patterns (OR patterns)</a></p></li>
<li><p><a class="reference internal" href="#guards" id="id54">Guards</a></p></li>
<li><p><a class="reference internal" href="#walrus-patterns" id="id55">Walrus patterns</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#runtime-specification" id="id56">Runtime specification</a></p>
<ul>
<li><p><a class="reference internal" href="#the-match-protocol" id="id57">The Match Protocol</a></p></li>
<li><p><a class="reference internal" href="#overlapping-sub-patterns" id="id58">Overlapping sub-patterns</a></p></li>
<li><p><a class="reference internal" href="#special-attribute-match-args" id="id59">Special attribute <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code></a></p></li>
<li><p><a class="reference internal" href="#exceptions-and-side-effects" id="id60">Exceptions and side effects</a></p></li>
<li><p><a class="reference internal" href="#the-standard-library" id="id61">The standard library</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#static-checkers-specification" id="id62">Static checkers specification</a></p>
<ul>
<li><p><a class="reference internal" href="#exhaustiveness-checks" id="id63">Exhaustiveness checks</a></p></li>
<li><p><a class="reference internal" href="#sealed-classes-as-algebraic-data-types" id="id64">Sealed classes as algebraic data types</a></p></li>
<li><p><a class="reference internal" href="#type-erasure" id="id65">Type erasure</a></p></li>
<li><p><a class="reference internal" href="#note-about-constants" id="id66">Note about constants</a></p></li>
<li><p><a class="reference internal" href="#precise-type-checking-of-star-matches" id="id67">Precise type checking of star matches</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance-considerations" id="id68">Performance Considerations</a></p></li>
<li><p><a class="reference internal" href="#backwards-compatibility" id="id69">Backwards Compatibility</a></p></li>
<li><p><a class="reference internal" href="#impacts-on-third-party-tools" id="id70">Impacts on third-party tools</a></p></li>
<li><p><a class="reference internal" href="#reference-implementation" id="id71">Reference Implementation</a></p></li>
<li><p><a class="reference internal" href="#example-code" id="id72">Example Code</a></p></li>
<li><p><a class="reference internal" href="#rejected-ideas" id="id73">Rejected Ideas</a></p>
<ul>
<li><p><a class="reference internal" href="#don-t-do-this-pattern-matching-is-hard-to-learn" id="id74">Don’t do this, pattern matching is hard to learn</a></p></li>
<li><p><a class="reference internal" href="#don-t-do-this-use-existing-method-dispatching-mechanisms" id="id75">Don’t do this, use existing method dispatching mechanisms</a></p></li>
<li><p><a class="reference internal" href="#allow-more-flexible-assignment-targets-instead" id="id76">Allow more flexible assignment targets instead</a></p></li>
<li><p><a class="reference internal" href="#make-it-an-expression" id="id77">Make it an expression</a></p></li>
<li><p><a class="reference internal" href="#use-a-hard-keyword" id="id78">Use a hard keyword</a></p></li>
<li><p><a class="reference internal" href="#use-as-or-instead-of-case-for-case-clauses" id="id79">Use <code class="docutils literal notranslate"><span class="pre">as</span></code> or <code class="docutils literal notranslate"><span class="pre">|</span></code> instead of <code class="docutils literal notranslate"><span class="pre">case</span></code> for case clauses</a></p></li>
<li><p><a class="reference internal" href="#use-a-flat-indentation-scheme" id="id80">Use a flat indentation scheme</a></p></li>
<li><p><a class="reference internal" href="#alternatives-for-constant-value-pattern" id="id81">Alternatives for constant value pattern</a></p></li>
<li><p><a class="reference internal" href="#disallow-float-literals-in-patterns" id="id82">Disallow float literals in patterns</a></p></li>
<li><p><a class="reference internal" href="#range-matching-patterns" id="id83">Range matching patterns</a></p></li>
<li><p><a class="reference internal" href="#use-dispatch-dict-semantics-for-matches" id="id84">Use dispatch dict semantics for matches</a></p></li>
<li><p><a class="reference internal" href="#use-continue-and-break-in-case-clauses" id="id85">Use <code class="docutils literal notranslate"><span class="pre">continue</span></code> and <code class="docutils literal notranslate"><span class="pre">break</span></code> in case clauses.</a></p></li>
<li><p><a class="reference internal" href="#and-patterns" id="id86">AND (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>) patterns</a></p></li>
<li><p><a class="reference internal" href="#negative-match-patterns" id="id87">Negative match patterns</a></p></li>
<li><p><a class="reference internal" href="#check-exhaustiveness-at-runtime" id="id88">Check exhaustiveness at runtime</a></p></li>
<li><p><a class="reference internal" href="#type-annotations-for-pattern-variables" id="id89">Type annotations for pattern variables</a></p></li>
<li><p><a class="reference internal" href="#allow-rest-in-class-patterns" id="id90">Allow <code class="docutils literal notranslate"><span class="pre">*rest</span></code> in class patterns</a></p></li>
<li><p><a class="reference internal" href="#disallow-a-in-constant-value-patterns" id="id91">Disallow <code class="docutils literal notranslate"><span class="pre">_.a</span></code> in constant value patterns</a></p></li>
<li><p><a class="reference internal" href="#use-some-other-token-as-wildcard" id="id92">Use some other token as wildcard</a></p></li>
<li><p><a class="reference internal" href="#use-some-other-syntax-instead-of-for-or-patterns" id="id93">Use some other syntax instead of <code class="docutils literal notranslate"><span class="pre">|</span></code> for OR patterns</a></p></li>
<li><p><a class="reference internal" href="#add-an-else-clause" id="id94">Add an <code class="docutils literal notranslate"><span class="pre">else</span></code> clause</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#deferred-ideas" id="id95">Deferred Ideas</a></p>
<ul>
<li><p><a class="reference internal" href="#one-off-syntax-variant" id="id96">One-off syntax variant</a></p></li>
<li><p><a class="reference internal" href="#other-pattern-based-constructions" id="id97">Other pattern-based constructions</a></p></li>
<li><p><a class="reference internal" href="#algebraic-matching-of-repeated-names" id="id98">Algebraic matching of repeated names</a></p></li>
<li><p><a class="reference internal" href="#custom-matching-protocol" id="id99">Custom matching protocol</a></p></li>
<li><p><a class="reference internal" href="#parameterized-matching-syntax" id="id100">Parameterized Matching Syntax</a></p></li>
<li><p><a class="reference internal" href="#pattern-utility-library" id="id101">Pattern Utility Library</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#acknowledgments" id="id102">Acknowledgments</a></p></li>
<li><p><a class="reference internal" href="#version-history" id="id103">Version History</a></p></li>
<li><p><a class="reference internal" href="#references" id="id104">References</a></p></li>
<li><p><a class="reference internal" href="#appendix-a-full-grammar" id="id105">Appendix A – Full Grammar</a></p></li>
<li><p><a class="reference internal" href="#copyright" id="id106">Copyright</a></p></li>
</ul>
</div>
<section id="abstract">
<h2><a class="toc-backref" href="#id33">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This PEP proposes to add a <strong>pattern matching statement</strong> to Python,
inspired by similar syntax found in Scala, Erlang, and other languages.</p>
<section id="patterns-and-shapes">
<h3><a class="toc-backref" href="#id34">Patterns and shapes</a><a class="headerlink" href="#patterns-and-shapes" title="Permalink to this headline">¶</a></h3>
<p>The <strong>pattern syntax</strong> builds on Python’s existing syntax for sequence
unpacking (e.g., <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span> <span class="pre">=</span> <span class="pre">value</span></code>).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">match</span></code> statement compares a value (the <strong>subject</strong>)
to several different shapes (the <strong>patterns</strong>) until a shape fits.
Each pattern describes the type and structure of the accepted values
as well as the variables where to capture its contents.</p>
<p>Patterns can specify the shape to be:</p>
<ul class="simple">
<li><p>a sequence to be unpacked, as already mentioned</p></li>
<li><p>a mapping with specific keys</p></li>
<li><p>an instance of a given class with (optionally) specific attributes</p></li>
<li><p>a specific value</p></li>
<li><p>a wildcard</p></li>
</ul>
<p>Patterns can be composed in several ways.</p>
</section>
<section id="syntax">
<h3><a class="toc-backref" href="#id35">Syntax</a><a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<p>Syntactically, a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement contains:</p>
<ul class="simple">
<li><p>a <em>subject</em> expression</p></li>
<li><p>one or more <code class="docutils literal notranslate"><span class="pre">case</span></code> clauses</p></li>
</ul>
<p>Each <code class="docutils literal notranslate"><span class="pre">case</span></code> clause specifies:</p>
<ul class="simple">
<li><p>a pattern (the overall shape to be matched)</p></li>
<li><p>an optional “guard” (a condition to be checked if the pattern matches)</p></li>
<li><p>a code block to be executed if the case clause is selected</p></li>
</ul>
</section>
<section id="motivation">
<h3><a class="toc-backref" href="#id36">Motivation</a><a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h3>
<p>The rest of the PEP:</p>
<ul class="simple">
<li><p>motivates why we believe pattern matching makes a good addition to Python</p></li>
<li><p>explains our design choices</p></li>
<li><p>contains a precise syntactic and runtime specification</p></li>
<li><p>gives guidance for static type checkers (and one small addition to the <code class="docutils literal notranslate"><span class="pre">typing</span></code> module)</p></li>
<li><p>discusses the main objections and alternatives that have been
brought up during extensive discussion of the proposal, both within
the group of authors and in the python-dev community</p></li>
</ul>
<p>Finally, we discuss some possible extensions that might be considered
in the future, once the community has ample experience with the
currently proposed syntax and semantics.</p>
</section>
</section>
<section id="overview">
<span id="id1"></span><h2><a class="toc-backref" href="#id37">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Patterns are a new syntactical category with their own rules
and special cases. Patterns mix input (given values) and output
(captured variables) in novel ways. They may take a little time to
use effectively. The authors have provided
a brief introduction to the basic concepts here. Note that this section
is not intended to be complete or entirely accurate.</p>
<section id="pattern-a-new-syntactic-construct-and-destructuring">
<h3><a class="toc-backref" href="#id38">Pattern, a new syntactic construct, and destructuring</a><a class="headerlink" href="#pattern-a-new-syntactic-construct-and-destructuring" title="Permalink to this headline">¶</a></h3>
<p>A new syntactic construct called <strong>pattern</strong> is introduced in this
PEP. Syntactically, patterns look like a subset of expressions.
The following are examples of patterns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[first,</span> <span class="pre">second,</span> <span class="pre">*rest]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Point2d(x,</span> <span class="pre">0)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{&quot;name&quot;:</span> <span class="pre">&quot;Bruce&quot;,</span> <span class="pre">&quot;age&quot;:</span> <span class="pre">age}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">42</span></code></p></li>
</ul>
<p>The above expressions may look like examples of object construction
with a constructor which takes some values as parameters and
builds an object from those components.</p>
<p>When viewed as a pattern, the above patterns mean the inverse operation of
construction, which we call <strong>destructuring</strong>. <strong>Destructuring</strong> takes a subject value
and extracts its components.</p>
<p>The syntactic similarity between object construction and destructuring is
intentional. It also follows the existing
Pythonic style of contexts which makes assignment targets (write contexts) look
like expressions (read contexts).</p>
<p>Pattern matching never creates objects. This is in the same way that
<code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b]</span> <span class="pre">=</span> <span class="pre">my_list</span></code> doesn’t create a
new <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b]</span></code> list, nor reads the values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</section>
<section id="matching-process">
<h3><a class="toc-backref" href="#id39">Matching process</a><a class="headerlink" href="#matching-process" title="Permalink to this headline">¶</a></h3>
<p>During this matching process,
the structure of the pattern may not fit the subject, and matching <em>fails</em>.</p>
<p>For example, matching the pattern <code class="docutils literal notranslate"><span class="pre">Point2d(x,</span> <span class="pre">0)</span></code> to the subject
<code class="docutils literal notranslate"><span class="pre">Point2d(3,</span> <span class="pre">0)</span></code> successfully matches. The match also <strong>binds</strong>
the pattern’s free variable <code class="docutils literal notranslate"><span class="pre">x</span></code> to the subject’s value <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
<p>As another example, if the subject is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">0]</span></code>, the match fails
because the subject’s type <code class="docutils literal notranslate"><span class="pre">list</span></code> is not the pattern’s <code class="docutils literal notranslate"><span class="pre">Point2d</span></code>.</p>
<p>As a third example, if the subject is
<code class="docutils literal notranslate"><span class="pre">Point2d(3,</span> <span class="pre">7)</span></code>, the match fails because the
subject’s second coordinate <code class="docutils literal notranslate"><span class="pre">7</span></code> is not the same as the pattern’s <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">match</span></code> statement tries to match a single subject to each of the
patterns in its <code class="docutils literal notranslate"><span class="pre">case</span></code> clauses. At the first
successful match to a pattern in a <code class="docutils literal notranslate"><span class="pre">case</span></code> clause:</p>
<ul class="simple">
<li><p>the variables in the pattern are assigned, and</p></li>
<li><p>a corresponding block is executed.</p></li>
</ul>
<p>Each <code class="docutils literal notranslate"><span class="pre">case</span></code> clause can also specify an optional boolean condition,
known as a <strong>guard</strong>.</p>
<p>Let’s look at a more detailed example of a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement. The
<code class="docutils literal notranslate"><span class="pre">match</span></code> statement is used within a function to define the building
of 3D points. In this example, the function can accept as input any of
the following: tuple with 2 elements, tuple with 3 elements, an
existing Point2d object or an existing Point3d object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_point_3d</span><span class="p">(</span><span class="n">pt</span><span class="p">):</span>
    <span class="n">match</span> <span class="n">pt</span><span class="p">:</span>
        <span class="n">case</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Point3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">case</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Point3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">case</span> <span class="n">Point2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Point3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">case</span> <span class="n">Point3d</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pt</span>
        <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;not a point we support&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Without pattern matching, this function’s implementation would require several
<code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> checks, one or two <code class="docutils literal notranslate"><span class="pre">len()</span></code> calls, and a more
convoluted control flow. The <code class="docutils literal notranslate"><span class="pre">match</span></code> example version and the traditional
Python version without <code class="docutils literal notranslate"><span class="pre">match</span></code> translate into similar code under the hood.
With familiarity of pattern matching, a user reading this function using <code class="docutils literal notranslate"><span class="pre">match</span></code>
will likely find this version clearer than the traditional approach.</p>
</section>
</section>
<section id="rationale-and-goals">
<h2><a class="toc-backref" href="#id40">Rationale and Goals</a><a class="headerlink" href="#rationale-and-goals" title="Permalink to this headline">¶</a></h2>
<p>Python programs frequently need to handle data which varies in type,
presence of attributes/keys, or number of elements. Typical examples
are operating on nodes of a mixed structure like an AST, handling UI
events of different types, processing structured input (like
structured files or network messages), or “parsing” arguments for a
function that can accept different combinations of types and numbers
of parameters. In fact, the classic ‘visitor’ pattern is an example of this,
done in an OOP style – but matching makes it much less tedious to write.</p>
<p>Much of the code to do so tends to consist of complex chains of nested
<code class="docutils literal notranslate"><span class="pre">if</span></code>/<code class="docutils literal notranslate"><span class="pre">elif</span></code> statements, including multiple calls to <code class="docutils literal notranslate"><span class="pre">len()</span></code>,
<code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> and index/key/attribute access. Inside those branches
users sometimes need to destructure the data further to extract the
required component values, which may be nested several objects deep.</p>
<p>Pattern matching as present in many other languages provides an
elegant solution to this problem. These range from statically compiled
functional languages like F# and Haskell, via mixed-paradigm languages
like Scala <a class="footnote-reference brackets" href="#id23" id="id2">4</a> and Rust <a class="footnote-reference brackets" href="#id22" id="id3">3</a>, to dynamic languages like Elixir and
Ruby, and is under consideration for JavaScript. We are indebted to
these languages for guiding the way to Pythonic pattern matching, as
Python is indebted to so many other languages for many of its
features: many basic syntactic features were inherited from C,
exceptions from Modula-3, classes were inspired by C++, slicing came
from Icon, regular expressions from Perl, decorators resemble Java
annotations, and so on.</p>
<p>The usual logic for operating on heterogeneous data can be summarized
in the following way:</p>
<ul class="simple">
<li><p>Some analysis is done on the <em>shape</em> (type and components) of the
data: This could involve <code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> or <code class="docutils literal notranslate"><span class="pre">len()</span></code> calls and/or extracting
components (via indexing or attribute access) which are checked for
specific values or conditions.</p></li>
<li><p>If the shape is as expected, some more components are possibly
extracted and some operation is done using the extracted values.</p></li>
</ul>
<p>Take for example <a class="reference external" href="https://github.com/django/django/blob/5166097d7c80cab757e44f2d02f3d148fbbc2ff6/django/db/models/enums.py#L13">this piece of the Django web framework</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span>
    <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span>
    <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">Promise</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
<span class="p">):</span>
    <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</pre></div>
</div>
<p>We can see the shape analysis of the <code class="docutils literal notranslate"><span class="pre">value</span></code> at the top, following
by the destructuring inside.</p>
<p>Note that shape analysis here involves checking the types both of the
container and of one of its components, and some checks on its number
of elements. Once we match the shape, we need to decompose the
sequence. With the proposal in this PEP, we could rewrite that code
into this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">value</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Promise</span><span class="p">()</span> <span class="o">|</span> <span class="nb">str</span><span class="p">())]</span> <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</pre></div>
</div>
<p>This syntax makes much more explicit which formats are possible for
the input data, and which components are extracted from where. You can
see a pattern similar to list unpacking, but also type checking: the
<code class="docutils literal notranslate"><span class="pre">Promise()</span></code> pattern is not an object construction, but represents
anything that’s an instance of <code class="docutils literal notranslate"><span class="pre">Promise</span></code>. The pattern operator <code class="docutils literal notranslate"><span class="pre">|</span></code>
separates alternative patterns (not unlike regular expressions or EBNF
grammars), and <code class="docutils literal notranslate"><span class="pre">_</span></code> is a wildcard. (Note that the match syntax used
here will accept user-defined sequences, as well as lists and tuples.)</p>
<p>In some occasions, extraction of information is not as relevant as
identifying structure. Take the following example from the
<a class="reference external" href="https://github.com/python/cpython/blob/c4cacc8/Lib/lib2to3/fixer_util.py#L158">Python standard library</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_tuple</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span> <span class="o">==</span> <span class="p">[</span><span class="n">LParen</span><span class="p">(),</span> <span class="n">RParen</span><span class="p">()]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Node</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span>
            <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This example shows an example of finding out the “shape” of the data
without doing significant extraction. This code is not very easy to
read, and the intended shape that this is trying to match is not
evident. Compare with the updated code using the proposed syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_tuple</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">match</span> <span class="n">node</span><span class="p">:</span>
        <span class="n">case</span> <span class="n">Node</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LParen</span><span class="p">(),</span> <span class="n">RParen</span><span class="p">()]):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">case</span> <span class="n">Node</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">Leaf</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;(&quot;</span><span class="p">),</span> <span class="n">Node</span><span class="p">(),</span> <span class="n">Leaf</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;)&quot;</span><span class="p">)]):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Note that the proposed code will work without any modifications to the
definition of <code class="docutils literal notranslate"><span class="pre">Node</span></code> and other classes here. As shown in the
examples above, the proposal supports not just unpacking sequences, but
also doing <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> checks (like <code class="docutils literal notranslate"><span class="pre">LParen()</span></code> or <code class="docutils literal notranslate"><span class="pre">str()</span></code>),
looking into object attributes (<code class="docutils literal notranslate"><span class="pre">Leaf(value=&quot;(&quot;)</span></code> for example) and
comparisons with literals.</p>
<p>That last feature helps with some kinds of code which look more like
the “switch” statement as present in other languages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
    <span class="n">case</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">do_something</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># OK</span>
    <span class="n">case</span> <span class="mi">301</span> <span class="o">|</span> <span class="mi">302</span><span class="p">:</span>
        <span class="n">retry</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>  <span class="c1"># Redirect</span>
    <span class="n">case</span> <span class="mi">401</span><span class="p">:</span>
        <span class="n">retry</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="n">get_credentials</span><span class="p">())</span>  <span class="c1"># Login first</span>
    <span class="n">case</span> <span class="mi">426</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">DELAY</span><span class="p">)</span>  <span class="c1"># Server is swamped, try after a bit</span>
        <span class="n">retry</span><span class="p">()</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">RequestError</span><span class="p">(</span><span class="s2">&quot;we couldn&#39;t get the data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Although this will work, it’s not necessarily what the proposal is
focused on, and the new syntax has been designed to best support the
destructuring scenarios.</p>
<p>See the <a class="reference internal" href="#id5">syntax</a> sections below for a more detailed specification.</p>
<p>We propose that destructuring objects can be customized by a new
special <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> attribute. As part of this PEP we specify
the general API and its implementation for some standard library
classes (including named tuples and dataclasses). See the <a class="reference internal" href="#runtime">runtime</a>
section below.</p>
<p>Finally, we aim to provide comprehensive support for static type
checkers and similar tools. For this purpose, we propose to introduce
a <code class="docutils literal notranslate"><span class="pre">&#64;typing.sealed</span></code> class decorator that will be a no-op at runtime
but will indicate to static tools that all sub-classes of this class
must be defined in the same module. This will allow effective static
exhaustiveness checks, and together with dataclasses, will provide
basic support for algebraic data types <a class="footnote-reference brackets" href="#id21" id="id4">2</a>. See the <a class="reference internal" href="#static-checkers">static checkers</a>
section for more details.</p>
</section>
<section id="syntax-and-semantics">
<span id="id5"></span><h2><a class="toc-backref" href="#id41">Syntax and Semantics</a><a class="headerlink" href="#syntax-and-semantics" title="Permalink to this headline">¶</a></h2>
<section id="patterns">
<h3><a class="toc-backref" href="#id42">Patterns</a><a class="headerlink" href="#patterns" title="Permalink to this headline">¶</a></h3>
<p>The <strong>pattern</strong> is a new syntactic construct, that could be considered a loose
generalization of assignment targets. The key properties of a pattern are what
types and shapes of subjects it accepts, what variables it captures and how
it extracts them from the subject. For example, the pattern <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b]</span></code> matches
only sequences of exactly 2 elements, extracting the first element into <code class="docutils literal notranslate"><span class="pre">a</span></code>
and the second one into <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>This PEP defines several types of patterns. These are certainly not the
only possible ones, so the design decision was made to choose a subset of
functionality that is useful now but conservative. More patterns can be added
later as this feature gets more widespread use. See the <a class="reference internal" href="#rejected-ideas">rejected ideas</a>
and <a class="reference internal" href="#deferred-ideas">deferred ideas</a> sections for more details.</p>
<p>The patterns listed here are described in more detail below, but summarized
together in this section for simplicity:</p>
<ul class="simple">
<li><p>A <strong>literal pattern</strong> is useful to filter constant values in a structure.
It looks like a Python literal (including some values like <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code>). It only matches objects equal to the literal, and
never binds.</p></li>
<li><p>A <strong>capture pattern</strong> looks like <code class="docutils literal notranslate"><span class="pre">x</span></code> and is equivalent to an identical
assignment target: it always matches and binds the variable
with the given (simple) name.</p></li>
<li><p>The <strong>wildcard pattern</strong> is a single underscore: <code class="docutils literal notranslate"><span class="pre">_</span></code>. It always matches,
but does not capture any variable (which prevents interference with other
uses for <code class="docutils literal notranslate"><span class="pre">_</span></code> and allows for some optimizations).</p></li>
<li><p>A <strong>constant value pattern</strong> works like the literal but for certain named
constants. Note that it must be a qualified (dotted) name, given the possible
ambiguity with a capture pattern. It looks like <code class="docutils literal notranslate"><span class="pre">Color.RED</span></code> and
only matches values equal to the corresponding value. It never binds.</p></li>
<li><p>A <strong>sequence pattern</strong> looks like <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">*rest,</span> <span class="pre">b]</span></code> and is similar to
a list unpacking. An important difference is that the elements nested
within it can be any kind of patterns, not just names or sequences.
It matches only sequences of appropriate length, as long as all the sub-patterns
also match. It makes all the bindings of its sub-patterns.</p></li>
<li><p>A <strong>mapping pattern</strong> looks like <code class="docutils literal notranslate"><span class="pre">{&quot;user&quot;:</span> <span class="pre">u,</span> <span class="pre">&quot;emails&quot;:</span> <span class="pre">[*es]}</span></code>. It matches
mappings with at least the set of provided keys, and if all the
sub-patterns match their corresponding values. It binds whatever the
sub-patterns bind while matching with the values corresponding to the keys.
Adding <code class="docutils literal notranslate"><span class="pre">**rest</span></code> at the end of the pattern to capture extra items is allowed.</p></li>
<li><p>A <strong>class pattern</strong> is similar to the above but matches attributes instead
of keys. It looks like <code class="docutils literal notranslate"><span class="pre">datetime.date(year=y,</span> <span class="pre">day=d)</span></code>. It matches
instances of the given type, having at least the specified
attributes, as long as the attributes match with the corresponding
sub-patterns. It binds whatever the sub-patterns bind when matching with the
values of
the given attributes. An optional protocol also allows matching positional
arguments.</p></li>
<li><p>An <strong>OR pattern</strong> looks like <code class="docutils literal notranslate"><span class="pre">[*x]</span> <span class="pre">|</span> <span class="pre">{&quot;elems&quot;:</span> <span class="pre">[*x]}</span></code>. It matches if any
of its sub-patterns match. It uses the binding for the leftmost pattern
that matched.</p></li>
<li><p>A <strong>walrus pattern</strong> looks like <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">:=</span> <span class="pre">datetime(year=2020,</span> <span class="pre">month=m)</span></code>. It
matches only
if its sub-pattern also matches. It binds whatever the sub-pattern match does, and
also binds the named variable to the entire object.</p></li>
</ul>
</section>
<section id="the-match-statement">
<h3><a class="toc-backref" href="#id43">The <code class="docutils literal notranslate"><span class="pre">match</span></code> statement</a><a class="headerlink" href="#the-match-statement" title="Permalink to this headline">¶</a></h3>
<p>A simplified, approximate grammar for the proposed syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">compound_statement</span><span class="p">:</span>
    <span class="o">|</span> <span class="n">if_stmt</span>
    <span class="o">...</span>
    <span class="o">|</span> <span class="n">match_stmt</span>
<span class="n">match_stmt</span><span class="p">:</span> <span class="s2">&quot;match&quot;</span> <span class="n">expression</span> <span class="s1">&#39;:&#39;</span> <span class="n">NEWLINE</span> <span class="n">INDENT</span> <span class="n">case_block</span><span class="o">+</span> <span class="n">DEDENT</span>
<span class="n">case_block</span><span class="p">:</span> <span class="s2">&quot;case&quot;</span> <span class="n">pattern</span> <span class="p">[</span><span class="n">guard</span><span class="p">]</span> <span class="s1">&#39;:&#39;</span> <span class="n">block</span>
<span class="n">guard</span><span class="p">:</span> <span class="s1">&#39;if&#39;</span> <span class="n">expression</span>
<span class="n">pattern</span><span class="p">:</span> <span class="n">walrus_pattern</span> <span class="o">|</span> <span class="n">or_pattern</span>
<span class="n">walrus_pattern</span><span class="p">:</span> <span class="n">NAME</span> <span class="s1">&#39;:=&#39;</span> <span class="n">or_pattern</span>
<span class="n">or_pattern</span><span class="p">:</span> <span class="n">closed_pattern</span> <span class="p">(</span><span class="s1">&#39;|&#39;</span> <span class="n">closed_pattern</span><span class="p">)</span><span class="o">*</span>
<span class="n">closed_pattern</span><span class="p">:</span>
    <span class="o">|</span> <span class="n">literal_pattern</span>
    <span class="o">|</span> <span class="n">capture_pattern</span>
    <span class="o">|</span> <span class="n">wildcard_pattern</span>
    <span class="o">|</span> <span class="n">constant_pattern</span>
    <span class="o">|</span> <span class="n">sequence_pattern</span>
    <span class="o">|</span> <span class="n">mapping_pattern</span>
    <span class="o">|</span> <span class="n">class_pattern</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#appendix-a">Appendix A</a> for the full, unabridged grammar. The simplified grammars in
this section are there for helping the reader, not as a full specification.</p>
<p>We propose that the match operation should be a statement, not an expression.
Although in
many languages it is an expression, being a statement better suits the general
logic of Python syntax. See <a class="reference internal" href="#rejected-ideas">rejected ideas</a> for more discussion.
The allowed patterns are described in detail below in the <a class="reference internal" href="#id6">patterns</a>
subsection.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">match</span></code> and <code class="docutils literal notranslate"><span class="pre">case</span></code> keywords are proposed to be soft keywords,
so that they are recognized as keywords at the beginning of a match
statement or case block respectively, but are allowed to be used in
other places as variable or argument names.</p>
<p>The proposed indentation structure is as following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">some_expression</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">pattern_1</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">pattern_2</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">some_expression</span></code> represents the value that is being matched against,
which will be referred to hereafter as the <em>subject</em> of the match.</p>
</section>
<section id="match-semantics">
<h3><a class="toc-backref" href="#id44">Match semantics</a><a class="headerlink" href="#match-semantics" title="Permalink to this headline">¶</a></h3>
<p>The proposed large scale semantics for choosing the match is to choose the first
matching pattern and execute the corresponding suite. The remaining patterns
are not tried. If there are no matching patterns, the statement ‘falls
through’, and execution continues at the following statement.</p>
<p>Essentially this is equivalent to a chain of <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">...</span> <span class="pre">elif</span> <span class="pre">...</span> <span class="pre">else</span></code>
statements. Note that unlike for the previously proposed <code class="docutils literal notranslate"><span class="pre">switch</span></code> statement,
the pre-computed dispatch dictionary semantics does not apply here.</p>
<p>There is no <code class="docutils literal notranslate"><span class="pre">default</span></code> or <code class="docutils literal notranslate"><span class="pre">else</span></code> case - instead the special wildcard
<code class="docutils literal notranslate"><span class="pre">_</span></code> can be used (see the section on <a class="reference internal" href="#capture-pattern">capture_pattern</a>) as a final
‘catch-all’ pattern.</p>
<p>Name bindings made during a successful pattern match outlive the executed suite
and can be used after the match statement. This follows the logic of other
Python statements that can bind names, such as <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and <code class="docutils literal notranslate"><span class="pre">with</span></code>
statement. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">shape</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="o">...</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># This works</span>
</pre></div>
</div>
<p>During failed pattern matches, some sub-patterns may succeed. For example,
while matching the value <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code> with the pattern <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">x,</span> <span class="pre">1)</span></code>, the
sub-pattern <code class="docutils literal notranslate"><span class="pre">x</span></code> may succeed if the list elements are matched from left to right.
The implementation may choose to either make persistent bindings for those
partial matches or not. User code including a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement should not rely
on the bindings being made for a failed match, but also shouldn’t assume that
variables are unchanged by a failed match. This part of the behavior is
left intentionally unspecified so different implementations can add
optimizations, and to prevent introducing semantic restrictions that could
limit the extensibility of this feature.</p>
<p>Note that some pattern types below define more specific rules about when
the binding is made.</p>
</section>
<section id="allowed-patterns">
<span id="id6"></span><h3><a class="toc-backref" href="#id45">Allowed patterns</a><a class="headerlink" href="#allowed-patterns" title="Permalink to this headline">¶</a></h3>
<p>We introduce the proposed syntax gradually. Here we start from the main
building blocks. The following patterns are supported:</p>
<section id="literal-patterns">
<span id="literal-pattern"></span><h4><a class="toc-backref" href="#id46">Literal Patterns</a><a class="headerlink" href="#literal-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">literal_pattern</span><span class="p">:</span>
    <span class="o">|</span> <span class="n">number</span>
    <span class="o">|</span> <span class="n">string</span>
    <span class="o">|</span> <span class="s1">&#39;None&#39;</span>
    <span class="o">|</span> <span class="s1">&#39;True&#39;</span>
    <span class="o">|</span> <span class="s1">&#39;False&#39;</span>
</pre></div>
</div>
<p>A literal pattern consists of a simple literal like a string, a number,
a Boolean literal (<code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>), or <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">number</span><span class="p">:</span>
    <span class="n">case</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nothing&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Just one&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A couple&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;One less than nothing&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Good luck with that...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Literal pattern uses equality with literal on the right hand side, so that
in the above example <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">==</span> <span class="pre">0</span></code> and then possibly <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">==</span> <span class="pre">1</span></code>, etc
will be evaluated. Note that although technically negative numbers
are represented using unary minus, they are considered
literals for the purpose of pattern matching. Unary plus is not allowed.
Binary plus and minus are allowed only to join a real number and an imaginary
number to form a complex number, such as <code class="docutils literal notranslate"><span class="pre">1+1j</span></code>.</p>
<p>Note that because equality (<code class="docutils literal notranslate"><span class="pre">__eq__</span></code>) is used, and the equivalency
between Booleans and the integers <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code>, there is no
practical difference between the following two:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="kc">True</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">case</span> <span class="mi">1</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Triple-quoted strings are supported.  Raw strings and byte strings
are supported. F-strings are not allowed (since in general they are not
really literals).</p>
</section>
<section id="capture-patterns">
<span id="capture-pattern"></span><h4><a class="toc-backref" href="#id47">Capture Patterns</a><a class="headerlink" href="#capture-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">capture_pattern</span><span class="p">:</span> <span class="n">NAME</span>
</pre></div>
</div>
<p>A capture pattern serves as an assignment target for the matched expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">greeting</span><span class="p">:</span>
    <span class="n">case</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">name</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hi </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Only a single name is allowed (a dotted name is a constant value pattern).
A capture pattern always succeeds. A capture pattern appearing in a scope makes
the name local to that scope. For example, using <code class="docutils literal notranslate"><span class="pre">name</span></code> after the above
snippet may raise <code class="docutils literal notranslate"><span class="pre">UnboundLocalError</span></code> rather than <code class="docutils literal notranslate"><span class="pre">NameError</span></code>, if
the <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> case clause was taken:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">greeting</span><span class="p">:</span>
    <span class="n">case</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">name</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hi </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Santa&quot;</span><span class="p">:</span>      <span class="c1"># &lt;-- might raise UnboundLocalError</span>
    <span class="o">...</span>                  <span class="c1"># but works fine if greeting was not empty</span>
</pre></div>
</div>
<p>While matching against each case clause, a name may be bound at most
once, having two capture patterns with coinciding names is an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">]:</span>  <span class="c1"># Error!</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Note: one can still match on a collection with equal items using <a class="reference internal" href="#guards">guards</a>.
Also, <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y]</span> <span class="pre">|</span> <span class="pre">Point(x,</span> <span class="pre">y)</span></code> is a legal pattern because the two
alternatives are never matched at the same time.</p>
<p>The single underscore (<code class="docutils literal notranslate"><span class="pre">_</span></code>) is not considered a <code class="docutils literal notranslate"><span class="pre">NAME</span></code> and treated specially
as a <a class="reference internal" href="#id7">wildcard pattern</a>.</p>
<p>Reminder: <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">True</span></code> are keywords denoting
literals, not names.</p>
</section>
<section id="wildcard-pattern">
<span id="id7"></span><h4><a class="toc-backref" href="#id48">Wildcard Pattern</a><a class="headerlink" href="#wildcard-pattern" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wildcard_pattern</span><span class="p">:</span> <span class="s2">&quot;_&quot;</span>
</pre></div>
</div>
<p>The single underscore (<code class="docutils literal notranslate"><span class="pre">_</span></code>) name is a special kind of pattern that always
matches but <em>never</em> binds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some pair&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># Error!</span>
</pre></div>
</div>
<p>Given that no binding is made, it can be used as many times as desired, unlike
capture patterns.</p>
</section>
<section id="constant-value-patterns">
<span id="constant-value-pattern"></span><h4><a class="toc-backref" href="#id49">Constant Value Patterns</a><a class="headerlink" href="#constant-value-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constant_pattern</span><span class="p">:</span> <span class="n">NAME</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="n">NAME</span><span class="p">)</span><span class="o">+</span>
</pre></div>
</div>
<p>This is used to match against constants and enum values.
Every dotted name in a pattern is looked up using normal Python name
resolution rules, and the value is used for comparison by equality with
the match subject (same as for literals):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">Sides</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
    <span class="n">SPAM</span> <span class="o">=</span> <span class="s2">&quot;Spam&quot;</span>
    <span class="n">EGGS</span> <span class="o">=</span> <span class="s2">&quot;eggs&quot;</span>
    <span class="o">...</span>

<span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="n">Sides</span><span class="o">.</span><span class="n">SPAM</span><span class="p">:</span>  <span class="c1"># Compares entree[-1] == Sides.SPAM.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;Have you got anything without Spam?&quot;</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span>  <span class="c1"># Assigns side = entree[-1].</span>
        <span class="n">response</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Well, could I have their Spam instead of the </span><span class="si">{</span><span class="n">side</span><span class="si">}</span><span class="s2"> then?&quot;</span>
</pre></div>
</div>
<p>Note that there is no way to use unqualified names as constant value
patterns (they always denote variables to be captured).  See
<a class="reference internal" href="#rejected-ideas">rejected ideas</a> for other syntactic alternatives that were
considered for constant value patterns.</p>
</section>
<section id="sequence-patterns">
<span id="sequence-pattern"></span><h4><a class="toc-backref" href="#id50">Sequence Patterns</a><a class="headerlink" href="#sequence-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sequence_pattern:
    | &#39;[&#39; [values_pattern] &#39;]&#39;
    | &#39;(&#39; [value_pattern &#39;,&#39; [values pattern]] &#39;)&#39;
values_pattern: &#39;,&#39;.value_pattern+ &#39;,&#39;?
value_pattern: &#39;*&#39; capture_pattern | pattern
</pre></div>
</div>
<p>A sequence pattern follows the same semantics as unpacking assignment.
Like unpacking assignment, both tuple-like and list-like syntax can be
used, with identical semantics.  Each element can be an arbitrary
pattern; there may also be at most one <code class="docutils literal notranslate"><span class="pre">*name</span></code> pattern to catch all
remaining items:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">collection</span><span class="p">:</span>
    <span class="n">case</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got 1 and a nested sequence&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got 1 and </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To match a sequence pattern the subject must be an instance of
<code class="docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code>, and it cannot be any kind of string
(<code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">bytearray</span></code>). It cannot be an iterator. For matching
on a specific collection class, see class pattern below.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_</span></code> wildcard can be starred to match sequences of varying lengths. For
example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[*_]</span></code> matches a sequence of any length.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(_,</span> <span class="pre">_,</span> <span class="pre">*_)</span></code>, matches any sequence of length two or more.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">*_,</span> <span class="pre">&quot;z&quot;]</span></code> matches any sequence of length two or more that starts with
<code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> and ends with <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>.</p></li>
</ul>
</section>
<section id="mapping-patterns">
<span id="mapping-pattern"></span><h4><a class="toc-backref" href="#id51">Mapping Patterns</a><a class="headerlink" href="#mapping-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mapping_pattern: &#39;{&#39; [items_pattern] &#39;}&#39;
items_pattern: &#39;,&#39;.key_value_pattern+ &#39;,&#39;?
key_value_pattern:
    | (literal_pattern | constant_pattern) &#39;:&#39; or_pattern
    | &#39;**&#39; capture_pattern
</pre></div>
</div>
<p>Mapping pattern is a generalization of iterable unpacking to mappings.
Its syntax is similar to dictionary display but each key and value are
patterns <code class="docutils literal notranslate"><span class="pre">&quot;{&quot;</span> <span class="pre">(pattern</span> <span class="pre">&quot;:&quot;</span> <span class="pre">pattern)+</span> <span class="pre">&quot;}&quot;</span></code>. A <code class="docutils literal notranslate"><span class="pre">**rest</span></code> pattern is also
allowed, to extract the remaining items.  Only literal and constant value
patterns are allowed in key positions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">constants</span>

<span class="n">match</span> <span class="n">config</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">{</span><span class="s2">&quot;route&quot;</span><span class="p">:</span> <span class="n">route</span><span class="p">}:</span>
        <span class="n">process_route</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
    <span class="n">case</span> <span class="p">{</span><span class="n">constants</span><span class="o">.</span><span class="n">DEFAULT_PORT</span><span class="p">:</span> <span class="n">sub_config</span><span class="p">,</span> <span class="o">**</span><span class="n">rest</span><span class="p">}:</span>
        <span class="n">process_config</span><span class="p">(</span><span class="n">sub_config</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
</pre></div>
</div>
<p>The subject must be an instance of <code class="docutils literal notranslate"><span class="pre">collections.abc.Mapping</span></code>.
Extra keys in the subject are ignored even if <code class="docutils literal notranslate"><span class="pre">**rest</span></code> is not present.
This is different from sequence pattern, where extra items will cause a
match to fail. But mappings are actually different from sequences: they
have natural structural sub-typing behavior, i.e., passing a dictionary
with extra keys somewhere will likely just work.</p>
<p>For this reason, <code class="docutils literal notranslate"><span class="pre">**_</span></code> is invalid in mapping patterns; it would always be a
no-op that could be removed without consequence.</p>
<p>Matched key-value pairs must already be present in the mapping, and not created
on-the-fly by <code class="docutils literal notranslate"><span class="pre">__missing__</span></code> or <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>.  For example,
<code class="docutils literal notranslate"><span class="pre">collections.defaultdict</span></code> instances will only match patterns with keys that
were already present when the <code class="docutils literal notranslate"><span class="pre">match</span></code> block was entered.</p>
</section>
<section id="class-patterns">
<span id="class-pattern"></span><h4><a class="toc-backref" href="#id52">Class Patterns</a><a class="headerlink" href="#class-patterns" title="Permalink to this headline">¶</a></h4>
<p>Simplified syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>class_pattern:
    | name_or_attr &#39;(&#39; &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.pattern+ &#39;,&#39;? &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.keyword_pattern+ &#39;,&#39;? &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.pattern+ &#39;,&#39; &#39;,&#39;.keyword_pattern+ &#39;,&#39;? &#39;)&#39;
keyword_pattern: NAME &#39;=&#39; or_pattern
</pre></div>
</div>
<p>A class pattern provides support for destructuring arbitrary objects.
There are two possible ways of matching on object attributes: by position
like <code class="docutils literal notranslate"><span class="pre">Point(1,</span> <span class="pre">2)</span></code>, and by name like <code class="docutils literal notranslate"><span class="pre">Point(x=1,</span> <span class="pre">y=2)</span></code>. These
two can be combined, but a positional match cannot follow a match by name.
Each item in a class pattern can be an arbitrary pattern. A simple
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">shape</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">painted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Whether a match succeeds or not is determined by the equivalent of an
<code class="docutils literal notranslate"><span class="pre">isinstance</span></code> call.  If the subject (<code class="docutils literal notranslate"><span class="pre">shape</span></code>, in the example) is not
an instance of the named class (<code class="docutils literal notranslate"><span class="pre">Point</span></code> or <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>), the match
fails.  Otherwise, it continues (see details in the <a class="reference internal" href="#runtime">runtime</a>
section).</p>
<p>The named class must inherit from <code class="docutils literal notranslate"><span class="pre">type</span></code>.  It may be a single name
or a dotted name (e.g. <code class="docutils literal notranslate"><span class="pre">some_mod.SomeClass</span></code> or <code class="docutils literal notranslate"><span class="pre">mod.pkg.Class</span></code>).
The leading name must not be <code class="docutils literal notranslate"><span class="pre">_</span></code>, so e.g. <code class="docutils literal notranslate"><span class="pre">_(...)</span></code> and
<code class="docutils literal notranslate"><span class="pre">_.C(...)</span></code> are invalid. Use <code class="docutils literal notranslate"><span class="pre">object(foo=_)</span></code> to check whether the
matched object has an attribute <code class="docutils literal notranslate"><span class="pre">foo</span></code>.</p>
<p>By default, sub-patterns may only be matched by keyword for
user-defined classes. In order to support positional sub-patterns, a
custom <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> attribute is required.
The runtime allows matching against
arbitrarily nested patterns by chaining all of the instance checks and
attribute lookups appropriately.</p>
</section>
</section>
<section id="combining-multiple-patterns-or-patterns">
<h3><a class="toc-backref" href="#id53">Combining multiple patterns (OR patterns)</a><a class="headerlink" href="#combining-multiple-patterns-or-patterns" title="Permalink to this headline">¶</a></h3>
<p>Multiple alternative patterns can be combined into one using <code class="docutils literal notranslate"><span class="pre">|</span></code>. This means
the whole pattern matches if at least one alternative matches.
Alternatives are tried from left to right and have a short-circuit property,
subsequent patterns are not tried if one matched. Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">something</span><span class="p">:</span>
    <span class="n">case</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Small number&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="p">[]</span> <span class="o">|</span> <span class="p">[</span><span class="n">_</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A short sequence&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="nb">str</span><span class="p">()</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something string-like&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something else&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The alternatives may bind variables, as long as each alternative binds
the same set of variables (excluding <code class="docutils literal notranslate"><span class="pre">_</span></code>).  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">something</span><span class="p">:</span>
    <span class="n">case</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">x</span><span class="p">:</span>  <span class="c1"># Error!</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">x</span> <span class="o">|</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Error!</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">one</span> <span class="o">:=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">two</span> <span class="o">:=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># Error!</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">Foo</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="o">|</span> <span class="n">Bar</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># Valid, both arms bind &#39;x&#39;</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">|</span> <span class="n">x</span><span class="p">:</span>  <span class="c1"># Valid, both arms bind &#39;x&#39;</span>
        <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="guards">
<span id="id8"></span><h3><a class="toc-backref" href="#id54">Guards</a><a class="headerlink" href="#guards" title="Permalink to this headline">¶</a></h3>
<p>Each <em>top-level</em> pattern can be followed by a <strong>guard</strong> of the form
<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">expression</span></code>. A case clause succeeds if the pattern matches and the guard
evaluates to a true value. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="nb">input</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">MAX_INT</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">MAX_INT</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got a pair of large numbers&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">MAX_INT</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got a large number&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got equal items&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not an outstanding input&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If evaluating a guard raises an exception, it is propagated onwards rather
than fail the case clause. Names that appear in a pattern are bound before the
guard succeeds. So this will work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">match</span> <span class="n">values</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
        <span class="o">...</span>  <span class="c1"># This is not executed</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="o">...</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># This will print &quot;0&quot;</span>
</pre></div>
</div>
<p>Note that guards are not allowed for nested patterns, so that <code class="docutils literal notranslate"><span class="pre">[x</span> <span class="pre">if</span> <span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">0]</span></code>
is a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">|</span> <span class="pre">2</span> <span class="pre">if</span> <span class="pre">3</span> <span class="pre">|</span> <span class="pre">4</span></code> will be parsed as
<code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">|</span> <span class="pre">2)</span> <span class="pre">if</span> <span class="pre">(3</span> <span class="pre">|</span> <span class="pre">4)</span></code>.</p>
</section>
<section id="walrus-patterns">
<h3><a class="toc-backref" href="#id55">Walrus patterns</a><a class="headerlink" href="#walrus-patterns" title="Permalink to this headline">¶</a></h3>
<p>It is often useful to match a sub-pattern <em>and</em> bind the corresponding
value to a name. For example, it can be useful to write more efficient
matches, or simply to avoid repetition. To simplify such cases, any pattern
(other than the walrus pattern itself) can be preceded by a name and
the walrus operator (<code class="docutils literal notranslate"><span class="pre">:=</span></code>). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">get_shape</span><span class="p">():</span>
    <span class="n">case</span> <span class="n">Line</span><span class="p">(</span><span class="n">start</span> <span class="o">:=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">end</span><span class="p">)</span> <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zero length line at </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The name on the left of the walrus operator can be used in a guard, in
the match suite, or after the match statement.  However, the name will
<em>only</em> be bound if the sub-pattern succeeds.  Another example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">group_shapes</span><span class="p">():</span>
    <span class="n">case</span> <span class="p">[],</span> <span class="p">[</span><span class="n">point</span> <span class="o">:=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="o">*</span><span class="n">other</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">point</span><span class="si">}</span><span class="s2"> in the second group&quot;</span><span class="p">)</span>
        <span class="n">process_coordinates</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Technically, most such examples can be rewritten using guards and/or nested
match statements, but this will be less readable and/or will produce less
efficient code. Essentially, most of the arguments in <a class="reference external" href="pep-0572.html">PEP 572</a> apply here
equally.</p>
<p>The wildcard <code class="docutils literal notranslate"><span class="pre">_</span></code> is not a valid name here.</p>
</section>
</section>
<section id="runtime-specification">
<span id="runtime"></span><h2><a class="toc-backref" href="#id56">Runtime specification</a><a class="headerlink" href="#runtime-specification" title="Permalink to this headline">¶</a></h2>
<section id="the-match-protocol">
<h3><a class="toc-backref" href="#id57">The Match Protocol</a><a class="headerlink" href="#the-match-protocol" title="Permalink to this headline">¶</a></h3>
<p>The equivalent of an <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> call is used to decide whether an
object matches a given class pattern and to extract the corresponding
attributes.  Classes requiring different matching semantics (such as
duck-typing) can do so by defining <code class="docutils literal notranslate"><span class="pre">__instancecheck__</span></code> (a
pre-existing metaclass hook) or by using <code class="docutils literal notranslate"><span class="pre">typing.Protocol</span></code>.</p>
<p>The procedure is as following:</p>
<ul class="simple">
<li><p>The class object for <code class="docutils literal notranslate"><span class="pre">Class</span></code> in <code class="docutils literal notranslate"><span class="pre">Class(&lt;sub-patterns&gt;)</span></code> is
looked up and <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">Class)</span></code> is called, where <code class="docutils literal notranslate"><span class="pre">obj</span></code> is
the value being matched.  If false, the match fails.</p></li>
<li><p>Otherwise, if any sub-patterns are given in the form of positional
or keyword arguments, these are matched from left to right, as
follows.  The match fails as soon as a sub-pattern fails; if all
sub-patterns succeed, the overall class pattern match succeeds.</p></li>
<li><p>If there are match-by-position items and the class has a
<code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> attribute, the item at position <code class="docutils literal notranslate"><span class="pre">i</span></code>
is matched against the value looked up by attribute
<code class="docutils literal notranslate"><span class="pre">__match_args__[i]</span></code>. For example, a pattern <code class="docutils literal notranslate"><span class="pre">Point2d(5,</span> <span class="pre">8)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">Point2d.__match_args__</span> <span class="pre">==</span> <span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;y&quot;]</span></code>, is translated
(approximately) into <code class="docutils literal notranslate"><span class="pre">obj.x</span> <span class="pre">==</span> <span class="pre">5</span> <span class="pre">and</span> <span class="pre">obj.y</span> <span class="pre">==</span> <span class="pre">8</span></code>.</p></li>
<li><p>If there are more positional items than the length of
<code class="docutils literal notranslate"><span class="pre">__match_args__</span></code>, a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is raised.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> attribute is absent on the matched class,
and one or more positional item appears in a match,
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is also raised. We don’t fall back on
using <code class="docutils literal notranslate"><span class="pre">__slots__</span></code> or <code class="docutils literal notranslate"><span class="pre">__annotations__</span></code> – “In the face of ambiguity,
refuse the temptation to guess.”</p></li>
<li><p>If there are any match-by-keyword items the keywords are looked up
as attributes on the subject.  If the lookup succeeds the value is
matched against the corresponding sub-pattern.  If the lookup fails,
the match fails.</p></li>
</ul>
<p>Such a protocol favors simplicity of implementation over flexibility and
performance. For other considered alternatives, see <a class="reference internal" href="#extended-matching">extended matching</a>.</p>
<p>For the most commonly-matched built-in types (<code class="docutils literal notranslate"><span class="pre">bool</span></code>,
<code class="docutils literal notranslate"><span class="pre">bytearray</span></code>, <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>,
<code class="docutils literal notranslate"><span class="pre">frozenset</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, and <code class="docutils literal notranslate"><span class="pre">tuple</span></code>), a
single positional sub-pattern is allowed to be passed to
the call. Rather than being matched against any particular attribute
on the subject, it is instead matched against the subject itself.  This
creates behavior that is useful and intuitive for these objects:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool(False)</span></code> matches <code class="docutils literal notranslate"><span class="pre">False</span></code> (but not <code class="docutils literal notranslate"><span class="pre">0</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple((0,</span> <span class="pre">1,</span> <span class="pre">2))</span></code> matches <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code> (but not <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(i)</span></code> matches any <code class="docutils literal notranslate"><span class="pre">int</span></code> and binds it to the name <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p></li>
</ul>
</section>
<section id="overlapping-sub-patterns">
<h3><a class="toc-backref" href="#id58">Overlapping sub-patterns</a><a class="headerlink" href="#overlapping-sub-patterns" title="Permalink to this headline">¶</a></h3>
<p>Certain classes of overlapping matches are detected at
runtime and will raise exceptions. In addition to basic checks
described in the previous subsection:</p>
<ul class="simple">
<li><p>The interpreter will check that two match items are not targeting the same
attribute, for example <code class="docutils literal notranslate"><span class="pre">Point2d(1,</span> <span class="pre">2,</span> <span class="pre">y=3)</span></code> is an error.</p></li>
<li><p>It will also check that a mapping pattern does not attempt to match
the same key more than once.</p></li>
</ul>
</section>
<section id="special-attribute-match-args">
<h3><a class="toc-backref" href="#id59">Special attribute <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code></a><a class="headerlink" href="#special-attribute-match-args" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> attribute is always looked up on the type
object named in the pattern.  If present, it must be a list or tuple
of strings naming the allowed positional arguments.</p>
<p>In deciding what names should be available for matching, the
recommended practice is that class patterns should be the mirror of
construction; that is, the set of available names and their types
should resemble the arguments to <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>.</p>
<p>Only match-by-name will work by default, and classes should define
<code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> as a class attribute if they would like to support
match-by-position.  Additionally, dataclasses and named tuples will
support match-by-position out of the box. See below for more details.</p>
</section>
<section id="exceptions-and-side-effects">
<h3><a class="toc-backref" href="#id60">Exceptions and side effects</a><a class="headerlink" href="#exceptions-and-side-effects" title="Permalink to this headline">¶</a></h3>
<p>While matching each case, the <code class="docutils literal notranslate"><span class="pre">match</span></code> statement may trigger execution of other
functions (for example <code class="docutils literal notranslate"><span class="pre">__getitem__()</span></code>, <code class="docutils literal notranslate"><span class="pre">__len__()</span></code> or
a property). Almost every exception caused by those propagates outside of the
match statement normally. The only case where an exception is not propagated is
an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> raised while trying to lookup an attribute while matching
attributes of a Class Pattern; that case results in just a matching failure,
and the rest of the statement proceeds normally.</p>
<p>The only side-effect carried on explicitly by the matching process is the binding of
names. However, the process relies on attribute access,
instance checks, <code class="docutils literal notranslate"><span class="pre">len()</span></code>, equality and item access on the subject and some of
its components. It also evaluates constant value patterns and the left side of
class patterns. While none of those typically create any side-effects, some of
these objects could. This proposal intentionally leaves out any specification
of what methods are called or how many times. User code relying on that
behavior should be considered buggy.</p>
</section>
<section id="the-standard-library">
<h3><a class="toc-backref" href="#id61">The standard library</a><a class="headerlink" href="#the-standard-library" title="Permalink to this headline">¶</a></h3>
<p>To facilitate the use of pattern matching, several changes will be made to
the standard library:</p>
<ul class="simple">
<li><p>Namedtuples and dataclasses will have auto-generated <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code>.</p></li>
<li><p>For dataclasses the order of attributes in the generated <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code>
will be the same as the order of corresponding arguments in the generated
<code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method. This includes the situations where attributes are
inherited from a superclass.</p></li>
</ul>
<p>In addition, a systematic effort will be put into going through
existing standard library classes and adding <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> where
it looks beneficial.</p>
</section>
</section>
<section id="static-checkers-specification">
<span id="static-checkers"></span><h2><a class="toc-backref" href="#id62">Static checkers specification</a><a class="headerlink" href="#static-checkers-specification" title="Permalink to this headline">¶</a></h2>
<section id="exhaustiveness-checks">
<h3><a class="toc-backref" href="#id63">Exhaustiveness checks</a><a class="headerlink" href="#exhaustiveness-checks" title="Permalink to this headline">¶</a></h3>
<p>From a reliability perspective, experience shows that missing a case when
dealing with a set of possible data values leads to hard to debug issues,
thus forcing people to add safety asserts like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_first</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;should never get here&quot;</span>
</pre></div>
</div>
<p><a class="reference external" href="pep-0484.html">PEP 484</a> specifies that static type checkers should support exhaustiveness in
conditional checks with respect to enum values. <a class="reference external" href="pep-0586.html">PEP 586</a> later generalized this
requirement to literal types.</p>
<p>This PEP further generalizes this requirement to
arbitrary patterns. A typical situation where this applies is matching an
expression with a union type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">match</span> <span class="n">val</span><span class="p">:</span>
        <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;A pair of </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">case</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">]:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;A sequence starting with </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">case</span> <span class="nb">int</span><span class="p">():</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Some integer&quot;</span>
        <span class="c1"># Type-checking error: some cases unhandled.</span>
</pre></div>
</div>
<p>The exhaustiveness checks should also apply where both pattern matching
and enum values are combined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="k">class</span> <span class="nc">Level</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">BASIC</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ADVANCED</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">PRO</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">level</span><span class="p">:</span> <span class="n">Level</span>

<span class="k">class</span> <span class="nc">Admin</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">account</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">User</span><span class="p">,</span> <span class="n">Admin</span><span class="p">]</span>

<span class="n">match</span> <span class="n">account</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">Admin</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="o">|</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">Level</span><span class="o">.</span><span class="n">PRO</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="n">case</span> <span class="n">User</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">Level</span><span class="o">.</span><span class="n">ADVANCED</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="c1"># Type-checking error: basic user unhandled</span>
</pre></div>
</div>
<p>Obviously, no <code class="docutils literal notranslate"><span class="pre">Matchable</span></code> protocol (in terms of <a class="reference external" href="pep-0544.html">PEP 544</a>) is needed, since
every class is matchable and therefore is subject to the checks specified
above.</p>
</section>
<section id="sealed-classes-as-algebraic-data-types">
<h3><a class="toc-backref" href="#id64">Sealed classes as algebraic data types</a><a class="headerlink" href="#sealed-classes-as-algebraic-data-types" title="Permalink to this headline">¶</a></h3>
<p>Quite often it is desirable to apply exhaustiveness to a set of classes without
defining ad-hoc union types, which is itself fragile if a class is missing in
the union definition. A design pattern where a group of record-like classes is
combined into a union is popular in other languages that support pattern
matching and is known under a name of algebraic data types <a class="footnote-reference brackets" href="#id21" id="id9">2</a>.</p>
<p>We propose to add a special decorator class <code class="docutils literal notranslate"><span class="pre">&#64;sealed</span></code> to the <code class="docutils literal notranslate"><span class="pre">typing</span></code>
module <a class="footnote-reference brackets" href="#id25" id="id10">6</a>, that will have no effect at runtime, but will indicate to static
type checkers that all subclasses (direct and indirect) of this class should
be defined in the same module as the base class.</p>
<p>The idea is that since all subclasses are known, the type checker can treat
the sealed base class as a union of all its subclasses. Together with
dataclasses this allows a clean and safe support of algebraic data types
in Python. Consider this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">sealed</span>

<span class="nd">@sealed</span>
<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="o">...</span>

<span class="k">class</span> <span class="nc">Expression</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">class</span> <span class="nc">Statement</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Name</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Operation</span><span class="p">(</span><span class="n">Expression</span><span class="p">):</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">Expression</span>
    <span class="n">op</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">Expression</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Assignment</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Expression</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Print</span><span class="p">(</span><span class="n">Statement</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Expression</span>
</pre></div>
</div>
<p>With such definition, a type checker can safely treat <code class="docutils literal notranslate"><span class="pre">Node</span></code> as
<code class="docutils literal notranslate"><span class="pre">Union[Name,</span> <span class="pre">Operation,</span> <span class="pre">Assignment,</span> <span class="pre">Print]</span></code>, and also safely treat e.g.
<code class="docutils literal notranslate"><span class="pre">Expression</span></code> as <code class="docutils literal notranslate"><span class="pre">Union[Name,</span> <span class="pre">Operation]</span></code>. So this will result in a type
checking error in the below snippet, because <code class="docutils literal notranslate"><span class="pre">Name</span></code> is not handled (and type
checker can give a useful error message):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">match</span> <span class="n">node</span><span class="p">:</span>
        <span class="n">case</span> <span class="n">Assignment</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">case</span> <span class="n">Print</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;print(</span><span class="si">{</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">case</span> <span class="n">Operation</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">dump</span><span class="p">(</span><span class="n">left</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">dump</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>
</div>
</section>
<section id="type-erasure">
<h3><a class="toc-backref" href="#id65">Type erasure</a><a class="headerlink" href="#type-erasure" title="Permalink to this headline">¶</a></h3>
<p>Class patterns are subject to runtime type erasure. Namely, although one
can define a type alias <code class="docutils literal notranslate"><span class="pre">IntQueue</span> <span class="pre">=</span> <span class="pre">Queue[int]</span></code> so that a pattern like
<code class="docutils literal notranslate"><span class="pre">IntQueue()</span></code> is syntactically valid, type checkers should reject such a
match:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">queue</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Queue</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Queue</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="n">match</span> <span class="n">queue</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">IntQueue</span><span class="p">():</span>  <span class="c1"># Type-checking error here</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Note that the above snippet actually fails at runtime with the current
implementation of generic classes in the <code class="docutils literal notranslate"><span class="pre">typing</span></code> module, as well as
with builtin generic classes in the recently accepted <a class="reference external" href="pep-0585.html">PEP 585</a>, because
they prohibit <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> checks.</p>
<p>To clarify, generic classes are not prohibited in general from participating
in pattern matching, just that their type parameters can’t be explicitly
specified. It is still fine if sub-patterns or literals bind the type
variables. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Union</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Result</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="n">first</span><span class="p">:</span> <span class="n">T</span>
    <span class="n">other</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>

<span class="n">result</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Result</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Result</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>

<span class="n">match</span> <span class="n">result</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">Result</span><span class="p">(</span><span class="n">first</span><span class="o">=</span><span class="nb">int</span><span class="p">()):</span>
        <span class="o">...</span>  <span class="c1"># Type of result is Result[int] here</span>
    <span class="n">case</span> <span class="n">Result</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">]):</span>
        <span class="o">...</span>  <span class="c1"># Type of result is Result[str] here</span>
</pre></div>
</div>
</section>
<section id="note-about-constants">
<h3><a class="toc-backref" href="#id66">Note about constants</a><a class="headerlink" href="#note-about-constants" title="Permalink to this headline">¶</a></h3>
<p>The fact that a capture pattern is always an assignment target may create unwanted
consequences when a user by mistake tries to “match” a value against
a constant instead of using the constant value pattern. As a result, at
runtime such a match will always succeed and moreover override the value of
the constant. It is important therefore that static type checkers warn about
such situations. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Final</span>

<span class="n">MAX_INT</span><span class="p">:</span> <span class="n">Final</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">64</span>

<span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">match</span> <span class="n">value</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">MAX_INT</span><span class="p">:</span>  <span class="c1"># Type-checking error here: cannot assign to final name</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got big number&quot;</span><span class="p">)</span>
    <span class="n">case</span> <span class="n">_</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something else&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the CPython reference implementation also generates a
<code class="docutils literal notranslate"><span class="pre">SyntaxWarning</span></code> message for this case.</p>
</section>
<section id="precise-type-checking-of-star-matches">
<h3><a class="toc-backref" href="#id67">Precise type checking of star matches</a><a class="headerlink" href="#precise-type-checking-of-star-matches" title="Permalink to this headline">¶</a></h3>
<p>Type checkers should perform precise type checking of star items in pattern
matching giving them either a heterogeneous <code class="docutils literal notranslate"><span class="pre">list[T]</span></code> type, or
a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> type as specified by <a class="reference external" href="pep-0589.html">PEP 589</a>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stuff</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>

<span class="n">match</span> <span class="n">stuff</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="c1"># Here a is int and b is list[str]</span>
        <span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-considerations">
<h2><a class="toc-backref" href="#id68">Performance Considerations</a><a class="headerlink" href="#performance-considerations" title="Permalink to this headline">¶</a></h2>
<p>Ideally, a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement should have good runtime performance compared
to an equivalent chain of if-statements. Although the history of programming
languages is rife with examples of new features which increased engineer
productivity at the expense of additional CPU cycles, it would be
unfortunate if the benefits of <code class="docutils literal notranslate"><span class="pre">match</span></code> were counter-balanced by a significant
overall decrease in runtime performance.</p>
<p>Although this PEP does not specify any particular implementation strategy,
a few words about the prototype implementation and how it attempts to
maximize performance are in order.</p>
<p>Basically, the prototype implementation transforms all of the <code class="docutils literal notranslate"><span class="pre">match</span></code>
statement syntax into equivalent if/else blocks - or more accurately, into
Python byte codes that have the same effect. In other words, all of the
logic for testing instance types, sequence lengths, mapping keys and
so on are inlined in place of the <code class="docutils literal notranslate"><span class="pre">match</span></code>.</p>
<p>This is not the only possible strategy, nor is it necessarily the best.
For example, the instance checks could be memoized, especially
if there are multiple instances of the same class type but with different
arguments in a single match statement. It is also theoretically
possible for a future implementation to process case clauses or sub-patterns in
parallel using a decision tree rather than testing them one by one.</p>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#id69">Backwards Compatibility</a><a class="headerlink" href="#backwards-compatibility" title="Permalink to this headline">¶</a></h2>
<p>This PEP is fully backwards compatible: the <code class="docutils literal notranslate"><span class="pre">match</span></code> and <code class="docutils literal notranslate"><span class="pre">case</span></code>
keywords are proposed to be (and stay!) soft keywords, so their use as
variable, function, class, module or attribute names is not impeded at
all.</p>
<p>This is important because <code class="docutils literal notranslate"><span class="pre">match</span></code> is the name of a popular and
well-known function and method in the <code class="docutils literal notranslate"><span class="pre">re</span></code> module, which we have no
desire to break or deprecate.</p>
<p>The difference between hard and soft keywords is that hard keywords
are <em>always</em> reserved words, even in positions where they make no
sense (e.g. <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">class</span> <span class="pre">+</span> <span class="pre">1</span></code>), while soft keywords only get a special
meaning in context.  Since <a class="reference external" href="pep-0617.html">PEP 617</a> the parser backtracks, that means that on
different attempts to parse a code fragment it could interpret a soft
keyword differently.</p>
<p>For example, suppose the parser encounters the following input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span>
</pre></div>
</div>
<p>The parser first attempts to parse this as an expression statement.
It interprets <code class="docutils literal notranslate"><span class="pre">match</span></code> as a NAME token, and then considers <code class="docutils literal notranslate"><span class="pre">[x,</span>
<span class="pre">y]</span></code> to be a double subscript.  It then encounters the colon and has
to backtrack, since an expression statement cannot be followed by a
colon.  The parser then backtracks to the start of the line and finds
that <code class="docutils literal notranslate"><span class="pre">match</span></code> is a soft keyword allowed in this position.  It then
considers <code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y]</span></code> to be a list expression.  The colon then is just
what the parser expected, and the parse succeeds.</p>
</section>
<section id="impacts-on-third-party-tools">
<h2><a class="toc-backref" href="#id70">Impacts on third-party tools</a><a class="headerlink" href="#impacts-on-third-party-tools" title="Permalink to this headline">¶</a></h2>
<p>There are a lot of tools in the Python ecosystem that operate on Python
source code: linters, syntax highlighters, auto-formatters, and IDEs. These
will all need to be updated to include awareness of the <code class="docutils literal notranslate"><span class="pre">match</span></code> statement.</p>
<p>In general, these tools fall into one of two categories:</p>
<p><strong>Shallow</strong> parsers don’t try to understand the full syntax of Python, but
instead scan the source code for specific known patterns. IDEs, such as Visual
Studio Code, Emacs and TextMate, tend to fall in this category, since frequently
the source code is invalid while being edited, and a strict approach to parsing
would fail.</p>
<p>For these kinds of tools, adding knowledge of a new keyword is relatively
easy, just an addition to a table, or perhaps modification of a regular
expression.</p>
<p><strong>Deep</strong> parsers understand the complete syntax of Python. An example of this
is the auto-formatter Black <a class="footnote-reference brackets" href="#id28" id="id11">9</a>. A particular requirement with these kinds of
tools is that they not only need to understand the syntax of the current version
of Python, but older versions of Python as well.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">match</span></code> statement uses a soft keyword, and it is one of the first major
Python features to take advantage of the capabilities of the new PEG parser. This
means that third-party parsers which are not ‘PEG-compatible’ will have a hard
time with the new syntax.</p>
<p>It has been noted that a number of these third-party tools leverage common parsing
libraries (Black for example uses a fork of the lib2to3 parser). It may be helpful
to identify widely used parsing libraries (such as parso <a class="footnote-reference brackets" href="#id29" id="id12">10</a> and libCST <a class="footnote-reference brackets" href="#id30" id="id13">11</a>)
and upgrade them to be PEG compatible.</p>
<p>However, since this work would need to be done not only for the match statement,
but for <em>any</em> new Python syntax that leverages the capabilities of the PEG parser,
it is considered out of scope for this PEP. (Although it is suggested that this
would make a fine Summer of Code project.)</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#id71">Reference Implementation</a><a class="headerlink" href="#reference-implementation" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="https://github.com/brandtbucher/cpython/tree/patma">feature-complete CPython implementation</a> is available on
GitHub.</p>
<p>An <a class="reference external" href="https://mybinder.org/v2/gh/gvanrossum/patma/master?urlpath=lab/tree/playground-622.ipynb">interactive playground</a>
based on the above implementation was created using Binder <a class="footnote-reference brackets" href="#id31" id="id14">12</a> and Jupyter <a class="footnote-reference brackets" href="#id32" id="id15">13</a>.</p>
</section>
<section id="example-code">
<h2><a class="toc-backref" href="#id72">Example Code</a><a class="headerlink" href="#example-code" title="Permalink to this headline">¶</a></h2>
<p>A small <a class="reference external" href="https://github.com/gvanrossum/patma/tree/master/examples">collection of example code</a> is
available on GitHub.</p>
</section>
<section id="rejected-ideas">
<span id="id16"></span><h2><a class="toc-backref" href="#id73">Rejected Ideas</a><a class="headerlink" href="#rejected-ideas" title="Permalink to this headline">¶</a></h2>
<p>This general idea has been floating around for a pretty long time, and many
back and forth decisions were made. Here we summarize many alternative
paths that were taken but eventually abandoned.</p>
<section id="don-t-do-this-pattern-matching-is-hard-to-learn">
<h3><a class="toc-backref" href="#id74">Don’t do this, pattern matching is hard to learn</a><a class="headerlink" href="#don-t-do-this-pattern-matching-is-hard-to-learn" title="Permalink to this headline">¶</a></h3>
<p>In our opinion, the proposed pattern matching is not more difficult than
adding <code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> and <code class="docutils literal notranslate"><span class="pre">getattr()</span></code> to iterable unpacking. Also, we
believe the proposed syntax significantly improves readability for a wide
range of code patterns, by allowing to express <em>what</em> one wants to do, rather
than <em>how</em> to do it. We hope the few real code snippets we included in the PEP
above illustrate this comparison well enough. For more real code examples
and their translations see Ref. <a class="footnote-reference brackets" href="#id26" id="id17">7</a>.</p>
</section>
<section id="don-t-do-this-use-existing-method-dispatching-mechanisms">
<h3><a class="toc-backref" href="#id75">Don’t do this, use existing method dispatching mechanisms</a><a class="headerlink" href="#don-t-do-this-use-existing-method-dispatching-mechanisms" title="Permalink to this headline">¶</a></h3>
<p>We recognize that some of the use cases for the <code class="docutils literal notranslate"><span class="pre">match</span></code> statement overlap
with what can be done with traditional object-oriented programming (OOP) design
techniques using class inheritance. The ability to choose alternate
behaviors based on testing the runtime type of a match subject might
even seem heretical to strict OOP purists.</p>
<p>However, Python has always been a language that embraces a variety of
programming styles and paradigms. Classic Python design idioms such as
“duck”-typing go beyond the traditional OOP model.</p>
<p>We believe that there are important use cases where the use of <code class="docutils literal notranslate"><span class="pre">match</span></code> results
in a cleaner and more maintainable architecture. These use cases tend to
be characterized by a number of features:</p>
<ul class="simple">
<li><p>Algorithms which cut across traditional lines of data encapsulation. If an
algorithm is processing heterogeneous elements of different types (such as
evaluating or transforming an abstract syntax tree, or doing algebraic
manipulation of mathematical symbols), forcing the user to implement
the algorithm as individual methods on each element type results in
logic that is smeared across the entire codebase instead of being neatly
localized in one place.</p></li>
<li><p>Program architectures where the set of possible data types is relatively
stable, but there is an ever-expanding set of operations to be performed
on those data types. Doing this in a strict OOP fashion requires constantly
adding new methods to both the base class and subclasses to support the new
methods, “polluting” the base class with lots of very specialized method
definitions, and causing widespread disruption and churn in the code. By
contrast, in a <code class="docutils literal notranslate"><span class="pre">match</span></code>-based dispatch, adding a new behavior merely
involves writing a new <code class="docutils literal notranslate"><span class="pre">match</span></code> statement.</p></li>
<li><p>OOP also does not handle dispatching based on the <em>shape</em> of an object, such
as the length of a tuple, or the presence of an attribute – instead any such
dispatching decision must be encoded into the object’s type. Shape-based
dispatching is particularly interesting when it comes to handling “duck”-typed
objects.</p></li>
</ul>
<p>Where OOP is clearly superior is in the opposite case: where the set of possible
operations is relatively stable and well-defined, but there is an ever-growing
set of data types to operate on. A classic example of this is UI widget toolkits,
where there is a fixed set of interaction types (repaint, mouse click, keypress,
and so on), but the set of widget types is constantly expanding as developers
invent new and creative user interaction styles. Adding a new kind of widget
is a simple matter of writing a new subclass, whereas with a match-based approach
you end up having to add a new case clause to many widespread match statements.
We therefore don’t recommend using <code class="docutils literal notranslate"><span class="pre">match</span></code> in such a situation.</p>
</section>
<section id="allow-more-flexible-assignment-targets-instead">
<h3><a class="toc-backref" href="#id76">Allow more flexible assignment targets instead</a><a class="headerlink" href="#allow-more-flexible-assignment-targets-instead" title="Permalink to this headline">¶</a></h3>
<p>There was an idea to instead just generalize the iterable unpacking to much
more general assignment targets, instead of adding a new kind of statement.
This concept is known in some other languages as “irrefutable matches”. We
decided not to do this because inspection of real-life potential use cases
showed that in vast majority of cases destructuring is related to an <code class="docutils literal notranslate"><span class="pre">if</span></code>
condition. Also many of those are grouped in a series of exclusive choices.</p>
</section>
<section id="make-it-an-expression">
<h3><a class="toc-backref" href="#id77">Make it an expression</a><a class="headerlink" href="#make-it-an-expression" title="Permalink to this headline">¶</a></h3>
<p>In most other languages pattern matching is represented by an expression, not
statement. But making it an expression would be inconsistent with other
syntactic choices in Python. All decision making logic is expressed almost
exclusively in statements, so we decided to not deviate from this.</p>
</section>
<section id="use-a-hard-keyword">
<h3><a class="toc-backref" href="#id78">Use a hard keyword</a><a class="headerlink" href="#use-a-hard-keyword" title="Permalink to this headline">¶</a></h3>
<p>There were options to make <code class="docutils literal notranslate"><span class="pre">match</span></code> a hard keyword, or choose a different
keyword. Although using a hard keyword would simplify life for simple-minded
syntax highlighters, we decided not to use hard keyword for several reasons:</p>
<ul class="simple">
<li><p>Most importantly, the new parser doesn’t require us to do this. Unlike with
<code class="docutils literal notranslate"><span class="pre">async</span></code> that caused hardships with being a soft keyword for few releases,
here we can make <code class="docutils literal notranslate"><span class="pre">match</span></code> a permanent soft keyword.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">match</span></code> is so commonly used in existing code, that it would break almost
every existing program and will put a burden to fix code on many people who
may not even benefit from the new syntax.</p></li>
<li><p>It is hard to find an alternative keyword that would not be commonly used
in existing programs as an identifier, and would still clearly reflect the
meaning of the statement.</p></li>
</ul>
</section>
<section id="use-as-or-instead-of-case-for-case-clauses">
<h3><a class="toc-backref" href="#id79">Use <code class="docutils literal notranslate"><span class="pre">as</span></code> or <code class="docutils literal notranslate"><span class="pre">|</span></code> instead of <code class="docutils literal notranslate"><span class="pre">case</span></code> for case clauses</a><a class="headerlink" href="#use-as-or-instead-of-case-for-case-clauses" title="Permalink to this headline">¶</a></h3>
<p>The pattern matching proposed here is a combination of multi-branch control
flow (in line with <code class="docutils literal notranslate"><span class="pre">switch</span></code> in Algol-derived languages or <code class="docutils literal notranslate"><span class="pre">cond</span></code> in Lisp)
and object-deconstruction as found in functional languages.  While the proposed
keyword <code class="docutils literal notranslate"><span class="pre">case</span></code> highlights the multi-branch aspect, alternative keywords such
as <code class="docutils literal notranslate"><span class="pre">as</span></code> would equally be possible, highlighting the deconstruction aspect.
<code class="docutils literal notranslate"><span class="pre">as</span></code> or <code class="docutils literal notranslate"><span class="pre">with</span></code>, for instance, also have the advantage of already being
keywords in Python.  However, since <code class="docutils literal notranslate"><span class="pre">case</span></code> as a keyword can only occur as a
leading keyword inside  a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement, it is easy for a parser to
distinguish between its use as a keyword or as a variable.</p>
<p>Other variants would use a symbol like <code class="docutils literal notranslate"><span class="pre">|</span></code> or <code class="docutils literal notranslate"><span class="pre">=&gt;</span></code>, or go entirely without
special marker.</p>
<p>Since Python is a statement-oriented language in the tradition of Algol, and as
each composite statement starts with an identifying keyword, <code class="docutils literal notranslate"><span class="pre">case</span></code> seemed to
be most in line with Python’s style and traditions.</p>
</section>
<section id="use-a-flat-indentation-scheme">
<h3><a class="toc-backref" href="#id80">Use a flat indentation scheme</a><a class="headerlink" href="#use-a-flat-indentation-scheme" title="Permalink to this headline">¶</a></h3>
<p>There was an idea to use an alternative indentation scheme, for example where
every case clause would not be indented with respect to the initial <code class="docutils literal notranslate"><span class="pre">match</span></code>
part:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">expression</span><span class="p">:</span>
<span class="n">case</span> <span class="n">pattern_1</span><span class="p">:</span>
    <span class="o">...</span>
<span class="n">case</span> <span class="n">pattern_2</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The motivation is that although flat indentation saves some horizontal space,
it may look awkward to an eye of a Python programmer, because everywhere else
colon is followed by an indent. This will also complicate life for
simple-minded code editors. Finally, the horizontal space issue can be
alleviated by allowing “half-indent” (i.e. two spaces instead of four) for
match statements.</p>
<p>In sample programs using <code class="docutils literal notranslate"><span class="pre">match</span></code>, written as part of the development of this
PEP, a noticeable improvement in code brevity is observed, more than making up
for the additional indentation level.</p>
<p>Another proposal considered was to use flat indentation but put the
expression on the line after <code class="docutils literal notranslate"><span class="pre">match:</span></code>, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span><span class="p">:</span>
    <span class="n">expression</span>
<span class="n">case</span> <span class="n">pattern_1</span><span class="p">:</span>
    <span class="o">...</span>
<span class="n">case</span> <span class="n">pattern_2</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This was ultimately rejected because the first block would be a
novelty in Python’s grammar: a block whose only content is a single
expression rather than a sequence of statements.</p>
</section>
<section id="alternatives-for-constant-value-pattern">
<h3><a class="toc-backref" href="#id81">Alternatives for constant value pattern</a><a class="headerlink" href="#alternatives-for-constant-value-pattern" title="Permalink to this headline">¶</a></h3>
<p>This is probably the trickiest item. Matching against some pre-defined
constants is very common, but the dynamic nature of Python also makes it
ambiguous with capture patterns. Five other alternatives were considered:</p>
<ul>
<li><p>Use some implicit rules. For example, if a name was defined in the global
scope, then it refers to a constant, rather than representing a
capture pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here, the name &quot;spam&quot; must be defined in the global scope (and</span>
<span class="c1"># not shadowed locally). &quot;side&quot; must be local.</span>

<span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="n">spam</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Compares entree[-1] == spam.</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Assigns side = entree[-1].</span>
</pre></div>
</div>
<p>This however can cause surprises and action at a distance if someone
defines an unrelated coinciding name before the match statement.</p>
</li>
<li><p>Use a rule based on the case of a name. In particular, if the name
starts with a lowercase letter it would be a capture pattern, while if
it starts with uppercase it would refer to a constant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="n">SPAM</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Compares entree[-1] == SPAM.</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Assigns side = entree[-1].</span>
</pre></div>
</div>
<p>This works well with the recommendations for naming constants from
<a class="reference external" href="pep-0008.html">PEP 8</a>. The main objection is that there’s no other part of core
Python where the case of a name is semantically significant.
In addition, Python allows identifiers to use different scripts,
many of which (e.g. CJK) don’t have a case distinction.</p>
</li>
<li><p>Use extra parentheses to indicate lookup semantics for a given name. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="p">(</span><span class="n">spam</span><span class="p">):</span> <span class="o">...</span>  <span class="c1"># Compares entree[-1] == spam.</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span> <span class="o">...</span>    <span class="c1"># Assigns side = entree[-1].</span>
</pre></div>
</div>
<p>This may be a viable option, but it can create some visual noise if used
often. Also honestly it looks pretty unusual, especially in nested contexts.</p>
<p>This also has the problem that we may want or need parentheses to
disambiguate grouping in patterns, e.g. in <code class="docutils literal notranslate"><span class="pre">Point(x,</span> <span class="pre">y=(y</span> <span class="pre">:=</span>
<span class="pre">complex()))</span></code>.</p>
</li>
<li><p>Introduce a special symbol, for example <code class="docutils literal notranslate"><span class="pre">.</span></code>, <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">$</span></code>, or <code class="docutils literal notranslate"><span class="pre">^</span></code> to
indicate that a given name is a value to be matched against, not
to be assigned to.  An earlier version of this proposal used a
leading-dot rule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="o">.</span><span class="n">spam</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Compares entree[-1] == spam.</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span> <span class="o">...</span>   <span class="c1"># Assigns side = entree[-1].</span>
</pre></div>
</div>
<p>While potentially useful, it introduces strange-looking new syntax
without making the pattern syntax any more expressive.  Indeed,
named constants can be made to work with the existing rules by
converting them to <code class="docutils literal notranslate"><span class="pre">Enum</span></code> types, or enclosing them in their own
namespace (considered by the authors to be one honking great idea):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">entree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">case</span> <span class="n">Sides</span><span class="o">.</span><span class="n">SPAM</span><span class="p">:</span> <span class="o">...</span>  <span class="c1"># Compares entree[-1] == Sides.SPAM.</span>
    <span class="n">case</span> <span class="n">side</span><span class="p">:</span> <span class="o">...</span>        <span class="c1"># Assigns side = entree[-1].</span>
</pre></div>
</div>
<p>If needed, the leading-dot rule (or a similar variant) could be
added back later with no backward-compatibility issues.</p>
</li>
<li><p>There was also an idea to make lookup semantics the default, and require
<code class="docutils literal notranslate"><span class="pre">$</span></code> or <code class="docutils literal notranslate"><span class="pre">?</span></code> to be used in capture patterns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>match entree[-1]:
    case spam: ...   # Compares entree[-1] == spam.
    case side?: ...  # Assigns side = entree[-1].
</pre></div>
</div>
<p>There are a few issues with this:</p>
<ul>
<li><p>Capture patterns are more common in typical code, so it is
undesirable to require special syntax for them.</p></li>
<li><p>The authors are not aware of any other language that adorns
captures in this way.</p></li>
<li><p>None of the proposed syntaxes have any precedent in Python;
no other place in Python that binds names (e.g. <code class="docutils literal notranslate"><span class="pre">import</span></code>,
<code class="docutils literal notranslate"><span class="pre">def</span></code>, <code class="docutils literal notranslate"><span class="pre">for</span></code>) uses special marker syntax.</p></li>
<li><p>It would break the syntactic parallels of the current grammar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>match coords:
    case ($x, $y):
        return Point(x, y)  # Why not &quot;Point($x, $y)&quot;?
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<p>In the end, these alternatives were rejected because of the mentioned drawbacks.</p>
</section>
<section id="disallow-float-literals-in-patterns">
<h3><a class="toc-backref" href="#id82">Disallow float literals in patterns</a><a class="headerlink" href="#disallow-float-literals-in-patterns" title="Permalink to this headline">¶</a></h3>
<p>Because of the inexactness of floats, an early version of this proposal
did not allow floating-point constants to be used as match patterns. Part
of the justification for this prohibition is that Rust does this.</p>
<p>However, during implementation, it was discovered that distinguishing between
float values and other types required extra code in the VM that would slow
matches generally. Given that Python and Rust are very different languages
with different user bases and underlying philosophies, it was felt that
allowing float literals would not cause too much harm, and would be less
surprising to users.</p>
</section>
<section id="range-matching-patterns">
<h3><a class="toc-backref" href="#id83">Range matching patterns</a><a class="headerlink" href="#range-matching-patterns" title="Permalink to this headline">¶</a></h3>
<p>This would allow patterns such as <code class="docutils literal notranslate"><span class="pre">1...6</span></code>. However, there are a host of
ambiguities:</p>
<ul class="simple">
<li><p>Is the range open, half-open, or closed? (I.e. is <code class="docutils literal notranslate"><span class="pre">6</span></code> included in the
above example or not?)</p></li>
<li><p>Does the range match a single number, or a range object?</p></li>
<li><p>Range matching is often used for character ranges (‘a’…’z’) but that
won’t work in Python since there’s no character data type, just strings.</p></li>
<li><p>Range matching can be a significant performance optimization if you can
pre-build a jump table, but that’s not generally possible in Python due
to the fact that names can be dynamically rebound.</p></li>
</ul>
<p>Rather than creating a special-case syntax for ranges, it was decided
that allowing custom pattern objects (<code class="docutils literal notranslate"><span class="pre">InRange(0,</span> <span class="pre">6)</span></code>) would be more flexible
and less ambiguous; however those ideas have been postponed for the time
being (See <a class="reference internal" href="#deferred-ideas">deferred ideas</a>).</p>
</section>
<section id="use-dispatch-dict-semantics-for-matches">
<h3><a class="toc-backref" href="#id84">Use dispatch dict semantics for matches</a><a class="headerlink" href="#use-dispatch-dict-semantics-for-matches" title="Permalink to this headline">¶</a></h3>
<p>Implementations for classic <code class="docutils literal notranslate"><span class="pre">switch</span></code> statement sometimes use a pre-computed
hash table instead of a chained equality comparisons to gain some performance.
In the context of <code class="docutils literal notranslate"><span class="pre">match</span></code> statement this is technically also possible for
matches against literal patterns. However, having subtly different semantics
for different kinds of patterns would be too surprising for potentially
modest performance win.</p>
<p>We can still experiment with possible performance optimizations in this
direction if they will not cause semantic differences.</p>
</section>
<section id="use-continue-and-break-in-case-clauses">
<h3><a class="toc-backref" href="#id85">Use <code class="docutils literal notranslate"><span class="pre">continue</span></code> and <code class="docutils literal notranslate"><span class="pre">break</span></code> in case clauses.</a><a class="headerlink" href="#use-continue-and-break-in-case-clauses" title="Permalink to this headline">¶</a></h3>
<p>Another rejected proposal was to define new meanings for <code class="docutils literal notranslate"><span class="pre">continue</span></code>
and <code class="docutils literal notranslate"><span class="pre">break</span></code> inside of <code class="docutils literal notranslate"><span class="pre">match</span></code>, which would have the following behavior:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">continue</span></code> would exit the current case clause and continue matching
at the next case clause.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">break</span></code> would exit the match statement.</p></li>
</ul>
<p>However, there is a serious drawback to this proposal: if the <code class="docutils literal notranslate"><span class="pre">match</span></code> statement
is nested inside of a loop, the meanings of <code class="docutils literal notranslate"><span class="pre">continue</span></code> and <code class="docutils literal notranslate"><span class="pre">break</span></code> are now
changed. This may cause unexpected behavior during refactorings; also, an
argument can be made that there are other means to get the same behavior (such
as using guard conditions), and that in practice it’s likely that the existing
behavior of <code class="docutils literal notranslate"><span class="pre">continue</span></code> and <code class="docutils literal notranslate"><span class="pre">break</span></code> are far more useful.</p>
</section>
<section id="and-patterns">
<h3><a class="toc-backref" href="#id86">AND (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>) patterns</a><a class="headerlink" href="#and-patterns" title="Permalink to this headline">¶</a></h3>
<p>This proposal defines an OR-pattern (<code class="docutils literal notranslate"><span class="pre">|</span></code>) to match one of several alternates;
why not also an AND-pattern (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>)? Especially given that some other languages
(F# for example) support this.</p>
<p>However, it’s not clear how useful this would be. The semantics for matching
dictionaries, objects and sequences already incorporates an implicit ‘and’: all
attributes and elements mentioned must be present for the match to succeed. Guard
conditions can also support many of the use cases that a hypothetical ‘and’
operator would be used for.</p>
<p>In the end, it was decided that this would make the syntax more complex without
adding a significant benefit.</p>
</section>
<section id="negative-match-patterns">
<h3><a class="toc-backref" href="#id87">Negative match patterns</a><a class="headerlink" href="#negative-match-patterns" title="Permalink to this headline">¶</a></h3>
<p>A negation of a match pattern using the operator <code class="docutils literal notranslate"><span class="pre">!</span></code> as a prefix would match
exactly if the pattern itself does not match.  For instance, <code class="docutils literal notranslate"><span class="pre">!(3</span> <span class="pre">|</span> <span class="pre">4)</span></code>
would match anything except <code class="docutils literal notranslate"><span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p>This was rejected because there is documented evidence <a class="footnote-reference brackets" href="#id27" id="id18">8</a> that this feature
is rarely useful (in languages which support it) or used as double negation
<code class="docutils literal notranslate"><span class="pre">!!</span></code> to control variable scopes and prevent variable bindings (which does
not apply to Python). It can also be simulated using guard conditions.</p>
</section>
<section id="check-exhaustiveness-at-runtime">
<h3><a class="toc-backref" href="#id88">Check exhaustiveness at runtime</a><a class="headerlink" href="#check-exhaustiveness-at-runtime" title="Permalink to this headline">¶</a></h3>
<p>The question is what to do if no case clause has a matching pattern, and
there is no default case. An earlier version of the proposal specified that
the behavior in this case would be to throw an exception rather than
silently falling through.</p>
<p>The arguments back and forth were many, but in the end the EIBTI (Explicit
Is Better Than Implicit) argument won out: it’s better to have the programmer
explicitly throw an exception if that is the behavior they want.</p>
<p>For cases such as sealed classes and enums, where the patterns are all known
to be members of a discrete set, <a class="reference internal" href="#static-checkers">static checkers</a> can warn about missing
patterns.</p>
</section>
<section id="type-annotations-for-pattern-variables">
<h3><a class="toc-backref" href="#id89">Type annotations for pattern variables</a><a class="headerlink" href="#type-annotations-for-pattern-variables" title="Permalink to this headline">¶</a></h3>
<p>The proposal was to combine patterns with type annotations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">x</span><span class="p">:</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An int </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> and a string </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">:)</span>
    <span class="n">case</span> <span class="p">[</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Three ints&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This idea has a lot of problems. For one, the colon can only
be used inside of brackets or parens, otherwise the syntax becomes
ambiguous. And because Python disallows <code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> checks
on generic types, type annotations containing generics will not
work as expected.</p>
</section>
<section id="allow-rest-in-class-patterns">
<h3><a class="toc-backref" href="#id90">Allow <code class="docutils literal notranslate"><span class="pre">*rest</span></code> in class patterns</a><a class="headerlink" href="#allow-rest-in-class-patterns" title="Permalink to this headline">¶</a></h3>
<p>It was proposed to allow <code class="docutils literal notranslate"><span class="pre">*rest</span></code> in a class pattern, giving a
variable to be bound to all positional arguments at once (similar to
its use in unpacking assignments).  It would provide some symmetry
with sequence patterns.  But it might be confused with a feature to
provide the <em>values</em> for all positional arguments at once.  And there
seems to be no practical need for it, so it was scrapped.  (It could
easily be added at a later stage if a need arises.)</p>
</section>
<section id="disallow-a-in-constant-value-patterns">
<h3><a class="toc-backref" href="#id91">Disallow <code class="docutils literal notranslate"><span class="pre">_.a</span></code> in constant value patterns</a><a class="headerlink" href="#disallow-a-in-constant-value-patterns" title="Permalink to this headline">¶</a></h3>
<p>The first public draft said that the initial name in a constant value
pattern must not be <code class="docutils literal notranslate"><span class="pre">_</span></code> because <code class="docutils literal notranslate"><span class="pre">_</span></code> has a special meaning in
pattern matching, so this would be invalid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="n">_</span><span class="o">.</span><span class="n">a</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>(However, <code class="docutils literal notranslate"><span class="pre">a._</span></code> would be legal and load the attribute with name
<code class="docutils literal notranslate"><span class="pre">_</span></code> of the object <code class="docutils literal notranslate"><span class="pre">a</span></code> as usual.)</p>
<p>There was some pushback against this on python-dev (some people have a
legitimate use for <code class="docutils literal notranslate"><span class="pre">_</span></code> as an important global variable, esp. in
i18n) and the only reason for this prohibition was to prevent some
user confusion.  But it’s not the hill to die on.</p>
</section>
<section id="use-some-other-token-as-wildcard">
<h3><a class="toc-backref" href="#id92">Use some other token as wildcard</a><a class="headerlink" href="#use-some-other-token-as-wildcard" title="Permalink to this headline">¶</a></h3>
<p>It has been proposed to use <code class="docutils literal notranslate"><span class="pre">...</span></code> (i.e., the ellipsis token) or
<code class="docutils literal notranslate"><span class="pre">*</span></code> (star) as a wildcard.  However, both these look as if an
arbitrary number of items is omitted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">z</span><span class="p">]:</span> <span class="o">...</span>
<span class="n">case</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">z</span><span class="p">]:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Both look like the would match a sequence of at two or more items,
capturing the first and last values.</p>
<p>In addition, if <code class="docutils literal notranslate"><span class="pre">*</span></code> were to be used as the wildcard character, we
would have to come up with some other way to capture the rest of a
sequence, currently spelled like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="p">[</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">]:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Using an ellipsis would also be more confusing in documentation and
examples, where <code class="docutils literal notranslate"><span class="pre">...</span></code> is routinely used to indicate something
obvious or irrelevant.  (Yes, this would also be an argument against
the other uses of <code class="docutils literal notranslate"><span class="pre">...</span></code> in Python, but that water is already under
the bridge.)</p>
<p>Another proposal was to use <code class="docutils literal notranslate"><span class="pre">?</span></code>.  This could be acceptable, although
it would require modifying the tokenizer.</p>
<p>Also, <code class="docutils literal notranslate"><span class="pre">_</span></code> is already used
as a throwaway target in other contexts, and this use is pretty
similar.  This example is from <code class="docutils literal notranslate"><span class="pre">difflib.py</span></code> in the stdlib:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Perhaps the most convincing argument is that <code class="docutils literal notranslate"><span class="pre">_</span></code> is used as the
wildcard in every other language we’ve looked at supporting pattern
matching: C#, Elixir, Erlang, F#, Haskell, Mathematica, OCaml, Ruby,
Rust, Scala, and Swift.  Now, in general, we should not be concerned
too much with what another language does, since Python is clearly
different from all these languages.  However, if there is such an
overwhelming and strong consensus, Python should not go out of its way
to do something completely different – particularly given that <code class="docutils literal notranslate"><span class="pre">_</span></code>
works well in Python and is already in use as a throwaway target.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">_</span></code> is not assigned to by patterns – this avoids
conflicts with the use of <code class="docutils literal notranslate"><span class="pre">_</span></code> as a marker for translatable strings
and an alias for <code class="docutils literal notranslate"><span class="pre">gettext.gettext</span></code>, as recommended by the
<code class="docutils literal notranslate"><span class="pre">gettext</span></code> module documentation.</p>
</section>
<section id="use-some-other-syntax-instead-of-for-or-patterns">
<h3><a class="toc-backref" href="#id93">Use some other syntax instead of <code class="docutils literal notranslate"><span class="pre">|</span></code> for OR patterns</a><a class="headerlink" href="#use-some-other-syntax-instead-of-for-or-patterns" title="Permalink to this headline">¶</a></h3>
<p>A few alternatives to using <code class="docutils literal notranslate"><span class="pre">|</span></code> to separate the alternatives in OR
patterns have been proposed.  Instead of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="mi">401</span><span class="o">|</span><span class="mi">403</span><span class="o">|</span><span class="mi">404</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some HTTP error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>the following proposals have been fielded:</p>
<ul>
<li><p>Use a comma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">404</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some HTTP error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This looks too much like a tuple – we would have to find a
different way to spell tuples, and the construct would have to be
parenthesized inside the argument list of a class pattern.  In
general, commas already have many different meanings in Python, we
shouldn’t add more.</p>
</li>
<li><p>Allow stacked cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="mi">401</span><span class="p">:</span>
<span class="n">case</span> <span class="mi">403</span><span class="p">:</span>
<span class="n">case</span> <span class="mi">404</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some HTTP error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is how this would be done in C, using its fall-through
semantics for cases.  However, we don’t want to mislead people into
thinking that <code class="docutils literal notranslate"><span class="pre">match</span></code>/<code class="docutils literal notranslate"><span class="pre">case</span></code> uses fall-through semantics (which
are a common source of bugs in C).  Also, this would be a novel
indentation pattern, which might make it harder to support in IDEs
and such (it would break the simple rule “add an indentation level
after a line ending in a colon”).  Finally, this wouldn’t support
OR patterns nested inside other patterns.</p>
</li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">in</span></code> followed by a comma-separated list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="ow">in</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">404</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some HTTP error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This wouldn’t work for OR patterns nested inside other patterns,
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A corner of the unit square&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">or</span></code> keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="mi">401</span> <span class="ow">or</span> <span class="mi">403</span> <span class="ow">or</span> <span class="mi">404</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some HTTP error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This could work, and the readability is not too different from using
<code class="docutils literal notranslate"><span class="pre">|</span></code>.  Some users expressed a preference for <code class="docutils literal notranslate"><span class="pre">or</span></code> because they
associate <code class="docutils literal notranslate"><span class="pre">|</span></code> with bitwise OR.  However:</p>
<ol class="arabic">
<li><p>Many other languages that have pattern matching use <code class="docutils literal notranslate"><span class="pre">|</span></code> (the
list includes Elixir, Erlang, F#, Mathematica, OCaml, Ruby, Rust,
and Scala).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> is shorter, which may contribute to the readability of
nested patterns like <code class="docutils literal notranslate"><span class="pre">Point(0|1,</span> <span class="pre">0|1)</span></code>.</p></li>
<li><p>Some people mistakenly believe that <code class="docutils literal notranslate"><span class="pre">|</span></code> has the wrong priority;
but since patterns don’t support other operators it has the same
priority as in expressions.</p></li>
<li><p>Python users use <code class="docutils literal notranslate"><span class="pre">or</span></code> very frequently, and may build an
impression that it is strongly associated with Boolean
short-circuiting.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> is used between alternatives in regular expressions
and in EBNF grammars (like Python’s own).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> not just used for bitwise OR – it’s used for set unions,
dict merging (<span class="target" id="index-0"></span><a class="pep reference external" href="pep-0584.html"><strong>PEP 584</strong></a>) and is being considered as an
alternative to <code class="docutils literal notranslate"><span class="pre">typing.Union</span></code> (<span class="target" id="index-1"></span><a class="pep reference external" href="pep-0604.html"><strong>PEP 604</strong></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> works better as a visual separator, especially between
strings.  Compare:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="s2">&quot;spam&quot;</span> <span class="ow">or</span> <span class="s2">&quot;eggs&quot;</span> <span class="ow">or</span> <span class="s2">&quot;cheese&quot;</span><span class="p">:</span>
</pre></div>
</div>
<p>to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="s2">&quot;spam&quot;</span> <span class="o">|</span> <span class="s2">&quot;eggs&quot;</span> <span class="o">|</span> <span class="s2">&quot;cheese&quot;</span><span class="p">:</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ul>
</section>
<section id="add-an-else-clause">
<h3><a class="toc-backref" href="#id94">Add an <code class="docutils literal notranslate"><span class="pre">else</span></code> clause</a><a class="headerlink" href="#add-an-else-clause" title="Permalink to this headline">¶</a></h3>
<p>We decided not to add an <code class="docutils literal notranslate"><span class="pre">else</span></code> clause for several reasons.</p>
<ul class="simple">
<li><p>It is redundant, since we already have <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">_:</span></code></p></li>
<li><p>There will forever be confusion about the indentation level of the
<code class="docutils literal notranslate"><span class="pre">else:</span></code> – should it align with the list of cases or with the
<code class="docutils literal notranslate"><span class="pre">match</span></code> keyword?</p></li>
<li><p>Completionist arguments like “every other statement has one” are
false – only those statements have an <code class="docutils literal notranslate"><span class="pre">else</span></code> clause where it adds
new functionality.</p></li>
</ul>
</section>
</section>
<section id="deferred-ideas">
<span id="id19"></span><h2><a class="toc-backref" href="#id95">Deferred Ideas</a><a class="headerlink" href="#deferred-ideas" title="Permalink to this headline">¶</a></h2>
<p>There were a number of proposals to extend the matching syntax that we
decided to postpone for possible future PEP. These fall into the realm of
“cool idea but not essential”, and it was felt that it might be better to
acquire some real-world data on how the match statement will be used in
practice before moving forward with some of these proposals.</p>
<p>Note that in each case, the idea was judged to be a “two-way door”,
meaning that there should be no backwards-compatibility issues with adding
these features later.</p>
<section id="one-off-syntax-variant">
<h3><a class="toc-backref" href="#id96">One-off syntax variant</a><a class="headerlink" href="#one-off-syntax-variant" title="Permalink to this headline">¶</a></h3>
<p>While inspecting some code-bases that may benefit the most from the proposed
syntax, it was found that single clause matches would be used relatively often,
mostly for various special-casing. In other languages this is supported in
the form of one-off matches. We proposed to support such one-off matches too:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">match</span> <span class="n">value</span> <span class="k">as</span> <span class="n">pattern</span> <span class="p">[</span><span class="ow">and</span> <span class="n">guard</span><span class="p">]:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>or, alternatively, without the <code class="docutils literal notranslate"><span class="pre">if</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">value</span> <span class="k">as</span> <span class="n">pattern</span> <span class="p">[</span><span class="k">if</span> <span class="n">guard</span><span class="p">]:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>as equivalent to the following expansion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">value</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">pattern</span> <span class="p">[</span><span class="k">if</span> <span class="n">guard</span><span class="p">]:</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>To illustrate how this will benefit readability, consider this (slightly
simplified) snippet from real code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">CallExpr</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">callee</span><span class="p">,</span> <span class="n">NameExpr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NameExpr</span><span class="p">)):</span>
        <span class="n">call</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">callee</span><span class="o">.</span><span class="n">name</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
        <span class="o">...</span>  <span class="c1"># Continue special-casing &#39;call&#39; and &#39;arg&#39;</span>
<span class="o">...</span>  <span class="c1"># Follow with common code</span>
</pre></div>
</div>
<p>This can be rewritten in a more straightforward way as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">match</span> <span class="n">node</span> <span class="k">as</span> <span class="n">CallExpr</span><span class="p">(</span><span class="n">callee</span><span class="o">=</span><span class="n">NameExpr</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">call</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">NameExpr</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">arg</span><span class="p">)]):</span>
    <span class="o">...</span>  <span class="c1"># Continue special-casing &#39;call&#39; and &#39;arg&#39;</span>
<span class="o">...</span>  <span class="c1"># Follow with common code</span>
</pre></div>
</div>
<p>This one-off form would not allow <code class="docutils literal notranslate"><span class="pre">elif</span> <span class="pre">match</span></code> statements, as it was only
meant to handle a single pattern case. It was intended to be special case
of a <code class="docutils literal notranslate"><span class="pre">match</span></code> statement, not a special case of an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">match</span> <span class="n">value_1</span> <span class="k">as</span> <span class="n">patter_1</span> <span class="p">[</span><span class="ow">and</span> <span class="n">guard_1</span><span class="p">]:</span>
    <span class="o">...</span>
<span class="k">elif</span> <span class="n">match</span> <span class="n">value_2</span> <span class="k">as</span> <span class="n">pattern_2</span> <span class="p">[</span><span class="ow">and</span> <span class="n">guard_2</span><span class="p">]:</span>  <span class="c1"># Not allowed</span>
    <span class="o">...</span>
<span class="k">elif</span> <span class="n">match</span> <span class="n">value_3</span> <span class="k">as</span> <span class="n">pattern_3</span> <span class="p">[</span><span class="ow">and</span> <span class="n">guard_3</span><span class="p">]:</span>  <span class="c1"># Not allowed</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># Also not allowed</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This would defeat the purpose of one-off matches as a complement to exhaustive
full matches - it’s better and clearer to use a full match in this case.</p>
<p>Similarly, <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">not</span> <span class="pre">match</span></code> would not be allowed, since <code class="docutils literal notranslate"><span class="pre">match</span> <span class="pre">...</span> <span class="pre">as</span> <span class="pre">...</span></code> is not
an expression. Nor do we propose a <code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">match</span></code> construct present in some languages
with pattern matching, since although it may be handy, it will likely be used
rarely.</p>
</section>
<section id="other-pattern-based-constructions">
<h3><a class="toc-backref" href="#id97">Other pattern-based constructions</a><a class="headerlink" href="#other-pattern-based-constructions" title="Permalink to this headline">¶</a></h3>
<p>Many other languages supporting pattern-matching use it as a basis for multiple
language constructs, including a matching operator, a generalized form
of assignment, a filter for loops, a method for synchronizing communication,
or specialized if statements. Some of these were mentioned in the discussion
of the first draft. Another question asked was why this particular form (joining
binding and conditional selection) was chosen while other forms were not.</p>
<p>Introducing more uses of patterns would be too bold and premature given the
experience we have using patterns, and would make this proposal too
complicated. The statement as presented provides a form of the feature that
is sufficiently general to be useful while being self-contained, and without
having a massive impact on the syntax and semantics of the language as a whole.</p>
<p>After some experience with this feature, the community may have a better
feeling for what other uses of pattern matching could be valuable in Python.</p>
</section>
<section id="algebraic-matching-of-repeated-names">
<h3><a class="toc-backref" href="#id98">Algebraic matching of repeated names</a><a class="headerlink" href="#algebraic-matching-of-repeated-names" title="Permalink to this headline">¶</a></h3>
<p>A technique occasionally seen in functional languages like Erlang and Elixir is
to use a match variable multiple times in the same pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">value</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Point is on a diagonal!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The idea here is that the first appearance of <code class="docutils literal notranslate"><span class="pre">x</span></code> would bind the value
to the name, and subsequent occurrences would verify that the incoming
value was equal to the value previously bound. If the value was not equal,
the match would fail.</p>
<p>However, there are a number of subtleties involved with mixing load-store
semantics for capture patterns. For the moment, we decided to make repeated
use of names within the same pattern an error; we can always relax this
restriction later without affecting backwards compatibility.</p>
<p>Note that you <strong>can</strong> use the same name more than once in alternate choices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">value</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">x</span> <span class="o">|</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span>
        <span class="c1"># etc.</span>
</pre></div>
</div>
</section>
<section id="custom-matching-protocol">
<span id="extended-matching"></span><h3><a class="toc-backref" href="#id99">Custom matching protocol</a><a class="headerlink" href="#custom-matching-protocol" title="Permalink to this headline">¶</a></h3>
<p>During the initial design discussions for this PEP, there were a lot of ideas
thrown around about custom matchers. There were a couple of motivations for
this:</p>
<ul class="simple">
<li><p>Some classes might want to expose a different set of “matchable” names
than the actual class properties.</p></li>
<li><p>Some classes might have properties that are expensive to calculate, and
therefore shouldn’t be evaluated unless the match pattern actually needed
access to them.</p></li>
<li><p>There were ideas for exotic matchers such as <code class="docutils literal notranslate"><span class="pre">IsInstance()</span></code>,
<code class="docutils literal notranslate"><span class="pre">InRange()</span></code>, <code class="docutils literal notranslate"><span class="pre">RegexMatchingGroup()</span></code> and so on.</p></li>
<li><p>In order for built-in types and standard library classes to be able
to support matching in a reasonable and intuitive way, it was believed
that these types would need to implement special matching logic.</p></li>
</ul>
<p>These customized match behaviors would be controlled by a special
<code class="docutils literal notranslate"><span class="pre">__match__</span></code> method on the class name. There were two competing variants:</p>
<ul class="simple">
<li><p>A ‘full-featured’ match protocol which would pass in not only
the subject to be matched, but detailed information about
which attributes the specified pattern was interested in.</p></li>
<li><p>A simplified match protocol, which only passed in the subject value,
and which returned a “proxy object” (which in most cases could be
just the subject) containing the matchable attributes.</p></li>
</ul>
<p>Here’s an example of one version of the more complex protocol proposed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="n">expr</span><span class="p">:</span>
    <span class="n">case</span> <span class="n">BinaryOp</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">x</span><span class="p">),</span> <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">y</span><span class="p">)):</span>
        <span class="o">...</span>

<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">PatternObject</span>
<span class="n">BinaryOp</span><span class="o">.</span><span class="n">__match__</span><span class="p">(</span>
    <span class="p">(),</span>
    <span class="p">{</span>
        <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="n">PatternObject</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">},</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="n">PatternObject</span><span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">},</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>One drawback of this protocol is that the arguments to <code class="docutils literal notranslate"><span class="pre">__match__</span></code>
would be expensive to construct, and could not be pre-computed due to
the fact that, because of the way names are bound, there are no real
constants in Python. It also meant that the <code class="docutils literal notranslate"><span class="pre">__match__</span></code> method would
have to re-implement much of the logic of matching which would otherwise
be implemented in C code in the Python VM. As a result, this option would
perform poorly compared to an equilvalent <code class="docutils literal notranslate"><span class="pre">if</span></code>-statement.</p>
<p>The simpler protocol suffered from the fact that although it was more
performant, it was much less flexible, and did not allow for many of
the creative custom matchers that people were dreaming up.</p>
<p>Late in the design process, however, it was realized that the need for
a custom matching protocol was much less than anticipated. Virtually
all the realistic (as opposed to fanciful) uses cases brought up could
be handled by the built-in matching behavior, although in a few cases
an extra guard condition was required to get the desired effect.</p>
<p>Moreover, it turned out that none of the standard library classes really
needed any special matching support other than an appropriate
<code class="docutils literal notranslate"><span class="pre">__match_args__</span></code> property.</p>
<p>The decision to postpone this feature came with a realization that this is
not a one-way door; that a more flexible and customizable matching protocol
can be added later, especially as we gain more experience with real-world
use cases and actual user needs.</p>
<p>The authors of this PEP expect that the <code class="docutils literal notranslate"><span class="pre">match</span></code> statement will evolve
over time as usage patterns and idioms evolve, in a way similar to what
other “multi-stage” PEPs have done in the past. When this happens, the
extended matching issue can be revisited.</p>
</section>
<section id="parameterized-matching-syntax">
<h3><a class="toc-backref" href="#id100">Parameterized Matching Syntax</a><a class="headerlink" href="#parameterized-matching-syntax" title="Permalink to this headline">¶</a></h3>
<p>(Also known as “Class Instance Matchers”.)</p>
<p>This is another variant of the “custom match classes” idea that would allow
diverse kinds of custom matchers mentioned in the previous section – however,
instead of using an extended matching protocol, it would be achieved by
introducing an additional pattern type with its own syntax. This pattern type
would accept two distinct sets of parameters: one set which consists of the
actual parameters passed into the pattern object’s constructor, and another
set representing the binding variables for the pattern.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">__match__</span></code> method of these objects could use the constructor parameter
values in deciding what was a valid match.</p>
<p>This would allow patterns such as <code class="docutils literal notranslate"><span class="pre">InRange&lt;0,</span> <span class="pre">6&gt;(value)</span></code>, which would match
a number in the range 0..6 and assign the matched value to ‘value’. Similarly,
one could have a pattern which tests for the existence of a named group in
a regular expression match result (different meaning of the word ‘match’).</p>
<p>Although there is some support for this idea, there was a lot of bikeshedding
on the syntax (there are not a lot of attractive options available)
and no clear consensus was reached, so it was decided that for now, this
feature is not essential to the PEP.</p>
</section>
<section id="pattern-utility-library">
<h3><a class="toc-backref" href="#id101">Pattern Utility Library</a><a class="headerlink" href="#pattern-utility-library" title="Permalink to this headline">¶</a></h3>
<p>Both of the previous ideas would be accompanied by a new Python standard
library module which would contain a rich set of useful matchers.
However, it is not really possible to implement such a library without
adopting one of the extended pattern proposals given in the previous sections,
so this idea is also deferred.</p>
</section>
</section>
<section id="acknowledgments">
<h2><a class="toc-backref" href="#id102">Acknowledgments</a><a class="headerlink" href="#acknowledgments" title="Permalink to this headline">¶</a></h2>
<p>We are grateful for the help of the following individuals (among many
others) for helping out during various phases of the writing of this
PEP:</p>
<ul class="simple">
<li><p>Gregory P. Smith</p></li>
<li><p>Jim Jewett</p></li>
<li><p>Mark Shannon</p></li>
<li><p>Nate Lust</p></li>
<li><p>Taine Zhao</p></li>
</ul>
</section>
<section id="version-history">
<h2><a class="toc-backref" href="#id103">Version History</a><a class="headerlink" href="#version-history" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Initial version</p></li>
<li><p>Substantial rewrite, including:</p>
<ul class="simple">
<li><p>Minor clarifications, grammar and typo corrections</p></li>
<li><p>Rename various concepts</p></li>
<li><p>Additional discussion of rejected ideas, including:</p>
<ul>
<li><p>Why we choose <code class="docutils literal notranslate"><span class="pre">_</span></code> for wildcard patterns</p></li>
<li><p>Why we choose <code class="docutils literal notranslate"><span class="pre">|</span></code> for OR patterns</p></li>
<li><p>Why we choose not to use special syntax for capture variables</p></li>
<li><p>Why this pattern matching operation and not others</p></li>
</ul>
</li>
<li><p>Clarify exception and side effect semantics</p></li>
<li><p>Clarify partial binding semantics</p></li>
<li><p>Drop restriction on use of <code class="docutils literal notranslate"><span class="pre">_</span></code> in load contexts</p></li>
<li><p>Drop the default single positional argument being the whole
subject except for a handful of built-in types</p></li>
<li><p>Simplify behavior of <code class="docutils literal notranslate"><span class="pre">__match_args__</span></code></p></li>
<li><p>Drop the <code class="docutils literal notranslate"><span class="pre">__match__</span></code> protocol (moved to <a class="reference internal" href="#deferred-ideas">deferred ideas</a>)</p></li>
<li><p>Drop <code class="docutils literal notranslate"><span class="pre">ImpossibleMatchError</span></code> exception</p></li>
<li><p>Drop leading dot for loads (moved to <a class="reference internal" href="#deferred-ideas">deferred ideas</a>)</p></li>
<li><p>Reworked the initial sections (everything before <a class="reference internal" href="#id5">syntax</a>)</p></li>
<li><p>Added an overview of all the types of patterns before the
detailed description</p></li>
<li><p>Added simplified syntax next to the description of each pattern</p></li>
<li><p>Separate description of the wildcard from capture patterns</p></li>
<li><p>Added Daniel F Moisset as sixth co-author</p></li>
</ul>
</li>
</ol>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id104">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id20"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Pattern_matching">https://en.wikipedia.org/wiki/Pattern_matching</a></p>
</dd>
<dt class="label" id="id21"><span class="brackets">2</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id9">2</a>)</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Algebraic_data_type">https://en.wikipedia.org/wiki/Algebraic_data_type</a></p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><a class="reference external" href="https://doc.rust-lang.org/reference/patterns.html">https://doc.rust-lang.org/reference/patterns.html</a></p>
</dd>
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id2">4</a></span></dt>
<dd><p><a class="reference external" href="https://docs.scala-lang.org/tour/pattern-matching.html">https://docs.scala-lang.org/tour/pattern-matching.html</a></p>
</dd>
<dt class="label" id="id24"><span class="brackets">5</span></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/dataclasses.html">https://docs.python.org/3/library/dataclasses.html</a></p>
</dd>
<dt class="label" id="id25"><span class="brackets"><a class="fn-backref" href="#id10">6</a></span></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/typing.html">https://docs.python.org/3/library/typing.html</a></p>
</dd>
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id17">7</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/gvanrossum/patma/blob/master/EXAMPLES.md">https://github.com/gvanrossum/patma/blob/master/EXAMPLES.md</a></p>
</dd>
<dt class="label" id="id27"><span class="brackets"><a class="fn-backref" href="#id18">8</a></span></dt>
<dd><p><a class="reference external" href="https://dl.acm.org/doi/abs/10.1145/2480360.2384582">https://dl.acm.org/doi/abs/10.1145/2480360.2384582</a></p>
</dd>
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id11">9</a></span></dt>
<dd><p><a class="reference external" href="https://black.readthedocs.io/en/stable/">https://black.readthedocs.io/en/stable/</a></p>
</dd>
<dt class="label" id="id29"><span class="brackets"><a class="fn-backref" href="#id12">10</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/davidhalter/parso">https://github.com/davidhalter/parso</a></p>
</dd>
<dt class="label" id="id30"><span class="brackets"><a class="fn-backref" href="#id13">11</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/Instagram/LibCST">https://github.com/Instagram/LibCST</a></p>
</dd>
<dt class="label" id="id31"><span class="brackets"><a class="fn-backref" href="#id14">12</a></span></dt>
<dd><p><a class="reference external" href="https://mybinder.org">https://mybinder.org</a></p>
</dd>
<dt class="label" id="id32"><span class="brackets"><a class="fn-backref" href="#id15">13</a></span></dt>
<dd><p><a class="reference external" href="https://jupyter.org">https://jupyter.org</a></p>
</dd>
</dl>
</section>
<section id="appendix-a-full-grammar">
<span id="appendix-a"></span><h2><a class="toc-backref" href="#id105">Appendix A – Full Grammar</a><a class="headerlink" href="#appendix-a-full-grammar" title="Permalink to this headline">¶</a></h2>
<p>Here is the full grammar for <code class="docutils literal notranslate"><span class="pre">match_stmt</span></code>.  This is an additional
alternative for <code class="docutils literal notranslate"><span class="pre">compound_stmt</span></code>.  It should be understood that
<code class="docutils literal notranslate"><span class="pre">match</span></code> and <code class="docutils literal notranslate"><span class="pre">case</span></code> are soft keywords, i.e. they are not reserved
words in other grammatical contexts (including at the start of a line
if there is no colon where expected).  By convention, hard keywords
use single quotes while soft keywords use double quotes.</p>
<p>Other notation used beyond standard EBNF:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SEP.RULE+</span></code> is shorthand for <code class="docutils literal notranslate"><span class="pre">RULE</span> <span class="pre">(SEP</span> <span class="pre">RULE)*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!RULE</span></code> is a negative lookahead assertion</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>match_expr:
    | star_named_expression &#39;,&#39; star_named_expressions?
    | named_expression
match_stmt: &quot;match&quot; match_expr &#39;:&#39; NEWLINE INDENT case_block+ DEDENT
case_block: &quot;case&quot; patterns [guard] &#39;:&#39; block
guard: &#39;if&#39; named_expression
patterns: value_pattern &#39;,&#39; [values_pattern] | pattern
pattern: walrus_pattern | or_pattern
walrus_pattern: NAME &#39;:=&#39; or_pattern
or_pattern: &#39;|&#39;.closed_pattern+
closed_pattern:
    | capture_pattern
    | literal_pattern
    | constant_pattern
    | group_pattern
    | sequence_pattern
    | mapping_pattern
    | class_pattern
capture_pattern: NAME !(&#39;.&#39; | &#39;(&#39; | &#39;=&#39;)
literal_pattern:
    | signed_number !(&#39;+&#39; | &#39;-&#39;)
    | signed_number &#39;+&#39; NUMBER
    | signed_number &#39;-&#39; NUMBER
    | strings
    | &#39;None&#39;
    | &#39;True&#39;
    | &#39;False&#39;
constant_pattern: attr !(&#39;.&#39; | &#39;(&#39; | &#39;=&#39;)
group_pattern: &#39;(&#39; patterns &#39;)&#39;
sequence_pattern: &#39;[&#39; [values_pattern] &#39;]&#39; | &#39;(&#39; &#39;)&#39;
mapping_pattern: &#39;{&#39; items_pattern? &#39;}&#39;
class_pattern:
    | name_or_attr &#39;(&#39; &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.pattern+ &#39;,&#39;? &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.keyword_pattern+ &#39;,&#39;? &#39;)&#39;
    | name_or_attr &#39;(&#39; &#39;,&#39;.pattern+ &#39;,&#39; &#39;,&#39;.keyword_pattern+ &#39;,&#39;? &#39;)&#39;
signed_number: NUMBER | &#39;-&#39; NUMBER
attr: name_or_attr &#39;.&#39; NAME
name_or_attr: attr | NAME
values_pattern: &#39;,&#39;.value_pattern+ &#39;,&#39;?
items_pattern: &#39;,&#39;.key_value_pattern+ &#39;,&#39;?
keyword_pattern: NAME &#39;=&#39; or_pattern
value_pattern: &#39;*&#39; capture_pattern | pattern
key_value_pattern:
    | (literal_pattern | constant_pattern) &#39;:&#39; or_pattern
    | &#39;**&#39; capture_pattern
</pre></div>
</div>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#id106">Copyright</a><a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<span>Source: <a class="reference external" href="https://github.com/python/peps/blob/master/pep-0622.rst">https://github.com/python/peps/blob/master/pep-0622.rst</a></span><div class="zero-height line"><br /></div>
<span>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/master/pep-0622.rst">2021-06-28T11:16:08Z</a></span>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../contents/">PEPs</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">PEP Table of Contents (needed for Sphinx):</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pep-0000/">PEP 0 – Index of Python Enhancement Proposals (PEPs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0001/">PEP 1 – PEP Purpose and Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0002/">PEP 2 – Procedure for Adding New Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0003/">PEP 3 – Guidelines for Handling Bug Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0004/">PEP 4 – Deprecation of Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0005/">PEP 5 – Guidelines for Language Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0006/">PEP 6 – Bug Fix Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0007/">PEP 7 – Style Guide for C Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0008/">PEP 8 – Style Guide for Python Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0009/">PEP 9 – Sample Plaintext PEP Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0010/">PEP 10 – Voting Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0011/">PEP 11 – Removing support for little used platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0012/">PEP 12 – Sample reStructuredText PEP Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0013/">PEP 13 – Python Language Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0020/">PEP 20 – The Zen of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0042/">PEP 42 – Feature Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0100/">PEP 100 – Python Unicode Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0101/">PEP 101 – Doing Python Releases 101</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0102/">PEP 102 – Doing Python Micro Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0103/">PEP 103 – Collecting information about git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0160/">PEP 160 – Python 1.6 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0200/">PEP 200 – Python 2.0 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0201/">PEP 201 – Lockstep Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0202/">PEP 202 – List Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0203/">PEP 203 – Augmented Assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0204/">PEP 204 – Range Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0205/">PEP 205 – Weak References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0206/">PEP 206 – Python Advanced Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0207/">PEP 207 – Rich Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0208/">PEP 208 – Reworking the Coercion Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0209/">PEP 209 – Multi-dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0210/">PEP 210 – Decoupling the Interpreter Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0211/">PEP 211 – Adding A New Outer Product Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0212/">PEP 212 – Loop Counter Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0213/">PEP 213 – Attribute Access Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0214/">PEP 214 – Extended Print Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0215/">PEP 215 – String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0216/">PEP 216 – Docstring Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0217/">PEP 217 – Display Hook for Interactive Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0218/">PEP 218 – Adding a Built-In Set Object Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0219/">PEP 219 – Stackless Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0220/">PEP 220 – Coroutines, Generators, Continuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0221/">PEP 221 – Import As</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0222/">PEP 222 – Web Library Enhancements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0223/">PEP 223 – Change the Meaning of ``\x`` Escapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0224/">PEP 224 – Attribute Docstrings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0225/">PEP 225 – Elementwise/Objectwise Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0226/">PEP 226 – Python 2.1 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0227/">PEP 227 – Statically Nested Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0228/">PEP 228 – Reworking Python’s Numeric Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0229/">PEP 229 – Using Distutils to Build Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0230/">PEP 230 – Warning Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0231/">PEP 231 – __findattr__()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0232/">PEP 232 – Function Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0233/">PEP 233 – Python Online Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0234/">PEP 234 – Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0235/">PEP 235 – Import on Case-Insensitive Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0236/">PEP 236 – Back to the __future__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0237/">PEP 237 – Unifying Long Integers and Integers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0238/">PEP 238 – Changing the Division Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0239/">PEP 239 – Adding a Rational Type to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0240/">PEP 240 – Adding a Rational Literal to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0241/">PEP 241 – Metadata for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0242/">PEP 242 – Numeric Kinds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0243/">PEP 243 – Module Repository Upload Mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0244/">PEP 244 – The ``directive`` statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0245/">PEP 245 – Python Interface Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0246/">PEP 246 – Object Adaptation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0247/">PEP 247 – API for Cryptographic Hash Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0248/">PEP 248 – Python Database API Specification v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0249/">PEP 249 – Python Database API Specification v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0250/">PEP 250 – Using site-packages on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0251/">PEP 251 – Python 2.2 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0252/">PEP 252 – Making Types Look More Like Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0253/">PEP 253 – Subtyping Built-in Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0254/">PEP 254 – Making Classes Look More Like Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0255/">PEP 255 – Simple Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0256/">PEP 256 – Docstring Processing System Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0257/">PEP 257 – Docstring Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0258/">PEP 258 – Docutils Design Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0259/">PEP 259 – Omit printing newline after newline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0260/">PEP 260 – Simplify xrange()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0261/">PEP 261 – Support for “wide” Unicode characters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0262/">PEP 262 – A Database of Installed Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0263/">PEP 263 – Defining Python Source Code Encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0264/">PEP 264 – Future statements in simulated shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0265/">PEP 265 – Sorting Dictionaries by Value</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0266/">PEP 266 – Optimizing Global Variable/Attribute Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0267/">PEP 267 – Optimized Access to Module Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0268/">PEP 268 – Extended HTTP functionality and WebDAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0269/">PEP 269 – Pgen Module for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0270/">PEP 270 – uniq method for list objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0271/">PEP 271 – Prefixing sys.path by command line option</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0272/">PEP 272 – API for Block Encryption Algorithms v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0273/">PEP 273 – Import Modules from Zip Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0274/">PEP 274 – Dict Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0275/">PEP 275 – Switching on Multiple Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0276/">PEP 276 – Simple Iterator for ints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0277/">PEP 277 – Unicode file name support for Windows NT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0278/">PEP 278 – Universal Newline Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0279/">PEP 279 – The enumerate() built-in function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0280/">PEP 280 – Optimizing access to globals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0281/">PEP 281 – Loop Counter Iteration with range and xrange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0282/">PEP 282 – A Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0283/">PEP 283 – Python 2.3 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0284/">PEP 284 – Integer for-loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0285/">PEP 285 – Adding a bool type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0286/">PEP 286 – Enhanced Argument Tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0287/">PEP 287 – reStructuredText Docstring Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0288/">PEP 288 – Generators Attributes and Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0289/">PEP 289 – Generator Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0290/">PEP 290 – Code Migration and Modernization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0291/">PEP 291 – Backward Compatibility for the Python 2 Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0292/">PEP 292 – Simpler String Substitutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0293/">PEP 293 – Codec Error Handling Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0294/">PEP 294 – Type Names in the types Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0295/">PEP 295 – Interpretation of multiline string constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0296/">PEP 296 – Adding a bytes Object Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0297/">PEP 297 – Support for System Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0298/">PEP 298 – The Locked Buffer Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0299/">PEP 299 – Special __main__() function in modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0301/">PEP 301 – Package Index and Metadata for Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0302/">PEP 302 – New Import Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0303/">PEP 303 – Extend divmod() for Multiple Divisors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0304/">PEP 304 – Controlling Generation of Bytecode Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0305/">PEP 305 – CSV File API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0306/">PEP 306 – How to Change Python’s Grammar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0307/">PEP 307 – Extensions to the pickle protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0308/">PEP 308 – Conditional Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0309/">PEP 309 – Partial Function Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0310/">PEP 310 – Reliable Acquisition/Release Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0311/">PEP 311 – Simplified Global Interpreter Lock Acquisition for Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0312/">PEP 312 – Simple Implicit Lambda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0313/">PEP 313 – Adding Roman Numeral Literals to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0314/">PEP 314 – Metadata for Python Software Packages v1.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0315/">PEP 315 – Enhanced While Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0316/">PEP 316 – Programming by Contract for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0317/">PEP 317 – Eliminate Implicit Exception Instantiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0318/">PEP 318 – Decorators for Functions and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0319/">PEP 319 – Python Synchronize/Asynchronize Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0320/">PEP 320 – Python 2.4 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0321/">PEP 321 – Date/Time Parsing and Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0322/">PEP 322 – Reverse Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0323/">PEP 323 – Copyable Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0324/">PEP 324 – subprocess - New process module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0325/">PEP 325 – Resource-Release Support for Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0326/">PEP 326 – A Case for Top and Bottom Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0327/">PEP 327 – Decimal Data Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0328/">PEP 328 – Imports: Multi-Line and Absolute/Relative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0329/">PEP 329 – Treating Builtins as Constants in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0330/">PEP 330 – Python Bytecode Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0331/">PEP 331 – Locale-Independent Float/String Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0332/">PEP 332 – Byte vectors and String/Unicode Unification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0333/">PEP 333 – Python Web Server Gateway Interface v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0334/">PEP 334 – Simple Coroutines via SuspendIteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0335/">PEP 335 – Overloadable Boolean Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0336/">PEP 336 – Make None Callable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0337/">PEP 337 – Logging Usage in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0338/">PEP 338 – Executing modules as scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0339/">PEP 339 – Design of the CPython Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0340/">PEP 340 – Anonymous Block Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0341/">PEP 341 – Unifying try-except and try-finally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0342/">PEP 342 – Coroutines via Enhanced Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0343/">PEP 343 – The “with” Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0344/">PEP 344 – Exception Chaining and Embedded Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0345/">PEP 345 – Metadata for Python Software Packages 1.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0346/">PEP 346 – User Defined (“``with``”) Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0347/">PEP 347 – Migrating the Python CVS to Subversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0348/">PEP 348 – Exception Reorganization for Python 3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0349/">PEP 349 – Allow str() to return unicode strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0350/">PEP 350 – Codetags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0351/">PEP 351 – The freeze protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0352/">PEP 352 – Required Superclass for Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0353/">PEP 353 – Using ssize_t as the index type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0354/">PEP 354 – Enumerations in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0355/">PEP 355 – Path - Object oriented filesystem paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0356/">PEP 356 – Python 2.5 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0357/">PEP 357 – Allowing Any Object to be Used for Slicing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0358/">PEP 358 – The “bytes” Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0359/">PEP 359 – The “make” Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0360/">PEP 360 – Externally Maintained Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0361/">PEP 361 – Python 2.6 and 3.0 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0362/">PEP 362 – Function Signature Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0363/">PEP 363 – Syntax For Dynamic Attribute Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0364/">PEP 364 – Transitioning to the Py3K Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0365/">PEP 365 – Adding the pkg_resources module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0366/">PEP 366 – Main module explicit relative imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0367/">PEP 367 – New Super</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0368/">PEP 368 – Standard image protocol and class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0369/">PEP 369 – Post import hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0370/">PEP 370 – Per user site-packages directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0371/">PEP 371 – Addition of the multiprocessing package to the standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0372/">PEP 372 – Adding an ordered dictionary to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0373/">PEP 373 – Python 2.7 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0374/">PEP 374 – Choosing a distributed VCS for the Python project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0375/">PEP 375 – Python 3.1 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0376/">PEP 376 – Database of Installed Python Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0377/">PEP 377 – Allow __enter__() methods to skip the statement body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0378/">PEP 378 – Format Specifier for Thousands Separator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0379/">PEP 379 – Adding an Assignment Expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0380/">PEP 380 – Syntax for Delegating to a Subgenerator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0381/">PEP 381 – Mirroring infrastructure for PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0382/">PEP 382 – Namespace Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0383/">PEP 383 – Non-decodable Bytes in System Character Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0384/">PEP 384 – Defining a Stable ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0385/">PEP 385 – Migrating from Subversion to Mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0386/">PEP 386 – Changing the version comparison module in Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0387/">PEP 387 – Backwards Compatibility Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0389/">PEP 389 – argparse - New Command Line Parsing Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0390/">PEP 390 – Static metadata for Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0391/">PEP 391 – Dictionary-Based Configuration For Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0392/">PEP 392 – Python 3.2 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0393/">PEP 393 – Flexible String Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0394/">PEP 394 – The “python” Command on Unix-Like Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0395/">PEP 395 – Qualified Names for Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0396/">PEP 396 – Module Version Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0397/">PEP 397 – Python launcher for Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0398/">PEP 398 – Python 3.3 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0399/">PEP 399 – Pure Python/C Accelerator Module Compatibility Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0400/">PEP 400 – Deprecate codecs.StreamReader and codecs.StreamWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0401/">PEP 401 – BDFL Retirement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0402/">PEP 402 – Simplified Package Layout and Partitioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0403/">PEP 403 – General purpose decorator clause (aka “&#64;in” clause)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0404/">PEP 404 – Python 2.8 Un-release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0405/">PEP 405 – Python Virtual Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0406/">PEP 406 – Improved Encapsulation of Import State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0407/">PEP 407 – New release cycle and introducing long-term support versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0408/">PEP 408 – Standard library __preview__ package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0409/">PEP 409 – Suppressing exception context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0410/">PEP 410 – Use decimal.Decimal type for timestamps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0411/">PEP 411 – Provisional packages in the Python standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0412/">PEP 412 – Key-Sharing Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0413/">PEP 413 – Faster evolution of the Python Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0414/">PEP 414 – Explicit Unicode Literal for Python 3.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0415/">PEP 415 – Implement context suppression with exception attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0416/">PEP 416 – Add a frozendict builtin type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0417/">PEP 417 – Including mock in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0418/">PEP 418 – Add monotonic time, performance counter, and process time functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0419/">PEP 419 – Protecting cleanup statements from interruptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0420/">PEP 420 – Implicit Namespace Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0421/">PEP 421 – Adding sys.implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0422/">PEP 422 – Simpler customisation of class creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0423/">PEP 423 – Naming conventions and recipes related to packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0424/">PEP 424 – A method for exposing a length hint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0425/">PEP 425 – Compatibility Tags for Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0426/">PEP 426 – Metadata for Python Software Packages 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0427/">PEP 427 – The Wheel Binary Package Format 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0428/">PEP 428 – The pathlib module – object-oriented filesystem paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0429/">PEP 429 – Python 3.4 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0430/">PEP 430 – Migrating to Python 3 as the default online documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0431/">PEP 431 – Time zone support improvements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0432/">PEP 432 – Restructuring the CPython startup sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0433/">PEP 433 – Easier suppression of file descriptor inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0434/">PEP 434 – IDLE Enhancement Exception for All Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0435/">PEP 435 – Adding an Enum type to the Python standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0436/">PEP 436 – The Argument Clinic DSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0437/">PEP 437 – A DSL for specifying signatures, annotations and argument converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0438/">PEP 438 – Transitioning to release-file hosting on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0439/">PEP 439 – Inclusion of implicit pip bootstrap in Python installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0440/">PEP 440 – Version Identification and Dependency Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0441/">PEP 441 – Improving Python ZIP Application Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0442/">PEP 442 – Safe object finalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0443/">PEP 443 – Single-dispatch generic functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0444/">PEP 444 – Python Web3 Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0445/">PEP 445 – Add new APIs to customize Python memory allocators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0446/">PEP 446 – Make newly created file descriptors non-inheritable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0447/">PEP 447 – Add __getdescriptor__ method to metaclass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0448/">PEP 448 – Additional Unpacking Generalizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0449/">PEP 449 – Removal of the PyPI Mirror Auto Discovery and Naming Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0450/">PEP 450 – Adding A Statistics Module To The Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0451/">PEP 451 – A ModuleSpec Type for the Import System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0452/">PEP 452 – API for Cryptographic Hash Functions v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0453/">PEP 453 – Explicit bootstrapping of pip in Python installations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0454/">PEP 454 – Add a new tracemalloc module to trace Python memory allocations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0455/">PEP 455 – Adding a key-transforming dictionary to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0456/">PEP 456 – Secure and interchangeable hash algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0457/">PEP 457 – Notation For Positional-Only Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0458/">PEP 458 – Secure PyPI downloads with signed repository metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0459/">PEP 459 – Standard Metadata Extensions for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0460/">PEP 460 – Add binary interpolation and formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0461/">PEP 461 – Adding % formatting to bytes and bytearray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0462/">PEP 462 – Core development workflow automation for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0463/">PEP 463 – Exception-catching expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0464/">PEP 464 – Removal of the PyPI Mirror Authenticity API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0465/">PEP 465 – A dedicated infix operator for matrix multiplication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0466/">PEP 466 – Network Security Enhancements for Python 2.7.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0467/">PEP 467 – Minor API improvements for binary sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0468/">PEP 468 – Preserving the order of \*\*kwargs in a function.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0469/">PEP 469 – Migration of dict iteration code to Python 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0470/">PEP 470 – Removing External Hosting Support on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0471/">PEP 471 – os.scandir() function – a better and faster directory iterator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0472/">PEP 472 – Support for indexing with keyword arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0473/">PEP 473 – Adding structured data to built-in exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0474/">PEP 474 – Creating forge.python.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0475/">PEP 475 – Retry system calls failing with EINTR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0476/">PEP 476 – Enabling certificate verification by default for stdlib http clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0477/">PEP 477 – Backport ensurepip (PEP 453) to Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0478/">PEP 478 – Python 3.5 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0479/">PEP 479 – Change StopIteration handling inside generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0480/">PEP 480 – Surviving a Compromise of PyPI: End-to-end signing of packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0481/">PEP 481 – Migrate CPython to Git, Github, and Phabricator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0482/">PEP 482 – Literature Overview for Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0483/">PEP 483 – The Theory of Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0484/">PEP 484 – Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0485/">PEP 485 – A Function for testing approximate equality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0486/">PEP 486 – Make the Python Launcher aware of virtual environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0487/">PEP 487 – Simpler customisation of class creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0488/">PEP 488 – Elimination of PYO files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0489/">PEP 489 – Multi-phase extension module initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0490/">PEP 490 – Chain exceptions at C level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0491/">PEP 491 – The Wheel Binary Package Format 1.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0492/">PEP 492 – Coroutines with async and await syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0493/">PEP 493 – HTTPS verification migration tools for Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0494/">PEP 494 – Python 3.6 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0495/">PEP 495 – Local Time Disambiguation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0496/">PEP 496 – Environment Markers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0497/">PEP 497 – A standard mechanism for backward compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0498/">PEP 498 – Literal String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0499/">PEP 499 – ``python -m foo`` should bind ``sys.modules[‘foo’]`` in addition to ``sys.modules[‘__main__’]``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0500/">PEP 500 – A protocol for delegating datetime methods to their
tzinfo implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0501/">PEP 501 – General purpose string interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0502/">PEP 502 – String Interpolation - Extended Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0503/">PEP 503 – Simple Repository API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0504/">PEP 504 – Using the System RNG by default</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0505/">PEP 505 – None-aware operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0506/">PEP 506 – Adding A Secrets Module To The Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0507/">PEP 507 – Migrate CPython to Git and GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0508/">PEP 508 – Dependency specification for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0509/">PEP 509 – Add a private version to dict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0510/">PEP 510 – Specialize functions with guards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0511/">PEP 511 – API for code transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0512/">PEP 512 – Migrating from hg.python.org to GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0513/">PEP 513 – A Platform Tag for Portable Linux Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0514/">PEP 514 – Python registration in the Windows registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0515/">PEP 515 – Underscores in Numeric Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0516/">PEP 516 – Build system abstraction for pip/conda etc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0517/">PEP 517 – A build-system independent format for source trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0518/">PEP 518 – Specifying Minimum Build System Requirements for Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0519/">PEP 519 – Adding a file system path protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0520/">PEP 520 – Preserving Class Attribute Definition Order</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0521/">PEP 521 – Managing global context via ‘with’ blocks in generators and coroutines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0522/">PEP 522 – Allow BlockingIOError in security sensitive APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0523/">PEP 523 – Adding a frame evaluation API to CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0524/">PEP 524 – Make os.urandom() blocking on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0525/">PEP 525 – Asynchronous Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0526/">PEP 526 – Syntax for Variable Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0527/">PEP 527 – Removing Un(der)used file types/extensions on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0528/">PEP 528 – Change Windows console encoding to UTF-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0529/">PEP 529 – Change Windows filesystem encoding to UTF-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0530/">PEP 530 – Asynchronous Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0531/">PEP 531 – Existence checking operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0532/">PEP 532 – A circuit breaking protocol and binary operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0533/">PEP 533 – Deterministic cleanup for iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0534/">PEP 534 – Improved Errors for Missing Standard Library Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0535/">PEP 535 – Rich comparison chaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0536/">PEP 536 – Final Grammar for Literal String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0537/">PEP 537 – Python 3.7 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0538/">PEP 538 – Coercing the legacy C locale to a UTF-8 based locale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0539/">PEP 539 – A New C-API for Thread-Local Storage in CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0540/">PEP 540 – Add a new UTF-8 Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0541/">PEP 541 – Package Index Name Retention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0542/">PEP 542 – Dot Notation Assignment In Function Header</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0543/">PEP 543 – A Unified TLS API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0544/">PEP 544 – Protocols: Structural subtyping (static duck typing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0545/">PEP 545 – Python Documentation Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0546/">PEP 546 – Backport ssl.MemoryBIO and ssl.SSLObject to Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0547/">PEP 547 – Running extension modules using the -m option</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0548/">PEP 548 – More Flexible Loop Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0549/">PEP 549 – Instance Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0550/">PEP 550 – Execution Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0551/">PEP 551 – Security transparency in the Python runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0552/">PEP 552 – Deterministic pycs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0553/">PEP 553 – Built-in breakpoint()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0554/">PEP 554 – Multiple Interpreters in the Stdlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0555/">PEP 555 – Context-local variables (contextvars)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0556/">PEP 556 – Threaded garbage collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0557/">PEP 557 – Data Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0558/">PEP 558 – Defined semantics for locals()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0559/">PEP 559 – Built-in noop()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0560/">PEP 560 – Core support for typing module and generic types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0561/">PEP 561 – Distributing and Packaging Type Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0562/">PEP 562 – Module __getattr__ and __dir__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0563/">PEP 563 – Postponed Evaluation of Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0564/">PEP 564 – Add new time functions with nanosecond resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0565/">PEP 565 – Show DeprecationWarning in __main__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0566/">PEP 566 – Metadata for Python Software Packages 2.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0567/">PEP 567 – Context Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0568/">PEP 568 – Generator-sensitivity for Context Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0569/">PEP 569 – Python 3.8 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0570/">PEP 570 – Python Positional-Only Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0571/">PEP 571 – The manylinux2010 Platform Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0572/">PEP 572 – Assignment Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0573/">PEP 573 – Module State Access from C Extension Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0574/">PEP 574 – Pickle protocol 5 with out-of-band data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0575/">PEP 575 – Unifying function/method classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0576/">PEP 576 – Rationalize Built-in function classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0577/">PEP 577 – Augmented Assignment Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0578/">PEP 578 – Python Runtime Audit Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0579/">PEP 579 – Refactoring C functions and methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0580/">PEP 580 – The C call protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0581/">PEP 581 – Using GitHub Issues for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0582/">PEP 582 – Python local packages directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0583/">PEP 583 – A Concurrency Memory Model for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0584/">PEP 584 – Add Union Operators To dict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0585/">PEP 585 – Type Hinting Generics In Standard Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0586/">PEP 586 – Literal Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0587/">PEP 587 – Python Initialization Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0588/">PEP 588 – GitHub Issues Migration Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0589/">PEP 589 – TypedDict: Type Hints for Dictionaries with a Fixed Set of Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0590/">PEP 590 – Vectorcall: a fast calling protocol for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0591/">PEP 591 – Adding a final qualifier to typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0592/">PEP 592 – Adding “Yank” Support to the Simple API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0593/">PEP 593 – Flexible function and variable annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0594/">PEP 594 – Removing dead batteries from the standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0595/">PEP 595 – Improving bugs.python.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0596/">PEP 596 – Python 3.9 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0597/">PEP 597 – Add optional EncodingWarning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0598/">PEP 598 – Introducing incremental feature releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0599/">PEP 599 – The manylinux2014 Platform Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0600/">PEP 600 – Future ‘manylinux’ Platform Tags for Portable Linux Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0601/">PEP 601 – Forbid return/break/continue breaking out of finally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0602/">PEP 602 – Annual Release Cycle for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0603/">PEP 603 – Adding a frozenmap type to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0604/">PEP 604 – Allow writing union types as ``X | Y``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0605/">PEP 605 – A rolling feature release stream for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0606/">PEP 606 – Python Compatibility Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0607/">PEP 607 – Reducing CPython’s Feature Delivery Latency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0608/">PEP 608 – Coordinated Python release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0609/">PEP 609 – PyPA Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0610/">PEP 610 – Recording the Direct URL Origin of installed distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0611/">PEP 611 – The one million limit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0612/">PEP 612 – Parameter Specification Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0613/">PEP 613 – Explicit Type Aliases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0614/">PEP 614 – Relaxing Grammar Restrictions On Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0615/">PEP 615 – Support for the IANA Time Zone Database in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0616/">PEP 616 – String methods to remove prefixes and suffixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0617/">PEP 617 – New PEG parser for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0618/">PEP 618 – Add Optional Length-Checking To zip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0619/">PEP 619 – Python 3.10 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0620/">PEP 620 – Hide implementation details from the C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0621/">PEP 621 – Storing project metadata in pyproject.toml</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PEP 622 – Structural Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0623/">PEP 623 – Remove wstr from Unicode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0624/">PEP 624 – Remove Py_UNICODE encoder APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0625/">PEP 625 – File name of a Source Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0626/">PEP 626 – Precise line numbers for debugging and other tools.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0627/">PEP 627 – Recording installed projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0628/">PEP 628 – Add ``math.tau``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0629/">PEP 629 – Versioning PyPI’s Simple API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0630/">PEP 630 – Isolating Extension Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0631/">PEP 631 – Dependency specification in pyproject.toml based on PEP 508</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0632/">PEP 632 – Deprecate distutils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0633/">PEP 633 – Dependency specification in pyproject.toml using an exploded TOML table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0634/">PEP 634 – Structural Pattern Matching: Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0635/">PEP 635 – Structural Pattern Matching: Motivation and Rationale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0636/">PEP 636 – Structural Pattern Matching: Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0637/">PEP 637 – Support for indexing with keyword arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0638/">PEP 638 – Syntactic Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0639/">PEP 639 – Metadata for Python Software Packages 2.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0640/">PEP 640 – Unused variable syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0641/">PEP 641 – Using an underscore in the version portion of Python 3.10 compatibility tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0642/">PEP 642 – Explicit Pattern Syntax for Structural Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0643/">PEP 643 – Metadata for Package Source Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0644/">PEP 644 – Require OpenSSL 1.1.1 or newer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0645/">PEP 645 – Allow writing optional types as ``x?``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0646/">PEP 646 – Variadic Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0647/">PEP 647 – User-Defined Type Guards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0648/">PEP 648 – Extensible customizations of the interpreter at startup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0649/">PEP 649 – Deferred Evaluation Of Annotations Using Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0650/">PEP 650 – Specifying Installer Requirements for Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0651/">PEP 651 – Robust Stack Overflow Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0652/">PEP 652 – Maintaining the Stable ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0653/">PEP 653 – Precise Semantics for Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0654/">PEP 654 – Exception Groups and except*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0655/">PEP 655 – Marking individual TypedDict items as required or potentially-missing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0656/">PEP 656 – Platform Tag for Linux Distributions Using Musl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0657/">PEP 657 – Include Fine Grained Error Locations in Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0658/">PEP 658 – Serve Distribution Metadata in the Simple Repository API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0659/">PEP 659 – Specializing Adaptive Interpreter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0660/">PEP 660 – Editable installs for pyproject.toml based builds (wheel based)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0661/">PEP 661 – Sentinel Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0662/">PEP 662 – Editable installs via virtual wheels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0666/">PEP 666 – Reject Foolish Indentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0754/">PEP 754 – IEEE 754 Floating Point Special Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0801/">PEP 801 – Reserved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3000/">PEP 3000 – Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3001/">PEP 3001 – Procedure for reviewing and improving standard library modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3002/">PEP 3002 – Procedure for Backwards-Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3003/">PEP 3003 – Python Language Moratorium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3099/">PEP 3099 – Things that will Not Change in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3100/">PEP 3100 – Miscellaneous Python 3.0 Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3101/">PEP 3101 – Advanced String Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3102/">PEP 3102 – Keyword-Only Arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3103/">PEP 3103 – A Switch/Case Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3104/">PEP 3104 – Access to Names in Outer Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3105/">PEP 3105 – Make print a function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3106/">PEP 3106 – Revamping dict.keys(), .values() and .items()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3107/">PEP 3107 – Function Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3108/">PEP 3108 – Standard Library Reorganization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3109/">PEP 3109 – Raising Exceptions in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3110/">PEP 3110 – Catching Exceptions in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3111/">PEP 3111 – Simple input built-in in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3112/">PEP 3112 – Bytes literals in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3113/">PEP 3113 – Removal of Tuple Parameter Unpacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3114/">PEP 3114 – Renaming iterator.next() to iterator.__next__()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3115/">PEP 3115 – Metaclasses in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3116/">PEP 3116 – New I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3117/">PEP 3117 – Postfix type declarations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3118/">PEP 3118 – Revising the buffer protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3119/">PEP 3119 – Introducing Abstract Base Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3120/">PEP 3120 – Using UTF-8 as the default source encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3121/">PEP 3121 – Extension Module Initialization and Finalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3122/">PEP 3122 – Delineation of the main module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3123/">PEP 3123 – Making PyObject_HEAD conform to standard C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3124/">PEP 3124 – Overloading, Generic Functions, Interfaces, and Adaptation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3125/">PEP 3125 – Remove Backslash Continuation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3126/">PEP 3126 – Remove Implicit String Concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3127/">PEP 3127 – Integer Literal Support and Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3128/">PEP 3128 – BList: A Faster List-like Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3129/">PEP 3129 – Class Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3130/">PEP 3130 – Access to Current Module/Class/Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3131/">PEP 3131 – Supporting Non-ASCII Identifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3132/">PEP 3132 – Extended Iterable Unpacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3133/">PEP 3133 – Introducing Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3134/">PEP 3134 – Exception Chaining and Embedded Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3135/">PEP 3135 – New Super</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3136/">PEP 3136 – Labeled break and continue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3137/">PEP 3137 – Immutable Bytes and Mutable Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3138/">PEP 3138 – String representation in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3139/">PEP 3139 – Cleaning out sys and the “interpreter” module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3140/">PEP 3140 – str(container) should call str(item), not repr(item)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3141/">PEP 3141 – A Type Hierarchy for Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3142/">PEP 3142 – Add a “while” clause to generator expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3143/">PEP 3143 – Standard daemon process library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3144/">PEP 3144 – IP Address Manipulation Library for the Python Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3145/">PEP 3145 – Asynchronous I/O For subprocess.Popen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3146/">PEP 3146 – Merging Unladen Swallow into CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3147/">PEP 3147 – PYC Repository Directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3148/">PEP 3148 – futures - execute computations asynchronously</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3149/">PEP 3149 – ABI version tagged .so files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3150/">PEP 3150 – Statement local namespaces (aka “given” clause)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3151/">PEP 3151 – Reworking the OS and IO exception hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3152/">PEP 3152 – Cofunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3153/">PEP 3153 – Asynchronous IO support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3154/">PEP 3154 – Pickle protocol version 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3155/">PEP 3155 – Qualified name for classes and functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3156/">PEP 3156 – Asynchronous IO Support Rebooted: the “asyncio” Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3333/">PEP 3333 – Python Web Server Gateway Interface v1.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8000/">PEP 8000 – Python Language Governance Proposal Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8001/">PEP 8001 – Python Governance Voting Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8002/">PEP 8002 – Open Source Governance Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8010/">PEP 8010 – The Technical Leader Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8011/">PEP 8011 – Python Governance Model Lead by Trio of Pythonistas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8012/">PEP 8012 – The Community Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8013/">PEP 8013 – The External Council Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8014/">PEP 8014 – The Commons Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8015/">PEP 8015 – Organization of the Python community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8016/">PEP 8016 – The Steering Council Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8100/">PEP 8100 – January 2019 steering council election</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8101/">PEP 8101 – 2020 Term steering council election</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8102/">PEP 8102 – 2021 Term steering council election</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents/">Documentation overview</a><ul>
      <li>Previous: <a href="../pep-0621/" title="previous chapter">PEP 621 – Storing project metadata in pyproject.toml</a></li>
      <li>Next: <a href="../pep-0623/" title="next chapter">PEP 623 – Remove wstr from Unicode</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pep-0622.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
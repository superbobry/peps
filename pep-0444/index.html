
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PEP 444 – Python Web3 Interface &#8212; peps.python.org</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="PEP 445 – Add new APIs to customize Python memory allocators" href="../pep-0445/" />
    <link rel="prev" title="PEP 443 – Single-dispatch generic functions" href="../pep-0443/" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pep-444-python-web3-interface">
<h1 class="page-title">PEP 444 – Python Web3 Interface<a class="headerlink" href="#pep-444-python-web3-interface" title="Permalink to this headline">¶</a></h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">PEP</dt>
<dd class="field-odd"><p>444</p>
</dd>
<dt class="field-even">Title</dt>
<dd class="field-even"><p>Python Web3 Interface</p>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Chris McDonough &lt;<a class="reference external" href="mailto:chrism&#37;&#52;&#48;plope&#46;com?subject=PEP%20-1">chrism&#32;&#97;t&#32;plope.com</a>&gt;,
Armin Ronacher &lt;<a class="reference external" href="mailto:armin&#46;ronacher&#37;&#52;&#48;active-4&#46;com?subject=PEP%20-1">armin.ronacher&#32;&#97;t&#32;active-4.com</a>&gt;</p>
</dd>
<dt class="field-even">Discussions-To</dt>
<dd class="field-even"><p>Python Web-SIG &lt;<a class="reference external" href="mailto:web-sig&#37;&#52;&#48;python&#46;org">web-sig<span>&#64;</span>python<span>&#46;</span>org</a>&gt;</p>
</dd>
<dt class="field-odd">Status</dt>
<dd class="field-odd"><p>Deferred</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Informational</p>
</dd>
<dt class="field-odd">Created</dt>
<dd class="field-odd"><p>19-Jul-2010</p>
</dd>
</dl>
<hr class="docutils" />
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#abstract" id="id20">Abstract</a></p></li>
<li><p><a class="reference internal" href="#pep-deferral" id="id21">PEP Deferral</a></p></li>
<li><p><a class="reference internal" href="#rationale-and-goals" id="id22">Rationale and Goals</a></p></li>
<li><p><a class="reference internal" href="#differences-from-wsgi" id="id23">Differences from WSGI</a></p></li>
<li><p><a class="reference internal" href="#specification-overview" id="id24">Specification Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#the-application-framework-side" id="id25">The Application/Framework Side</a></p></li>
<li><p><a class="reference internal" href="#the-server-gateway-side" id="id26">The Server/Gateway Side</a></p></li>
<li><p><a class="reference internal" href="#middleware-components-that-play-both-sides" id="id27">Middleware: Components that Play Both Sides</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#specification-details" id="id28">Specification Details</a></p>
<ul>
<li><p><a class="reference internal" href="#environ-variables" id="id29"><code class="docutils literal notranslate"><span class="pre">environ</span></code> Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#input-stream" id="id30">Input Stream</a></p></li>
<li><p><a class="reference internal" href="#error-stream" id="id31">Error Stream</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#values-returned-by-a-web3-application" id="id32">Values Returned by A Web3 Application</a></p></li>
<li><p><a class="reference internal" href="#dealing-with-compatibility-across-python-versions" id="id33">Dealing with Compatibility Across Python Versions</a></p></li>
<li><p><a class="reference internal" href="#buffering-and-streaming" id="id34">Buffering and Streaming</a></p></li>
<li><p><a class="reference internal" href="#unicode-issues" id="id35">Unicode Issues</a></p></li>
<li><p><a class="reference internal" href="#http-1-1-expect-continue" id="id36">HTTP 1.1 Expect/Continue</a></p></li>
<li><p><a class="reference internal" href="#other-http-features" id="id37">Other HTTP Features</a></p></li>
<li><p><a class="reference internal" href="#thread-support" id="id38">Thread Support</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-application-notes" id="id39">Implementation/Application Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#server-extension-apis" id="id40">Server Extension APIs</a></p></li>
<li><p><a class="reference internal" href="#application-configuration" id="id41">Application Configuration</a></p></li>
<li><p><a class="reference internal" href="#url-reconstruction" id="id42">URL Reconstruction</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#open-questions" id="id43">Open Questions</a></p></li>
<li><p><a class="reference internal" href="#points-of-contention" id="id44">Points of Contention</a></p>
<ul>
<li><p><a class="reference internal" href="#wsgi-1-0-compatibility" id="id45">WSGI 1.0 Compatibility</a></p></li>
<li><p><a class="reference internal" href="#environ-and-response-values-as-bytes" id="id46">Environ and Response Values as Bytes</a></p></li>
<li><p><a class="reference internal" href="#applications-should-be-allowed-to-read-web3-input-past-content-length" id="id47">Applications Should be Allowed to Read <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Past <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code></a></p></li>
<li><p><a class="reference internal" href="#web3-input-unknown-length" id="id48"><code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Unknown Length</a></p></li>
<li><p><a class="reference internal" href="#read-of-web3-input-should-support-no-size-calling-convention" id="id49"><code class="docutils literal notranslate"><span class="pre">read()</span></code> of <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Should Support No-Size Calling Convention</a></p>
<ul>
<li><p><a class="reference internal" href="#input-filters-should-set-environ-content-length-to-1" id="id50">Input Filters should set environ <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code> to -1</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#headers-as-literal-list-of-two-tuples" id="id51"><code class="docutils literal notranslate"><span class="pre">headers</span></code> as Literal List of Two-Tuples</a></p></li>
<li><p><a class="reference internal" href="#removed-requirement-that-middleware-not-block" id="id52">Removed Requirement that Middleware Not Block</a></p></li>
<li><p><a class="reference internal" href="#web3-script-name-and-web3-path-info" id="id53"><code class="docutils literal notranslate"><span class="pre">web3.script_name</span></code> and <code class="docutils literal notranslate"><span class="pre">web3.path_info</span></code></a></p></li>
<li><p><a class="reference internal" href="#long-response-headers" id="id54">Long Response Headers</a></p></li>
<li><p><a class="reference internal" href="#request-trailers-and-chunked-transfer-encoding" id="id55">Request Trailers and Chunked Transfer Encoding</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id56">References</a></p></li>
<li><p><a class="reference internal" href="#copyright" id="id57">Copyright</a></p></li>
</ul>
</div>
<section id="abstract">
<h2><a class="toc-backref" href="#id20">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This document specifies a proposed second-generation standard
interface between web servers and Python web applications or
frameworks.</p>
</section>
<section id="pep-deferral">
<h2><a class="toc-backref" href="#id21">PEP Deferral</a><a class="headerlink" href="#pep-deferral" title="Permalink to this headline">¶</a></h2>
<p>Further exploration of the concepts covered in this PEP has been deferred
for lack of a current champion interested in promoting the goals of the PEP
and collecting and incorporating feedback, and with sufficient available
time to do so effectively.</p>
<p>Note that since this PEP was first created, <a class="reference external" href="pep-3333.html">PEP 3333</a> was created as a more
incremental update that permitted use of WSGI on Python 3.2+. However, an
alternative specification that furthers the Python 3 goals of a cleaner
separation of binary and text data may still be valuable.</p>
</section>
<section id="rationale-and-goals">
<h2><a class="toc-backref" href="#id22">Rationale and Goals</a><a class="headerlink" href="#rationale-and-goals" title="Permalink to this headline">¶</a></h2>
<p>This protocol and specification is influenced heavily by the Web
Services Gateway Interface (WSGI) 1.0 standard described in <a class="reference external" href="pep-0333.html">PEP 333</a>
<a class="footnote-reference brackets" href="#id13" id="id1">1</a>.  The high-level rationale for having any standard that allows
Python-based web servers and applications to interoperate is outlined
in <a class="reference external" href="pep-0333.html">PEP 333</a>.  This document essentially uses <a class="reference external" href="pep-0333.html">PEP 333</a> as a template, and
changes its wording in various places for the purpose of forming a
different standard.</p>
<p>Python currently boasts a wide variety of web application frameworks
which use the WSGI 1.0 protocol.  However, due to changes in the
language, the WSGI 1.0 protocol is not compatible with Python 3.  This
specification describes a standardized WSGI-like protocol that lets
Python 2.6, 2.7 and 3.1+ applications communicate with web servers.
Web3 is clearly a WSGI derivative; it only uses a different name than
“WSGI” in order to indicate that it is not in any way backwards
compatible.</p>
<p>Applications and servers which are written to this specification are
meant to work properly under Python 2.6.X, Python 2.7.X and Python
3.1+.  Neither an application nor a server that implements the Web3
specification can be easily written which will work under Python 2
versions earlier than 2.6 nor Python 3 versions earlier than 3.1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Whatever Python 3 version fixed <a class="reference external" href="http://bugs.python.org/issue4006">http://bugs.python.org/issue4006</a> so
<code class="docutils literal notranslate"><span class="pre">os.environ['foo']</span></code> returns surrogates (ala <a class="reference external" href="pep-0383.html">PEP 383</a>) when the
value of ‘foo’ cannot be decoded using the current locale instead
of failing with a KeyError is the <em>true</em> minimum Python 3 version.
In particular, however, Python 3.0 is not supported.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python 2.6 is the first Python version that supported an alias for
<code class="docutils literal notranslate"><span class="pre">bytes</span></code> and the <code class="docutils literal notranslate"><span class="pre">b&quot;foo&quot;</span></code> literal syntax.  This is why it is the
minimum version supported by Web3.</p>
</div>
<p>Explicability and documentability are the main technical drivers for
the decisions made within the standard.</p>
</section>
<section id="differences-from-wsgi">
<h2><a class="toc-backref" href="#id23">Differences from WSGI</a><a class="headerlink" href="#differences-from-wsgi" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>All protocol-specific environment names are prefixed with <code class="docutils literal notranslate"><span class="pre">web3.</span></code>
rather than <code class="docutils literal notranslate"><span class="pre">wsgi.</span></code>, eg. <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code>.</p></li>
<li><p>All values present as environment dictionary <em>values</em> are explicitly
<em>bytes</em> instances instead of native strings.  (Environment <em>keys</em>
however are native strings, always <code class="docutils literal notranslate"><span class="pre">str</span></code> regardless of
platform).</p></li>
<li><p>All values returned by an application must be bytes instances,
including status code, header names and values, and the body.</p></li>
<li><p>Wherever WSGI 1.0 referred to an <code class="docutils literal notranslate"><span class="pre">app_iter</span></code>, this specification
refers to a <code class="docutils literal notranslate"><span class="pre">body</span></code>.</p></li>
<li><p>No <code class="docutils literal notranslate"><span class="pre">start_response()</span></code> callback (and therefore no <code class="docutils literal notranslate"><span class="pre">write()</span></code>
callable nor <code class="docutils literal notranslate"><span class="pre">exc_info</span></code> data).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">readline()</span></code> function of <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> must support a size
hint parameter.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">read()</span></code> function of <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> must be length delimited.
A call without a size argument must not read more than the content
length header specifies.  In case a content length header is absent
the stream must not return anything on read.  It must never request
more data than specified from the client.</p></li>
<li><p>No requirement for middleware to yield an empty string if it needs
more information from an application to produce output (e.g. no
“Middleware Handling of Block Boundaries”).</p></li>
<li><p>Filelike objects passed to a “file_wrapper” must have an
<code class="docutils literal notranslate"><span class="pre">__iter__</span></code> which returns bytes (never text).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wsgi.file_wrapper</span></code> is not supported.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QUERY_STRING</span></code>, <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> values required to
be placed in environ by server (each as the empty bytes instance if
no associated value is received in the HTTP request).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">web3.path_info</span></code> and <code class="docutils literal notranslate"><span class="pre">web3.script_name</span></code> should be put into the
Web3 environment, if possible, by the origin Web3 server.  When
available, each is the original, plain 7-bit ASCII, URL-encoded
variant of its CGI equivalent derived directly from the request URI
(with %2F segment markers and other meta-characters intact).  If the
server cannot provide one (or both) of these values, it must omit
the value(s) it cannot provide from the environment.</p></li>
<li><p>This requirement was removed: “middleware components <strong>must not</strong>
block iteration waiting for multiple values from an application
iterable.  If the middleware needs to accumulate more data from the
application before it can produce any output, it <strong>must</strong> yield an
empty string.”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SERVER_PORT</span></code> must be a bytes instance (not an integer).</p></li>
<li><p>The server must not inject an additional <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header
by guessing the length from the response iterable.  This must be set
by the application itself in all situations.</p></li>
<li><p>If the origin server advertises that it has the <code class="docutils literal notranslate"><span class="pre">web3.async</span></code>
capability, a Web3 application callable used by the server is
permitted to return a callable that accepts no arguments.  When it
does so, this callable is to be called periodically by the origin
server until it returns a non-<code class="docutils literal notranslate"><span class="pre">None</span></code> response, which must be a
normal Web3 response tuple.</p>
</li>
</ul>
</section>
<section id="specification-overview">
<h2><a class="toc-backref" href="#id24">Specification Overview</a><a class="headerlink" href="#specification-overview" title="Permalink to this headline">¶</a></h2>
<p>The Web3 interface has two sides: the “server” or “gateway” side, and
the “application” or “framework” side.  The server side invokes a
callable object that is provided by the application side.  The
specifics of how that object is provided are up to the server or
gateway.  It is assumed that some servers or gateways will require an
application’s deployer to write a short script to create an instance
of the server or gateway, and supply it with the application object.
Other servers and gateways may use configuration files or other
mechanisms to specify where an application object should be imported
from, or otherwise obtained.</p>
<p>In addition to “pure” servers/gateways and applications/frameworks, it
is also possible to create “middleware” components that implement both
sides of this specification.  Such components act as an application to
their containing server, and as a server to a contained application,
and can be used to provide extended APIs, content transformation,
navigation, and other useful functions.</p>
<p>Throughout this specification, we will use the term “application
callable” to mean “a function, a method, or an instance with a
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> method”.  It is up to the server, gateway, or application
implementing the application callable to choose the appropriate
implementation technique for their needs.  Conversely, a server,
gateway, or application that is invoking a callable <strong>must not</strong> have
any dependency on what kind of callable was provided to it.
Application callables are only to be called, not introspected upon.</p>
<section id="the-application-framework-side">
<h3><a class="toc-backref" href="#id25">The Application/Framework Side</a><a class="headerlink" href="#the-application-framework-side" title="Permalink to this headline">¶</a></h3>
<p>The application object is simply a callable object that accepts one
argument.  The term “object” should not be misconstrued as requiring
an actual object instance: a function, method, or instance with a
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> method are all acceptable for use as an application
object.  Application objects must be able to be invoked more than
once, as virtually all servers/gateways (other than CGI) will make
such repeated requests.  If this cannot be guaranteed by the
implementation of the actual application, it has to be wrapped in a
function that creates a new instance on each call.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although we refer to it as an “application” object, this should not
be construed to mean that application developers will use Web3 as a
web programming API.  It is assumed that application developers
will continue to use existing, high-level framework services to
develop their applications.  Web3 is a tool for framework and
server developers, and is not intended to directly support
application developers.)</p>
</div>
<p>An example of an application which is a function (<code class="docutils literal notranslate"><span class="pre">simple_app</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_app</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simplest possible application object&quot;&quot;&quot;</span>
    <span class="n">status</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;200 OK&#39;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)]</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Hello world!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span>
</pre></div>
</div>
<p>An example of an application which is an instance (<code class="docutils literal notranslate"><span class="pre">simple_app</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AppClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Produce the same output, but using an instance.  An</span>
<span class="sd">    instance of this class must be instantiated before it is</span>
<span class="sd">    passed to the server.  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">):</span>
        <span class="n">status</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;200 OK&#39;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;Hello world!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span>

<span class="n">simple_app</span> <span class="o">=</span> <span class="n">AppClass</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternately, an application callable may return a callable instead of
the tuple if the server supports asynchronous execution.  See
information concerning <code class="docutils literal notranslate"><span class="pre">web3.async</span></code> for more information.</p>
</section>
<section id="the-server-gateway-side">
<h3><a class="toc-backref" href="#id26">The Server/Gateway Side</a><a class="headerlink" href="#the-server-gateway-side" title="Permalink to this headline">¶</a></h3>
<p>The server or gateway invokes the application callable once for each
request it receives from an HTTP client, that is directed at the
application.  To illustrate, here is a simple CGI gateway, implemented
as a function taking an application object.  Note that this simple
example has limited error handling, because by default an uncaught
exception will be dumped to <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code> and logged by the web
server.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">encoding</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">getpreferredencoding</span><span class="p">()</span>

<span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="s1">&#39;buffer&#39;</span><span class="p">):</span>
    <span class="c1"># Python 3 compatibility; we need to be able to push bytes out</span>
    <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span>

<span class="k">def</span> <span class="nf">get_environ</span><span class="p">():</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Python 3 compatibility</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="c1"># We must explicitly encode the string to bytes under</span>
            <span class="c1"># Python 3.1+</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s1">&#39;surrogateescape&#39;</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">d</span>

<span class="k">def</span> <span class="nf">run_with_cgi</span><span class="p">(</span><span class="n">application</span><span class="p">):</span>

    <span class="n">environ</span> <span class="o">=</span> <span class="n">get_environ</span><span class="p">()</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.input&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.errors&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.version&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.multithread&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">False</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.multiprocess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.run_once&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="kc">True</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.async&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;HTTPS&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;off&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
        <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.url_scheme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;https&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.url_scheme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;http&#39;</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="n">application</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;This webserver does not support asynchronous &#39;</span>
                        <span class="s1">&#39;responses.&#39;</span><span class="p">)</span>
    <span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">rv</span>

    <span class="n">CLRF</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Status: &#39;</span> <span class="o">+</span> <span class="n">status</span> <span class="o">+</span> <span class="n">CRLF</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">header_name</span><span class="p">,</span> <span class="n">header_val</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header_name</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">header_val</span> <span class="o">+</span> <span class="n">CRLF</span><span class="p">)</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">CRLF</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">body</span><span class="p">:</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">):</span>
            <span class="n">body</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="middleware-components-that-play-both-sides">
<h3><a class="toc-backref" href="#id27">Middleware: Components that Play Both Sides</a><a class="headerlink" href="#middleware-components-that-play-both-sides" title="Permalink to this headline">¶</a></h3>
<p>A single object may play the role of a server with respect to some
application(s), while also acting as an application with respect to
some server(s).  Such “middleware” components can perform such
functions as:</p>
<ul class="simple">
<li><p>Routing a request to different application objects based on the
target URL, after rewriting the <code class="docutils literal notranslate"><span class="pre">environ</span></code> accordingly.</p></li>
<li><p>Allowing multiple applications or frameworks to run side by side in
the same process.</p></li>
<li><p>Load balancing and remote processing, by forwarding requests and
responses over a network.</p></li>
<li><p>Perform content postprocessing, such as applying XSL stylesheets.</p></li>
</ul>
<p>The presence of middleware in general is transparent to both the
“server/gateway” and the “application/framework” sides of the
interface, and should require no special support.  A user who desires
to incorporate middleware into an application simply provides the
middleware component to the server, as if it were an application, and
configures the middleware component to invoke the application, as if
the middleware component were a server.  Of course, the “application”
that the middleware wraps may in fact be another middleware component
wrapping another application, and so on, creating what is referred to
as a “middleware stack”.</p>
<p>A middleware must support asynchronous execution if possible or fall
back to disabling itself.</p>
<p>Here a middleware that changes the <code class="docutils literal notranslate"><span class="pre">HTTP_HOST</span></code> key if an <code class="docutils literal notranslate"><span class="pre">X-Host</span></code>
header exists and adds a comment to all html responses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function that passes the return value from an</span>
<span class="sd">    application to a filter function when the results are</span>
<span class="sd">    ready.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">app_response</span> <span class="o">=</span> <span class="n">app</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>

    <span class="c1"># synchronous response, filter now</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app_response</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">filter_func</span><span class="p">(</span><span class="o">*</span><span class="n">app_response</span><span class="p">)</span>

    <span class="c1"># asynchronous response.  filter when results are ready</span>
    <span class="k">def</span> <span class="nf">polling_function</span><span class="p">():</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">app_response</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filter_func</span><span class="p">(</span><span class="o">*</span><span class="n">rv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">polling_function</span>

<span class="k">def</span> <span class="nf">proxy_and_timing_support</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">new_application</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">filter_func</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
            <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;content-type&#39;</span> <span class="ow">and</span> \
                   <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;text/html&#39;</span><span class="p">:</span>
                    <span class="c1"># assumes ascii compatible encoding in body,</span>
                    <span class="c1"># but the middleware should actually parse the</span>
                    <span class="c1"># content type header and figure out the</span>
                    <span class="c1"># encoding when doing that.</span>
                    <span class="n">body</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;&lt;!-- Execution time: </span><span class="si">%.2f</span><span class="s1">sec --&gt;&#39;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">now</span> <span class="o">-</span> <span class="n">then</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">return</span> <span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">headers</span>
        <span class="n">then</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;HTTP_X_HOST&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">host</span>

        <span class="c1"># use the apply_filter function that applies a given filter</span>
        <span class="c1"># function for both async and sync responses.</span>
        <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_application</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">proxy_and_timing_support</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="specification-details">
<h2><a class="toc-backref" href="#id28">Specification Details</a><a class="headerlink" href="#specification-details" title="Permalink to this headline">¶</a></h2>
<p>The application callable must accept one positional argument.  For the
sake of illustration, we have named it <code class="docutils literal notranslate"><span class="pre">environ</span></code>, but it is not
required to have this name.  A server or gateway <strong>must</strong> invoke the
application object using a positional (not keyword) argument.
(E.g. by calling <code class="docutils literal notranslate"><span class="pre">body,</span> <span class="pre">status,</span> <span class="pre">headers</span> <span class="pre">=</span> <span class="pre">application(environ)</span></code> as
shown above.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">environ</span></code> parameter is a dictionary object, containing CGI-style
environment variables.  This object <strong>must</strong> be a builtin Python
dictionary (<em>not</em> a subclass, <code class="docutils literal notranslate"><span class="pre">UserDict</span></code> or other dictionary
emulation), and the application is allowed to modify the dictionary in
any way it desires.  The dictionary must also include certain
Web3-required variables (described in a later section), and may also
include server-specific extension variables, named according to a
convention that will be described below.</p>
<p>When called by the server, the application object must return a tuple
yielding three elements: <code class="docutils literal notranslate"><span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">headers</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code>, or, if
supported by an async server, an argumentless callable which either
returns <code class="docutils literal notranslate"><span class="pre">None</span></code> or a tuple of those three elements.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">status</span></code> element is a status in bytes of the form <code class="docutils literal notranslate"><span class="pre">b'999</span>
<span class="pre">Message</span> <span class="pre">here'</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">headers</span></code> is a Python list of <code class="docutils literal notranslate"><span class="pre">(header_name,</span> <span class="pre">header_value)</span></code> pairs
describing the HTTP response header.  The <code class="docutils literal notranslate"><span class="pre">headers</span></code> structure must
be a literal Python list; it must yield two-tuples.  Both
<code class="docutils literal notranslate"><span class="pre">header_name</span></code> and <code class="docutils literal notranslate"><span class="pre">header_value</span></code> must be bytes values.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">body</span></code> is an iterable yielding zero or more bytes instances.
This can be accomplished in a variety of ways, such as by returning a
list containing bytes instances as <code class="docutils literal notranslate"><span class="pre">body</span></code>, or by returning a
generator function as <code class="docutils literal notranslate"><span class="pre">body</span></code> that yields bytes instances, or by the
<code class="docutils literal notranslate"><span class="pre">body</span></code> being an instance of a class which is iterable.  Regardless
of how it is accomplished, the application object must always return a
<code class="docutils literal notranslate"><span class="pre">body</span></code> iterable yielding zero or more bytes instances.</p>
<p>The server or gateway must transmit the yielded bytes to the client in
an unbuffered fashion, completing the transmission of each set of
bytes before requesting another one.  (In other words, applications
<strong>should</strong> perform their own buffering.  See the <a class="reference internal" href="#buffering-and-streaming">Buffering and
Streaming</a> section below for more on how application output must be
handled.)</p>
<p>The server or gateway should treat the yielded bytes as binary byte
sequences: in particular, it should ensure that line endings are not
altered.  The application is responsible for ensuring that the
string(s) to be written are in a format suitable for the client.  (The
server or gateway <strong>may</strong> apply HTTP transfer encodings, or perform
other transformations for the purpose of implementing HTTP features
such as byte-range transmission.  See <a class="reference internal" href="#other-http-features">Other HTTP Features</a>, below,
for more details.)</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">body</span></code> iterable returned by the application has a <code class="docutils literal notranslate"><span class="pre">close()</span></code>
method, the server or gateway <strong>must</strong> call that method upon
completion of the current request, whether the request was completed
normally, or terminated early due to an error.  This is to support
resource release by the application amd is intended to complement <a class="reference external" href="pep-0325.html">PEP
325</a>’s generator support, and other common iterables with <code class="docutils literal notranslate"><span class="pre">close()</span></code>
methods.</p>
<p>Finally, servers and gateways <strong>must not</strong> directly use any other
attributes of the <code class="docutils literal notranslate"><span class="pre">body</span></code> iterable returned by the application.</p>
<section id="environ-variables">
<h3><a class="toc-backref" href="#id29"><code class="docutils literal notranslate"><span class="pre">environ</span></code> Variables</a><a class="headerlink" href="#environ-variables" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary is required to contain various CGI
environment variables, as defined by the Common Gateway Interface
specification <a class="footnote-reference brackets" href="#id14" id="id2">2</a>.</p>
<p>The following CGI variables <strong>must</strong> be present.  Each key is a native
string.  Each value is a bytes instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Python 3.1+, a “native string” is a <code class="docutils literal notranslate"><span class="pre">str</span></code> type decoded using
the <code class="docutils literal notranslate"><span class="pre">surrogateescape</span></code> error handler, as done by
<code class="docutils literal notranslate"><span class="pre">os.environ.__getitem__</span></code>.  In Python 2.6 and 2.7, a “native
string” is a <code class="docutils literal notranslate"><span class="pre">str</span></code> types representing a set of bytes.</p>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">REQUEST_METHOD</span></code></dt><dd><p>The HTTP request method, such as <code class="docutils literal notranslate"><span class="pre">&quot;GET&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;POST&quot;</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code></dt><dd><p>The initial portion of the request URL’s “path” that corresponds to
the application object, so that the application knows its virtual
“location”.  This may be the empty bytes instance if the application
corresponds to the “root” of the server.  SCRIPT_NAME will be a
bytes instance representing a sequence of URL-encoded segments
separated by the slash character (<code class="docutils literal notranslate"><span class="pre">/</span></code>).  It is assumed that
<code class="docutils literal notranslate"><span class="pre">%2F</span></code> characters will be decoded into literal slash characters
within <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code>, as per CGI.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code></dt><dd><p>The remainder of the request URL’s “path”, designating the virtual
“location” of the request’s target within the application.  This
<strong>may</strong> be a bytes instance if the request URL targets the
application root and does not have a trailing slash.  PATH_INFO will
be a bytes instance representing a sequence of URL-encoded segments
separated by the slash character (<code class="docutils literal notranslate"><span class="pre">/</span></code>).  It is assumed that
<code class="docutils literal notranslate"><span class="pre">%2F</span></code> characters will be decoded into literal slash characters
within <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code>, as per CGI.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">QUERY_STRING</span></code></dt><dd><p>The portion of the request URL (in bytes) that follows the <code class="docutils literal notranslate"><span class="pre">&quot;?&quot;</span></code>,
if any, or the empty bytes instance.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SERVER_NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">SERVER_PORT</span></code></dt><dd><p>When combined with <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> (or their raw
equivalents)`, these variables can be used to complete the URL.
Note, however, that <code class="docutils literal notranslate"><span class="pre">HTTP_HOST</span></code>, if present, should be used in
preference to <code class="docutils literal notranslate"><span class="pre">SERVER_NAME</span></code> for reconstructing the request URL.
See the <a class="reference internal" href="#url-reconstruction">URL Reconstruction</a> section below for more detail.
<code class="docutils literal notranslate"><span class="pre">SERVER_PORT</span></code> should be a bytes instance, not an integer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SERVER_PROTOCOL</span></code></dt><dd><p>The version of the protocol the client used to send the request.
Typically this will be something like <code class="docutils literal notranslate"><span class="pre">&quot;HTTP/1.0&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;HTTP/1.1&quot;</span></code> and may be used by the application to determine how
to treat any HTTP request headers.  (This variable should probably
be called <code class="docutils literal notranslate"><span class="pre">REQUEST_PROTOCOL</span></code>, since it denotes the protocol used
in the request, and is not necessarily the protocol that will be
used in the server’s response.  However, for compatibility with CGI
we have to keep the existing name.)</p>
</dd>
</dl>
<p>The following CGI values <strong>may</strong> present be in the Web3 environment.
Each key is a native string.  Each value is a bytes instances.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">CONTENT_TYPE</span></code></dt><dd><p>The contents of any <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> fields in the HTTP request.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code></dt><dd><p>The contents of any <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> fields in the HTTP request.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">HTTP_</span></code> Variables</dt><dd><p>Variables corresponding to the client-supplied HTTP request headers
(i.e., variables whose names begin with <code class="docutils literal notranslate"><span class="pre">&quot;HTTP_&quot;</span></code>).  The presence
or absence of these variables should correspond with the presence or
absence of the appropriate HTTP header in the request.</p>
</dd>
</dl>
<p>A server or gateway <strong>should</strong> attempt to provide as many other CGI
variables as are applicable, each with a string for its key and a
bytes instance for its value.  In addition, if SSL is in use, the
server or gateway <strong>should</strong> also provide as many of the Apache SSL
environment variables <a class="footnote-reference brackets" href="#id17" id="id3">5</a> as are applicable, such as <code class="docutils literal notranslate"><span class="pre">HTTPS=on</span></code> and
<code class="docutils literal notranslate"><span class="pre">SSL_PROTOCOL</span></code>.  Note, however, that an application that uses any
CGI variables other than the ones listed above are necessarily
non-portable to web servers that do not support the relevant
extensions.  (For example, web servers that do not publish files will
not be able to provide a meaningful <code class="docutils literal notranslate"><span class="pre">DOCUMENT_ROOT</span></code> or
<code class="docutils literal notranslate"><span class="pre">PATH_TRANSLATED</span></code>.)</p>
<p>A Web3-compliant server or gateway <strong>should</strong> document what variables
it provides, along with their definitions as appropriate.
Applications <strong>should</strong> check for the presence of any variables they
require, and have a fallback plan in the event such a variable is
absent.</p>
<p>Note that CGI variable <em>values</em> must be bytes instances, if they are
present at all.  It is a violation of this specification for a CGI
variable’s value to be of any type other than <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.  On Python 2,
this means they will be of type <code class="docutils literal notranslate"><span class="pre">str</span></code>.  On Python 3, this means they
will be of type <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
<p>They <em>keys</em> of all CGI and non-CGI variables in the environ, however,
must be “native strings” (on both Python 2 and Python 3, they will be
of type <code class="docutils literal notranslate"><span class="pre">str</span></code>).</p>
<p>In addition to the CGI-defined variables, the <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary
<strong>may</strong> also contain arbitrary operating-system “environment
variables”, and <strong>must</strong> contain the following Web3-defined variables.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">web3.version</span></code></p></td>
<td><p>The tuple <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, representing Web3
version 1.0.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">web3.url_scheme</span></code></p></td>
<td><p>A bytes value representing the “scheme” portion of
the URL at which the application is being
invoked.  Normally, this will have the value
<code class="docutils literal notranslate"><span class="pre">b&quot;http&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">b&quot;https&quot;</span></code>, as appropriate.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">web3.input</span></code></p></td>
<td><p>An input stream (file-like object) from which bytes
constituting the HTTP request body can be read.
(The server or gateway may perform reads
on-demand as requested by the application, or
it may pre- read the client’s request body and
buffer it in-memory or on disk, or use any
other technique for providing such an input
stream, according to its preference.)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">web3.errors</span></code></p></td>
<td><p>An output stream (file-like object) to which error
output text can be written, for the purpose of
recording program or other errors in a
standardized and possibly centralized location.
This should be a “text mode” stream; i.e.,
applications should use <code class="docutils literal notranslate"><span class="pre">&quot;\n&quot;</span></code> as a line
ending, and assume that it will be converted to
the correct line ending by the server/gateway.
Applications may <em>not</em> send bytes to the
‘write’ method of this stream; they may only
send text.</p>
<p>For many servers, <code class="docutils literal notranslate"><span class="pre">web3.errors</span></code> will be the
server’s main error log. Alternatively, this
may be <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>, or a log file of some
sort.  The server’s documentation should
include an explanation of how to configure this
or where to find the recorded output.  A server
or gateway may supply different error streams
to different applications, if this is desired.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">web3.multithread</span></code></p></td>
<td><p>This value should evaluate true if the
application object may be simultaneously
invoked by another thread in the same process,
and should evaluate false otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">web3.multiprocess</span></code></p></td>
<td><p>This value should evaluate true if an
equivalent application object may be
simultaneously invoked by another process, and
should evaluate false otherwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">web3.run_once</span></code></p></td>
<td><p>This value should evaluate true if the server
or gateway expects (but does not guarantee!)
that the application will only be invoked this
one time during the life of its containing
process.  Normally, this will only be true for
a gateway based on CGI (or something similar).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">web3.script_name</span></code></p></td>
<td><p>The non-URL-decoded <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> value.
Through a historical inequity, by virtue of the
CGI specification, <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> is present
within the environment as an already
URL-decoded string.  This is the original
URL-encoded value derived from the request URI.
If the server cannot provide this value, it
must omit it from the environ.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">web3.path_info</span></code></p></td>
<td><p>The non-URL-decoded <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> value.
Through a historical inequity, by virtue of the
CGI specification, <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> is present
within the environment as an already
URL-decoded string.  This is the original
URL-encoded value derived from the request URI.
If the server cannot provide this value, it
must omit it from the environ.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">web3.async</span></code></p></td>
<td><p>This is <code class="docutils literal notranslate"><span class="pre">True</span></code> if the webserver supports
async invocation.  In that case an application
is allowed to return a callable instead of a
tuple with the response.  The exact semantics
are not specified by this specification.</p></td>
</tr>
</tbody>
</table>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary may also contain server-defined
variables.  These variables should have names which are native
strings, composed of only lower-case letters, numbers, dots, and
underscores, and should be prefixed with a name that is unique to the
defining server or gateway.  For example, <code class="docutils literal notranslate"><span class="pre">mod_web3</span></code> might define
variables with names like <code class="docutils literal notranslate"><span class="pre">mod_web3.some_variable</span></code>.</p>
<section id="input-stream">
<h4><a class="toc-backref" href="#id30">Input Stream</a><a class="headerlink" href="#input-stream" title="Permalink to this headline">¶</a></h4>
<p>The input stream (<code class="docutils literal notranslate"><span class="pre">web3.input</span></code>) provided by the server must support
the following methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 72%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">read(size)</span></code></p></td>
<td><p>1,4</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">readline([size])</span></code></p></td>
<td><p>1,2,4</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">readlines([size])</span></code></p></td>
<td><p>1,3,4</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__iter__()</span></code></p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
<p>The semantics of each method are as documented in the Python Library
Reference, except for these notes as listed in the table above:</p>
<ol class="arabic simple">
<li><p>The server is not required to read past the client’s specified
<code class="docutils literal notranslate"><span class="pre">Content-Length</span></code>, and is allowed to simulate an end-of-file
condition if the application attempts to read past that point.  The
application <strong>should not</strong> attempt to read more data than is
specified by the <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code> variable.</p></li>
<li><p>The implementation must support the optional <code class="docutils literal notranslate"><span class="pre">size</span></code> argument to
<code class="docutils literal notranslate"><span class="pre">readline()</span></code>.</p></li>
<li><p>The application is free to not supply a <code class="docutils literal notranslate"><span class="pre">size</span></code> argument to
<code class="docutils literal notranslate"><span class="pre">readlines()</span></code>, and the server or gateway is free to ignore the
value of any supplied <code class="docutils literal notranslate"><span class="pre">size</span></code> argument.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">read</span></code>, <code class="docutils literal notranslate"><span class="pre">readline</span></code> and <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> methods must return a
bytes instance.  The <code class="docutils literal notranslate"><span class="pre">readlines</span></code> method must return a sequence
which contains instances of bytes.</p></li>
</ol>
<p>The methods listed in the table above <strong>must</strong> be supported by all
servers conforming to this specification.  Applications conforming to
this specification <strong>must not</strong> use any other methods or attributes of
the <code class="docutils literal notranslate"><span class="pre">input</span></code> object.  In particular, applications <strong>must not</strong>
attempt to close this stream, even if it possesses a <code class="docutils literal notranslate"><span class="pre">close()</span></code>
method.</p>
<p>The input stream should silently ignore attempts to read more than the
content length of the request.  If no content length is specified the
stream must be a dummy stream that does not return anything.</p>
</section>
<section id="error-stream">
<h4><a class="toc-backref" href="#id31">Error Stream</a><a class="headerlink" href="#error-stream" title="Permalink to this headline">¶</a></h4>
<p>The error stream (<code class="docutils literal notranslate"><span class="pre">web3.errors</span></code>) provided by the server must support
the following methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 27%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Stream</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">flush()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">errors</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write(str)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">errors</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">writelines(seq)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">errors</span></code></p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>The semantics of each method are as documented in the Python Library
Reference, except for these notes as listed in the table above:</p>
<ol class="arabic simple">
<li><p>Since the <code class="docutils literal notranslate"><span class="pre">errors</span></code> stream may not be rewound, servers and
gateways are free to forward write operations immediately, without
buffering.  In this case, the <code class="docutils literal notranslate"><span class="pre">flush()</span></code> method may be a no-op.
Portable applications, however, cannot assume that output is
unbuffered or that <code class="docutils literal notranslate"><span class="pre">flush()</span></code> is a no-op.  They must call
<code class="docutils literal notranslate"><span class="pre">flush()</span></code> if they need to ensure that output has in fact been
written.  (For example, to minimize intermingling of data from
multiple processes writing to the same error log.)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">write()</span></code> method must accept a string argument, but needn’t
necessarily accept a bytes argument.  The <code class="docutils literal notranslate"><span class="pre">writelines()</span></code> method
must accept a sequence argument that consists entirely of strings,
but needn’t necessarily accept any bytes instance as a member of
the sequence.</p></li>
</ol>
<p>The methods listed in the table above <strong>must</strong> be supported by all
servers conforming to this specification.  Applications conforming to
this specification <strong>must not</strong> use any other methods or attributes of
the <code class="docutils literal notranslate"><span class="pre">errors</span></code> object.  In particular, applications <strong>must not</strong>
attempt to close this stream, even if it possesses a <code class="docutils literal notranslate"><span class="pre">close()</span></code>
method.</p>
</section>
</section>
<section id="values-returned-by-a-web3-application">
<h3><a class="toc-backref" href="#id32">Values Returned by A Web3 Application</a><a class="headerlink" href="#values-returned-by-a-web3-application" title="Permalink to this headline">¶</a></h3>
<p>Web3 applications return a tuple in the form (<code class="docutils literal notranslate"><span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">headers</span></code>,
<code class="docutils literal notranslate"><span class="pre">body</span></code>).  If the server supports asynchronous applications
(<code class="docutils literal notranslate"><span class="pre">web3.async</span></code>), the response may be a callable object (which accepts no
arguments).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">status</span></code> value is assumed by a gateway or server to be an HTTP
“status” bytes instance like <code class="docutils literal notranslate"><span class="pre">b'200</span> <span class="pre">OK'</span></code> or <code class="docutils literal notranslate"><span class="pre">b'404</span> <span class="pre">Not</span> <span class="pre">Found'</span></code>.
That is, it is a string consisting of a Status-Code and a
Reason-Phrase, in that order and separated by a single space, with no
surrounding whitespace or other characters.  (See <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC 2616</a>, Section
6.1.1 for more information.)  The string <strong>must not</strong> contain control
characters, and must not be terminated with a carriage return,
linefeed, or combination thereof.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">headers</span></code> value is assumed by a gateway or server to be a
literal Python list of <code class="docutils literal notranslate"><span class="pre">(header_name,</span> <span class="pre">header_value)</span></code> tuples.  Each
<code class="docutils literal notranslate"><span class="pre">header_name</span></code> must be a bytes instance representing a valid HTTP
header field-name (as defined by <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC 2616</a>, Section 4.2), without a
trailing colon or other punctuation.  Each <code class="docutils literal notranslate"><span class="pre">header_value</span></code> must be a
bytes instance and <strong>must not</strong> include any control characters,
including carriage returns or linefeeds, either embedded or at the
end.  (These requirements are to minimize the complexity of any
parsing that must be performed by servers, gateways, and intermediate
response processors that need to inspect or modify response headers.)</p>
<p>In general, the server or gateway is responsible for ensuring that
correct headers are sent to the client: if the application omits a
header required by HTTP (or other relevant specifications that are in
effect), the server or gateway <strong>must</strong> add it.  For example, the HTTP
<code class="docutils literal notranslate"><span class="pre">Date:</span></code> and <code class="docutils literal notranslate"><span class="pre">Server:</span></code> headers would normally be supplied by the
server or gateway.  The gateway must however not override values with
the same name if they are emitted by the application.</p>
<p>(A reminder for server/gateway authors: HTTP header names are
case-insensitive, so be sure to take that into consideration when
examining application-supplied headers!)</p>
<p>Applications and middleware are forbidden from using HTTP/1.1
“hop-by-hop” features or headers, any equivalent features in HTTP/1.0,
or any headers that would affect the persistence of the client’s
connection to the web server.  These features are the exclusive
province of the actual web server, and a server or gateway <strong>should</strong>
consider it a fatal error for an application to attempt sending them,
and raise an error if they are supplied as return values from an
application in the <code class="docutils literal notranslate"><span class="pre">headers</span></code> structure.  (For more specifics on
“hop-by-hop” features and headers, please see the <a class="reference internal" href="#other-http-features">Other HTTP
Features</a> section below.)</p>
</section>
<section id="dealing-with-compatibility-across-python-versions">
<h3><a class="toc-backref" href="#id33">Dealing with Compatibility Across Python Versions</a><a class="headerlink" href="#dealing-with-compatibility-across-python-versions" title="Permalink to this headline">¶</a></h3>
<p>Creating Web3 code that runs under both Python 2.6/2.7 and Python 3.1+
requires some care on the part of the developer.  In general, the Web3
specification assumes a certain level of equivalence between the
Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type and the Python 3 <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type.  For example,
under Python 2, the values present in the Web3 <code class="docutils literal notranslate"><span class="pre">environ</span></code> will be
instances of the <code class="docutils literal notranslate"><span class="pre">str</span></code> type; in Python 3, these will be instances of
the <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type.  The Python 3 <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type does not possess all
the methods of the Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type, and some methods which it
does possess behave differently than the Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type.
Effectively, to ensure that Web3 middleware and applications work
across Python versions, developers must do these things:</p>
<ol class="arabic simple">
<li><p>Do not assume comparison equivalence between text values and bytes
values.  If you do so, your code may work under Python 2, but it
will not work properly under Python 3.  For example, don’t write
<code class="docutils literal notranslate"><span class="pre">somebytes</span> <span class="pre">==</span> <span class="pre">'abc'</span></code>.  This will sometimes be true on Python 2
but it will never be true on Python 3, because a sequence of bytes
never compares equal to a string under Python 3.  Instead, always
compare a bytes value with a bytes value, e.g. “somebytes ==
b’abc’”.  Code which does this is compatible with and works the
same in Python 2.6, 2.7, and 3.1.  The <code class="docutils literal notranslate"><span class="pre">b</span></code> in front of <code class="docutils literal notranslate"><span class="pre">'abc'</span></code>
signals to Python 3 that the value is a literal bytes instance;
under Python 2 it’s a forward compatibility placebo.</p></li>
<li><p>Don’t use the <code class="docutils literal notranslate"><span class="pre">__contains__</span></code> method (directly or indirectly) of
items that are meant to be byteslike without ensuring that its
argument is also a bytes instance.  If you do so, your code may
work under Python 2, but it will not work properly under Python 3.
For example, <code class="docutils literal notranslate"><span class="pre">'abc'</span> <span class="pre">in</span> <span class="pre">somebytes'</span></code> will raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>
under Python 3, but it will return <code class="docutils literal notranslate"><span class="pre">True</span></code> under Python 2.6 and
2.7.  However, <code class="docutils literal notranslate"><span class="pre">b'abc'</span> <span class="pre">in</span> <span class="pre">somebytes</span></code> will work the same on both
versions.  In Python 3.2, this restriction may be partially
removed, as it’s rumored that bytes types may obtain a <code class="docutils literal notranslate"><span class="pre">__mod__</span></code>
implementation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> should not be used.</p>
</li>
<li><p>Don’t try to use the <code class="docutils literal notranslate"><span class="pre">format</span></code> method or the <code class="docutils literal notranslate"><span class="pre">__mod__</span></code> method of
instances of bytes (directly or indirectly).  In Python 2, the
<code class="docutils literal notranslate"><span class="pre">str</span></code> type which we treat equivalently to Python 3’s <code class="docutils literal notranslate"><span class="pre">bytes</span></code>
supports these method but actual Python 3’s <code class="docutils literal notranslate"><span class="pre">bytes</span></code> instances
don’t support these methods.  If you use these methods, your code
will work under Python 2, but not under Python 3.</p></li>
<li><p>Do not try to concatenate a bytes value with a string value.  This
may work under Python 2, but it will not work under Python 3.  For
example, doing <code class="docutils literal notranslate"><span class="pre">'abc'</span> <span class="pre">+</span> <span class="pre">somebytes</span></code> will work under Python 2, but
it will result in a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> under Python 3.  Instead, always
make sure you’re concatenating two items of the same type,
e.g. <code class="docutils literal notranslate"><span class="pre">b'abc'</span> <span class="pre">+</span> <span class="pre">somebytes</span></code>.</p></li>
</ol>
<p>Web3 expects byte values in other places, such as in all the values
returned by an application.</p>
<p>In short, to ensure compatibility of Web3 application code between
Python 2 and Python 3, in Python 2, treat CGI and server variable
values in the environment as if they had the Python 3 <code class="docutils literal notranslate"><span class="pre">bytes</span></code> API
even though they actually have a more capable API.  Likewise for all
stringlike values returned by a Web3 application.</p>
</section>
<section id="buffering-and-streaming">
<h3><a class="toc-backref" href="#id34">Buffering and Streaming</a><a class="headerlink" href="#buffering-and-streaming" title="Permalink to this headline">¶</a></h3>
<p>Generally speaking, applications will achieve the best throughput by
buffering their (modestly-sized) output and sending it all at once.
This is a common approach in existing frameworks: the output is
buffered in a StringIO or similar object, then transmitted all at
once, along with the response headers.</p>
<p>The corresponding approach in Web3 is for the application to simply
return a single-element <code class="docutils literal notranslate"><span class="pre">body</span></code> iterable (such as a list) containing
the response body as a single string.  This is the recommended
approach for the vast majority of application functions, that render
HTML pages whose text easily fits in memory.</p>
<p>For large files, however, or for specialized uses of HTTP streaming
(such as multipart “server push”), an application may need to provide
output in smaller blocks (e.g. to avoid loading a large file into
memory).  It’s also sometimes the case that part of a response may be
time-consuming to produce, but it would be useful to send ahead the
portion of the response that precedes it.</p>
<p>In these cases, applications will usually return a <code class="docutils literal notranslate"><span class="pre">body</span></code> iterator
(often a generator-iterator) that produces the output in a
block-by-block fashion.  These blocks may be broken to coincide with
multipart boundaries (for “server push”), or just before
time-consuming tasks (such as reading another block of an on-disk
file).</p>
<p>Web3 servers, gateways, and middleware <strong>must not</strong> delay the
transmission of any block; they <strong>must</strong> either fully transmit the
block to the client, or guarantee that they will continue transmission
even while the application is producing its next block.  A
server/gateway or middleware may provide this guarantee in one of
three ways:</p>
<ol class="arabic simple">
<li><p>Send the entire block to the operating system (and request that any
O/S buffers be flushed) before returning control to the
application, OR</p></li>
<li><p>Use a different thread to ensure that the block continues to be
transmitted while the application produces the next block.</p></li>
<li><p>(Middleware only) send the entire block to its parent
gateway/server.</p></li>
</ol>
<p>By providing this guarantee, Web3 allows applications to ensure that
transmission will not become stalled at an arbitrary point in their
output data.  This is critical for proper functioning of
e.g. multipart “server push” streaming, where data between multipart
boundaries should be transmitted in full to the client.</p>
</section>
<section id="unicode-issues">
<h3><a class="toc-backref" href="#id35">Unicode Issues</a><a class="headerlink" href="#unicode-issues" title="Permalink to this headline">¶</a></h3>
<p>HTTP does not directly support Unicode, and neither does this
interface.  All encoding/decoding must be handled by the
<strong>application</strong>; all values passed to or from the server must be of
the Python 3 type <code class="docutils literal notranslate"><span class="pre">bytes</span></code> or instances of the Python 2 type <code class="docutils literal notranslate"><span class="pre">str</span></code>,
not Python 2 <code class="docutils literal notranslate"><span class="pre">unicode</span></code> or Python 3 <code class="docutils literal notranslate"><span class="pre">str</span></code> objects.</p>
<p>All “bytes instances” referred to in this specification <strong>must</strong>:</p>
<ul class="simple">
<li><p>On Python 2, be of type <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p></li>
<li><p>On Python 3, be of type <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p></li>
</ul>
<p>All “bytes instances” <strong>must not</strong> :</p>
<ul class="simple">
<li><p>On Python 2,  be of type <code class="docutils literal notranslate"><span class="pre">unicode</span></code>.</p></li>
<li><p>On Python 3, be of type <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p></li>
</ul>
<p>The result of using a textlike object where a byteslike object is
required is undefined.</p>
<p>Values returned from a Web3 app as a status or as response headers
<strong>must</strong> follow <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC 2616</a> with respect to encoding.  That is, the bytes
returned must contain a character stream of ISO-8859-1 characters, or
the character stream should use <a class="reference external" href="https://tools.ietf.org/html/rfc2047.html">RFC 2047</a> MIME encoding.</p>
<p>On Python platforms which do not have a native bytes-like type
(e.g. IronPython, etc.), but instead which generally use textlike
strings to represent bytes data, the definition of “bytes instance”
can be changed: their “bytes instances” must be native strings that
contain only code points representable in ISO-8859-1 encoding
(<code class="docutils literal notranslate"><span class="pre">\u0000</span></code> through <code class="docutils literal notranslate"><span class="pre">\u00FF</span></code>, inclusive).  It is a fatal error for
an application on such a platform to supply strings containing any
other Unicode character or code point.  Similarly, servers and
gateways on those platforms <strong>must not</strong> supply strings to an
application containing any other Unicode characters.</p>
</section>
<section id="http-1-1-expect-continue">
<h3><a class="toc-backref" href="#id36">HTTP 1.1 Expect/Continue</a><a class="headerlink" href="#http-1-1-expect-continue" title="Permalink to this headline">¶</a></h3>
<p>Servers and gateways that implement HTTP 1.1 <strong>must</strong> provide
transparent support for HTTP 1.1’s “expect/continue” mechanism.  This
may be done in any of several ways:</p>
<ol class="arabic simple">
<li><p>Respond to requests containing an <code class="docutils literal notranslate"><span class="pre">Expect:</span> <span class="pre">100-continue</span></code> request
with an immediate “100 Continue” response, and proceed normally.</p></li>
<li><p>Proceed with the request normally, but provide the application with
a <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> stream that will send the “100 Continue” response
if/when the application first attempts to read from the input
stream.  The read request must then remain blocked until the client
responds.</p></li>
<li><p>Wait until the client decides that the server does not support
expect/continue, and sends the request body on its own.  (This is
suboptimal, and is not recommended.)</p></li>
</ol>
<p>Note that these behavior restrictions do not apply for HTTP 1.0
requests, or for requests that are not directed to an application
object.  For more information on HTTP 1.1 Expect/Continue, see <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC
2616</a>, sections 8.2.3 and 10.1.1.</p>
</section>
<section id="other-http-features">
<h3><a class="toc-backref" href="#id37">Other HTTP Features</a><a class="headerlink" href="#other-http-features" title="Permalink to this headline">¶</a></h3>
<p>In general, servers and gateways should “play dumb” and allow the
application complete control over its output.  They should only make
changes that do not alter the effective semantics of the application’s
response.  It is always possible for the application developer to add
middleware components to supply additional features, so server/gateway
developers should be conservative in their implementation.  In a
sense, a server should consider itself to be like an HTTP “gateway
server”, with the application being an HTTP “origin server”.  (See <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC
2616</a>, section 1.3, for the definition of these terms.)</p>
<p>However, because Web3 servers and applications do not communicate via
HTTP, what <a class="reference external" href="https://tools.ietf.org/html/rfc2616.html">RFC 2616</a> calls “hop-by-hop” headers do not apply to Web3
internal communications.  Web3 applications <strong>must not</strong> generate any
“hop-by-hop” headers <a class="footnote-reference brackets" href="#id16" id="id4">4</a>, attempt to use HTTP features that would
require them to generate such headers, or rely on the content of any
incoming “hop-by-hop” headers in the <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary.  Web3
servers <strong>must</strong> handle any supported inbound “hop-by-hop” headers on
their own, such as by decoding any inbound <code class="docutils literal notranslate"><span class="pre">Transfer-Encoding</span></code>,
including chunked encoding if applicable.</p>
<p>Applying these principles to a variety of HTTP features, it should be
clear that a server <strong>may</strong> handle cache validation via the
<code class="docutils literal notranslate"><span class="pre">If-None-Match</span></code> and <code class="docutils literal notranslate"><span class="pre">If-Modified-Since</span></code> request headers and the
<code class="docutils literal notranslate"><span class="pre">Last-Modified</span></code> and <code class="docutils literal notranslate"><span class="pre">ETag</span></code> response headers.  However, it is not
required to do this, and the application <strong>should</strong> perform its own
cache validation if it wants to support that feature, since the
server/gateway is not required to do such validation.</p>
<p>Similarly, a server <strong>may</strong> re-encode or transport-encode an
application’s response, but the application <strong>should</strong> use a suitable
content encoding on its own, and <strong>must not</strong> apply a transport
encoding.  A server <strong>may</strong> transmit byte ranges of the application’s
response if requested by the client, and the application doesn’t
natively support byte ranges.  Again, however, the application
<strong>should</strong> perform this function on its own if desired.</p>
<p>Note that these restrictions on applications do not necessarily mean
that every application must reimplement every HTTP feature; many HTTP
features can be partially or fully implemented by middleware
components, thus freeing both server and application authors from
implementing the same features over and over again.</p>
</section>
<section id="thread-support">
<h3><a class="toc-backref" href="#id38">Thread Support</a><a class="headerlink" href="#thread-support" title="Permalink to this headline">¶</a></h3>
<p>Thread support, or lack thereof, is also server-dependent.  Servers
that can run multiple requests in parallel, <strong>should</strong> also provide
the option of running an application in a single-threaded fashion, so
that applications or frameworks that are not thread-safe may still be
used with that server.</p>
</section>
</section>
<section id="implementation-application-notes">
<h2><a class="toc-backref" href="#id39">Implementation/Application Notes</a><a class="headerlink" href="#implementation-application-notes" title="Permalink to this headline">¶</a></h2>
<section id="server-extension-apis">
<h3><a class="toc-backref" href="#id40">Server Extension APIs</a><a class="headerlink" href="#server-extension-apis" title="Permalink to this headline">¶</a></h3>
<p>Some server authors may wish to expose more advanced APIs, that
application or framework authors can use for specialized purposes.
For example, a gateway based on <code class="docutils literal notranslate"><span class="pre">mod_python</span></code> might wish to expose
part of the Apache API as a Web3 extension.</p>
<p>In the simplest case, this requires nothing more than defining an
<code class="docutils literal notranslate"><span class="pre">environ</span></code> variable, such as <code class="docutils literal notranslate"><span class="pre">mod_python.some_api</span></code>.  But, in many
cases, the possible presence of middleware can make this difficult.
For example, an API that offers access to the same HTTP headers that
are found in <code class="docutils literal notranslate"><span class="pre">environ</span></code> variables, might return different data if
<code class="docutils literal notranslate"><span class="pre">environ</span></code> has been modified by middleware.</p>
<p>In general, any extension API that duplicates, supplants, or bypasses
some portion of Web3 functionality runs the risk of being incompatible
with middleware components.  Server/gateway developers should <em>not</em>
assume that nobody will use middleware, because some framework
developers specifically organize their frameworks to function almost
entirely as middleware of various kinds.</p>
<p>So, to provide maximum compatibility, servers and gateways that
provide extension APIs that replace some Web3 functionality, <strong>must</strong>
design those APIs so that they are invoked using the portion of the
API that they replace.  For example, an extension API to access HTTP
request headers must require the application to pass in its current
<code class="docutils literal notranslate"><span class="pre">environ</span></code>, so that the server/gateway may verify that HTTP headers
accessible via the API have not been altered by middleware.  If the
extension API cannot guarantee that it will always agree with
<code class="docutils literal notranslate"><span class="pre">environ</span></code> about the contents of HTTP headers, it must refuse service
to the application, e.g. by raising an error, returning <code class="docutils literal notranslate"><span class="pre">None</span></code>
instead of a header collection, or whatever is appropriate to the API.</p>
<p>These guidelines also apply to middleware that adds information such
as parsed cookies, form variables, sessions, and the like to
<code class="docutils literal notranslate"><span class="pre">environ</span></code>.  Specifically, such middleware should provide these
features as functions which operate on <code class="docutils literal notranslate"><span class="pre">environ</span></code>, rather than simply
stuffing values into <code class="docutils literal notranslate"><span class="pre">environ</span></code>.  This helps ensure that information
is calculated from <code class="docutils literal notranslate"><span class="pre">environ</span></code> <em>after</em> any middleware has done any URL
rewrites or other <code class="docutils literal notranslate"><span class="pre">environ</span></code> modifications.</p>
<p>It is very important that these “safe extension” rules be followed by
both server/gateway and middleware developers, in order to avoid a
future in which middleware developers are forced to delete any and all
extension APIs from <code class="docutils literal notranslate"><span class="pre">environ</span></code> to ensure that their mediation isn’t
being bypassed by applications using those extensions!</p>
</section>
<section id="application-configuration">
<h3><a class="toc-backref" href="#id41">Application Configuration</a><a class="headerlink" href="#application-configuration" title="Permalink to this headline">¶</a></h3>
<p>This specification does not define how a server selects or obtains an
application to invoke.  These and other configuration options are
highly server-specific matters.  It is expected that server/gateway
authors will document how to configure the server to execute a
particular application object, and with what options (such as
threading options).</p>
<p>Framework authors, on the other hand, should document how to create an
application object that wraps their framework’s functionality.  The
user, who has chosen both the server and the application framework,
must connect the two together.  However, since both the framework and
the server have a common interface, this should be merely a mechanical
matter, rather than a significant engineering effort for each new
server/framework pair.</p>
<p>Finally, some applications, frameworks, and middleware may wish to use
the <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary to receive simple string configuration
options.  Servers and gateways <strong>should</strong> support this by allowing an
application’s deployer to specify name-value pairs to be placed in
<code class="docutils literal notranslate"><span class="pre">environ</span></code>.  In the simplest case, this support can consist merely of
copying all operating system-supplied environment variables from
<code class="docutils literal notranslate"><span class="pre">os.environ</span></code> into the <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary, since the deployer in
principle can configure these externally to the server, or in the CGI
case they may be able to be set via the server’s configuration files.</p>
<p>Applications <strong>should</strong> try to keep such required variables to a
minimum, since not all servers will support easy configuration of
them.  Of course, even in the worst case, persons deploying an
application can create a script to supply the necessary configuration
values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">the_app</span> <span class="kn">import</span> <span class="n">application</span>

<span class="k">def</span> <span class="nf">new_app</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
    <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;the_app.configval1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;something&#39;</span>
    <span class="k">return</span> <span class="n">application</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
</pre></div>
</div>
<p>But, most existing applications and frameworks will probably only need
a single configuration value from <code class="docutils literal notranslate"><span class="pre">environ</span></code>, to indicate the
location of their application or framework-specific configuration
file(s).  (Of course, applications should cache such configuration, to
avoid having to re-read it upon each invocation.)</p>
</section>
<section id="url-reconstruction">
<h3><a class="toc-backref" href="#id42">URL Reconstruction</a><a class="headerlink" href="#url-reconstruction" title="Permalink to this headline">¶</a></h3>
<p>If an application wishes to reconstruct a request’s complete URL (as a
bytes object), it may do so using the following algorithm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">host</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">)</span>

<span class="n">scheme</span> <span class="o">=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.url_scheme&#39;</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SERVER_PORT&#39;</span><span class="p">]</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">scheme</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;://&#39;</span>

<span class="k">if</span> <span class="n">host</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">host</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">scheme</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;https&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;443&#39;</span><span class="p">:</span>
           <span class="n">url</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">port</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;80&#39;</span><span class="p">:</span>
           <span class="n">url</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">port</span>

<span class="k">if</span> <span class="s1">&#39;web3.script_name&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">url_quote</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.script_name&#39;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SCRIPT_NAME&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="s1">&#39;web3.path_info&#39;</span> <span class="ow">in</span> <span class="n">environ</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">url_quote</span><span class="p">(</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;web3.path_info&#39;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH_INFO&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">query</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">query</span>
</pre></div>
</div>
<p>Note that such a reconstructed URL may not be precisely the same URI
as requested by the client.  Server rewrite rules, for example, may
have modified the client’s originally requested URL to place it in a
canonical form.</p>
</section>
</section>
<section id="open-questions">
<h2><a class="toc-backref" href="#id43">Open Questions</a><a class="headerlink" href="#open-questions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file_wrapper</span></code> replacement.  Currently nothing is specified here
but it’s clear that the old system of in-band signalling is broken
if it does not provide a way to figure out as a middleware in the
process if the response is a file wrapper.</p></li>
</ul>
</section>
<section id="points-of-contention">
<h2><a class="toc-backref" href="#id44">Points of Contention</a><a class="headerlink" href="#points-of-contention" title="Permalink to this headline">¶</a></h2>
<p>Outlined below are potential points of contention regarding this
specification.</p>
<section id="wsgi-1-0-compatibility">
<h3><a class="toc-backref" href="#id45">WSGI 1.0 Compatibility</a><a class="headerlink" href="#wsgi-1-0-compatibility" title="Permalink to this headline">¶</a></h3>
<p>Components written using the WSGI 1.0 specification will not
transparently interoperate with components written using this
specification.  That’s because the goals of this proposal and the
goals of WSGI 1.0 are not directly aligned.</p>
<p>WSGI 1.0 is obliged to provide specification-level backwards
compatibility with versions of Python between 2.2 and 2.7.  This
specification, however, ditches Python 2.5 and lower compatibility in
order to provide compatibility between relatively recent versions of
Python 2 (2.6 and 2.7) as well as relatively recent versions of Python
3 (3.1).</p>
<p>It is currently impossible to write components which work reliably
under both Python 2 and Python 3 using the WSGI 1.0 specification,
because the specification implicitly posits that CGI and server
variable values in the environ and values returned via
<code class="docutils literal notranslate"><span class="pre">start_response</span></code> represent a sequence of bytes that can be addressed
using the Python 2 string API.  It posits such a thing because that
sort of data type was the sensible way to represent bytes in all
Python 2 versions, and WSGI 1.0 was conceived before Python 3 existed.</p>
<p>Python 3’s <code class="docutils literal notranslate"><span class="pre">str</span></code> type supports the full API provided by the Python 2
<code class="docutils literal notranslate"><span class="pre">str</span></code> type, but Python 3’s <code class="docutils literal notranslate"><span class="pre">str</span></code> type does not represent a
sequence of bytes, it instead represents text.  Therefore, using it to
represent environ values also requires that the environ byte sequence
be decoded to text via some encoding.  We cannot decode these bytes to
text (at least in any way where the decoding has any meaning other
than as a tunnelling mechanism) without widening the scope of WSGI to
include server and gateway knowledge of decoding policies and
mechanics.  WSGI 1.0 never concerned itself with encoding and
decoding.  It made statements about allowable transport values, and
suggested that various values might be best decoded as one encoding or
another, but it never required a server to <em>perform</em> any decoding
before</p>
<p>Python 3 does not have a stringlike type that can be used instead to
represent bytes: it has a <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type.  A bytes type operates quite
a bit like a Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> in Python 3.1+, but it lacks behavior
equivalent to <code class="docutils literal notranslate"><span class="pre">str.__mod__</span></code> and its iteration protocol, and
containment, sequence treatment, and equivalence comparisons are
different.</p>
<p>In either case, there is no type in Python 3 that behaves just like
the Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type, and a way to create such a type doesn’t
exist because there is no such thing as a “String ABC” which would
allow a suitable type to be built.  Due to this design
incompatibility, existing WSGI 1.0 servers, middleware, and
applications will not work under Python 3, even after they are run
through <code class="docutils literal notranslate"><span class="pre">2to3</span></code>.</p>
<p>Existing Web-SIG discussions about updating the WSGI specification so
that it is possible to write a WSGI application that runs in both
Python 2 and Python 3 tend to revolve around creating a
specification-level equivalence between the Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type
(which represents a sequence of bytes) and the Python 3 <code class="docutils literal notranslate"><span class="pre">str</span></code> type
(which represents text).  Such an equivalence becomes strained in
various areas, given the different roles of these types.  An arguably
more straightforward equivalence exists between the Python 3 <code class="docutils literal notranslate"><span class="pre">bytes</span></code>
type API and a subset of the Python 2 <code class="docutils literal notranslate"><span class="pre">str</span></code> type API.  This
specification exploits this subset equivalence.</p>
<p>In the meantime, aside from any Python 2 vs. Python 3 compatibility
issue, as various discussions on Web-SIG have pointed out, the WSGI
1.0 specification is too general, providing support (via <code class="docutils literal notranslate"><span class="pre">.write</span></code>)
for asynchronous applications at the expense of implementation
complexity.  This specification uses the fundamental incompatibility
between WSGI 1.0 and Python 3 as a natural divergence point to create
a specification with reduced complexity by changing specialized
support for asynchronous applications.</p>
<p>To provide backwards compatibility for older WSGI 1.0 applications, so
that they may run on a Web3 stack, it is presumed that Web3 middleware
will be created which can be used “in front” of existing WSGI 1.0
applications, allowing those existing WSGI 1.0 applications to run
under a Web3 stack.  This middleware will require, when under Python
3, an equivalence to be drawn between Python 3 <code class="docutils literal notranslate"><span class="pre">str</span></code> types and the
bytes values represented by the HTTP request and all the attendant
encoding-guessing (or configuration) it implies.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Such middleware <em>might</em> in the future, instead of drawing an
equivalence between Python 3 <code class="docutils literal notranslate"><span class="pre">str</span></code> and HTTP byte values, make use
of a yet-to-be-created “ebytes” type (aka “bytes-with-benefits”),
particularly if a String ABC proposal is accepted into the Python
core and implemented.</p>
</div>
<p>Conversely, it is presumed that WSGI 1.0 middleware will be created
which will allow a Web3 application to run behind a WSGI 1.0 stack on
the Python 2 platform.</p>
</section>
<section id="environ-and-response-values-as-bytes">
<h3><a class="toc-backref" href="#id46">Environ and Response Values as Bytes</a><a class="headerlink" href="#environ-and-response-values-as-bytes" title="Permalink to this headline">¶</a></h3>
<p>Casual middleware and application writers may consider the use of
bytes as environment values and response values inconvenient.  In
particular, they won’t be able to use common string formatting
functions such as <code class="docutils literal notranslate"><span class="pre">('%s'</span> <span class="pre">%</span> <span class="pre">bytes_val)</span></code> or
<code class="docutils literal notranslate"><span class="pre">bytes_val.format('123')</span></code> because bytes don’t have the same API as
strings on platforms such as Python 3 where the two types differ.
Likewise, on such platforms, stdlib HTTP-related API support for using
bytes interchangeably with text can be spotty.  In places where bytes
are inconvenient or incompatible with library APIs, middleware and
application writers will have to decode such bytes to text explicitly.
This is particularly inconvenient for middleware writers: to work with
environment values as strings, they’ll have to decode them from an
implied encoding and if they need to mutate an environ value, they’ll
then need to encode the value into a byte stream before placing it
into the environ.  While the use of bytes by the specification as
environ values might be inconvenient for casual developers, it
provides several benefits.</p>
<p>Using bytes types to represent HTTP and server values to an
application most closely matches reality because HTTP is fundamentally
a bytes-oriented protocol.  If the environ values are mandated to be
strings, each server will need to use heuristics to guess about the
encoding of various values provided by the HTTP environment.  Using
all strings might increase casual middleware writer convenience, but
will also lead to ambiguity and confusion when a value cannot be
decoded to a meaningful non-surrogate string.</p>
<p>Use of bytes as environ values avoids any potential for the need for
the specification to mandate that a participating server be informed
of encoding configuration parameters.  If environ values are treated
as strings, and so must be decoded from bytes, configuration
parameters may eventually become necessary as policy clues from the
application deployer.  Such a policy would be used to guess an
appropriate decoding strategy in various circumstances, effectively
placing the burden for enforcing a particular application encoding
policy upon the server.  If the server must serve more than one
application, such configuration would quickly become complex.  Many
policies would also be impossible to express declaratively.</p>
<p>In reality, HTTP is a complicated and legacy-fraught protocol which
requires a complex set of heuristics to make sense of. It would be
nice if we could allow this protocol to protect us from this
complexity, but we cannot do so reliably while still providing to
application writers a level of control commensurate with reality.
Python applications must often deal with data embedded in the
environment which not only must be parsed by legacy heuristics, but
<em>does not conform even to any existing HTTP specification</em>.  While
these eventualities are unpleasant, they crop up with regularity,
making it impossible and undesirable to hide them from application
developers, as application developers are the only people who are able
to decide upon an appropriate action when an HTTP specification
violation is detected.</p>
<p>Some have argued for mixed use of bytes and string values as environ
<em>values</em>.  This proposal avoids that strategy.  Sole use of bytes as
environ values makes it possible to fit this specification entirely in
one’s head; you won’t need to guess about which values are strings and
which are bytes.</p>
<p>This protocol would also fit in a developer’s head if all environ
values were strings, but this specification doesn’t use that strategy.
This will likely be the point of greatest contention regarding the use
of bytes.  In defense of bytes: developers often prefer protocols with
consistent contracts, even if the contracts themselves are suboptimal.
If we hide encoding issues from a developer until a value that
contains surrogates causes problems after it has already reached
beyond the I/O boundary of their application, they will need to do a
lot more work to fix assumptions made by their application than if we
were to just present the problem much earlier in terms of “here’s some
bytes, you decode them”.  This is also a counter-argument to the
“bytes are inconvenient” assumption: while presenting bytes to an
application developer may be inconvenient for a casual application
developer who doesn’t care about edge cases, they are extremely
convenient for the application developer who needs to deal with
complex, dirty eventualities, because use of bytes allows him the
appropriate level of control with a clear separation of
responsibility.</p>
<p>If the protocol uses bytes, it is presumed that libraries will be
created to make working with bytes-only in the environ and within
return values more pleasant; for example, analogues of the WSGI 1.0
libraries named “WebOb” and “Werkzeug”.  Such libraries will fill the
gap between convenience and control, allowing the spec to remain
simple and regular while still allowing casual authors a convenient
way to create Web3 middleware and application components.  This seems
to be a reasonable alternative to baking encoding policy into the
protocol, because many such libraries can be created independently
from the protocol, and application developers can choose the one that
provides them the appropriate levels of control and convenience for a
particular job.</p>
<p>Here are some alternatives to using all bytes:</p>
<ul class="simple">
<li><p>Have the server decode all values representing CGI and server
environ values into strings using the <code class="docutils literal notranslate"><span class="pre">latin-1</span></code> encoding, which is
lossless.  Smuggle any undecodable bytes within the resulting
string.</p></li>
<li><p>Encode all CGI and server environ values to strings using the
<code class="docutils literal notranslate"><span class="pre">utf-8</span></code> encoding with the <code class="docutils literal notranslate"><span class="pre">surrogateescape</span></code> error handler.  This
does not work under any existing Python 2.</p></li>
<li><p>Encode some values into bytes and other values into strings, as
decided by their typical usages.</p></li>
</ul>
</section>
<section id="applications-should-be-allowed-to-read-web3-input-past-content-length">
<h3><a class="toc-backref" href="#id47">Applications Should be Allowed to Read <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Past <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code></a><a class="headerlink" href="#applications-should-be-allowed-to-read-web3-input-past-content-length" title="Permalink to this headline">¶</a></h3>
<p>At <a class="footnote-reference brackets" href="#id18" id="id5">6</a>, Graham Dumpleton makes the assertion that <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code>
should be required to return the empty string as a signifier of
out-of-data, and that applications should be allowed to read past the
number of bytes specified in <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code>, depending only upon
the empty string as an EOF marker.  WSGI relies on an application
“being well behaved and once all data specified by <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code>
is read, that it processes the data and returns any response. That
same socket connection could then be used for a subsequent request.”
Graham would like WSGI adapters to be required to wrap raw socket
connections: “this wrapper object will need to count how much data has
been read, and when the amount of data reaches that as defined by
<code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code>, any subsequent reads should return an empty string
instead.”  This may be useful to support chunked encoding and input
filters.</p>
</section>
<section id="web3-input-unknown-length">
<h3><a class="toc-backref" href="#id48"><code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Unknown Length</a><a class="headerlink" href="#web3-input-unknown-length" title="Permalink to this headline">¶</a></h3>
<p>There’s no documented way to indicate that there is content in
<code class="docutils literal notranslate"><span class="pre">environ['web3.input']</span></code>, but the content length is unknown.</p>
</section>
<section id="read-of-web3-input-should-support-no-size-calling-convention">
<h3><a class="toc-backref" href="#id49"><code class="docutils literal notranslate"><span class="pre">read()</span></code> of <code class="docutils literal notranslate"><span class="pre">web3.input</span></code> Should Support No-Size Calling Convention</a><a class="headerlink" href="#read-of-web3-input-should-support-no-size-calling-convention" title="Permalink to this headline">¶</a></h3>
<p>At <a class="footnote-reference brackets" href="#id18" id="id6">6</a>, Graham Dumpleton makes the assertion that the <code class="docutils literal notranslate"><span class="pre">read()</span></code>
method of <code class="docutils literal notranslate"><span class="pre">wsgi.input</span></code> should be callable without arguments, and
that the result should be “all available request content”.  Needs
discussion.</p>
<p>Comment Armin: I changed the spec to require that from an
implementation.  I had too much pain with that in the past already.
Open for discussions though.</p>
<section id="input-filters-should-set-environ-content-length-to-1">
<h4><a class="toc-backref" href="#id50">Input Filters should set environ <code class="docutils literal notranslate"><span class="pre">CONTENT_LENGTH</span></code> to -1</a><a class="headerlink" href="#input-filters-should-set-environ-content-length-to-1" title="Permalink to this headline">¶</a></h4>
<p>At <a class="footnote-reference brackets" href="#id18" id="id7">6</a>, Graham Dumpleton suggests that an input filter might set
<code class="docutils literal notranslate"><span class="pre">environ['CONTENT_LENGTH']</span></code> to -1 to indicate that it mutated the
input.</p>
</section>
</section>
<section id="headers-as-literal-list-of-two-tuples">
<h3><a class="toc-backref" href="#id51"><code class="docutils literal notranslate"><span class="pre">headers</span></code> as Literal List of Two-Tuples</a><a class="headerlink" href="#headers-as-literal-list-of-two-tuples" title="Permalink to this headline">¶</a></h3>
<p>Why do we make applications return a <code class="docutils literal notranslate"><span class="pre">headers</span></code> structure that is a
literal list of two-tuples?  I think the iterability of <code class="docutils literal notranslate"><span class="pre">headers</span></code>
needs to be maintained while it moves up the stack, but I don’t think
we need to be able to mutate it in place at all times.  Could we
loosen that requirement?</p>
<p>Comment Armin: Strong yes</p>
</section>
<section id="removed-requirement-that-middleware-not-block">
<h3><a class="toc-backref" href="#id52">Removed Requirement that Middleware Not Block</a><a class="headerlink" href="#removed-requirement-that-middleware-not-block" title="Permalink to this headline">¶</a></h3>
<p>This requirement was removed: “middleware components <strong>must not</strong>
block iteration waiting for multiple values from an application
iterable.  If the middleware needs to accumulate more data from the
application before it can produce any output, it <strong>must</strong> yield an
empty string.”  This requirement existed to support asynchronous
applications and servers (see <a class="reference external" href="pep-0333.html">PEP 333</a>’s “Middleware Handling of Block
Boundaries”).  Asynchronous applications are now serviced explicitly
by <code class="docutils literal notranslate"><span class="pre">web3.async</span></code> capable protocol (a Web3 application callable may
itself return a callable).</p>
</section>
<section id="web3-script-name-and-web3-path-info">
<h3><a class="toc-backref" href="#id53"><code class="docutils literal notranslate"><span class="pre">web3.script_name</span></code> and <code class="docutils literal notranslate"><span class="pre">web3.path_info</span></code></a><a class="headerlink" href="#web3-script-name-and-web3-path-info" title="Permalink to this headline">¶</a></h3>
<p>These values are required to be placed into the environment by an
origin server under this specification.  Unlike <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> and
<code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code>, these must be the original <em>URL-encoded</em> variants
derived from the request URI.  We probably need to figure out how
these should be computed originally, and what their values should be
if the server performs URL rewriting.</p>
</section>
<section id="long-response-headers">
<h3><a class="toc-backref" href="#id54">Long Response Headers</a><a class="headerlink" href="#long-response-headers" title="Permalink to this headline">¶</a></h3>
<p>Bob Brewer notes on Web-SIG <a class="footnote-reference brackets" href="#id19" id="id8">7</a>:</p>
<blockquote>
<div><p>Each header_value must not include any control characters,
including carriage returns or linefeeds, either embedded or at the
end.  (These requirements are to minimize the complexity of any
parsing that must be performed by servers, gateways, and
intermediate response processors that need to inspect or modify
response headers.) <a class="footnote-reference brackets" href="#id13" id="id9">1</a></p>
</div></blockquote>
<p>That’s understandable, but HTTP headers are defined as (mostly)
*TEXT, and “words of *TEXT MAY contain characters from character
sets other than ISO-8859-1 only when encoded according to the rules of
<a class="reference external" href="https://tools.ietf.org/html/rfc2047.html">RFC 2047</a>.”  <a class="footnote-reference brackets" href="#id14" id="id10">2</a> And <a class="reference external" href="https://tools.ietf.org/html/rfc2047.html">RFC 2047</a> specifies that “an ‘encoded-word’ may
not be more than 75 characters long…  If it is desirable to encode
more text than will fit in an ‘encoded-word’ of 75 characters,
multiple ‘encoded-word’s (separated by CRLF SPACE) may be used.” <a class="footnote-reference brackets" href="#id15" id="id11">3</a>
This satisfies HTTP header folding rules, as well: “Header fields can
be extended over multiple lines by preceding each extra line with at
least one SP or HT.” <a class="footnote-reference brackets" href="#id13" id="id12">1</a></p>
<p>So in my reading of HTTP, some code somewhere should introduce
newlines in longish, encoded response header values.  I see three
options:</p>
<ol class="arabic simple">
<li><p>Keep things as they are and disallow response header values if they
contain words over 75 chars that are outside the ISO-8859-1
character set.</p></li>
<li><p>Allow newline characters in WSGI response headers.</p></li>
<li><p>Require/strongly suggest WSGI servers to do the encoding and
folding before sending the value over HTTP.</p></li>
</ol>
</section>
<section id="request-trailers-and-chunked-transfer-encoding">
<h3><a class="toc-backref" href="#id55">Request Trailers and Chunked Transfer Encoding</a><a class="headerlink" href="#request-trailers-and-chunked-transfer-encoding" title="Permalink to this headline">¶</a></h3>
<p>When using chunked transfer encoding on request content, the RFCs
allow there to be request trailers.  These are like request headers
but come after the final null data chunk.  These trailers are only
available when the chunked data stream is finite length and when it
has all been read in.  Neither WSGI nor Web3 currently supports them.</p>
</section>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id56">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id9">2</a>,<a href="#id12">3</a>)</span></dt>
<dd><p><a class="reference external" href="pep-0333.html">PEP 333</a>: Python Web Services Gateway Interface
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0333/">http://www.python.org/dev/peps/pep-0333/</a>)</p>
</dd>
<dt class="label" id="id14"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id10">2</a>)</span></dt>
<dd><p>The Common Gateway Interface Specification, v 1.1, 3rd Draft
(<a class="reference external" href="http://cgi-spec.golux.com/draft-coar-cgi-v11-03.txt">http://cgi-spec.golux.com/draft-coar-cgi-v11-03.txt</a>)</p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id11">3</a></span></dt>
<dd><p>“Chunked Transfer Coding” – HTTP/1.1, section 3.6.1
(<a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1</a>)</p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>“End-to-end and Hop-by-hop Headers” – HTTP/1.1, Section 13.5.1
(<a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1</a>)</p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id3">5</a></span></dt>
<dd><p>mod_ssl Reference, “Environment Variables”
(<a class="reference external" href="http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25">http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25</a>)</p>
</dd>
<dt class="label" id="id18"><span class="brackets">6</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>,<a href="#id7">3</a>)</span></dt>
<dd><p>Details on WSGI 1.0 amendments/clarifications.
(<a class="reference external" href="http://blog.dscpl.com.au/2009/10/details-on-wsgi-10-amendmentsclarificat.html">http://blog.dscpl.com.au/2009/10/details-on-wsgi-10-amendmentsclarificat.html</a>)</p>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id8">7</a></span></dt>
<dd><p>[Web-SIG] WSGI and long response header values
<a class="reference external" href="https://mail.python.org/pipermail/web-sig/2006-September/002244.html">https://mail.python.org/pipermail/web-sig/2006-September/002244.html</a></p>
</dd>
</dl>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#id57">Copyright</a><a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<span>Source: <a class="reference external" href="https://github.com/python/peps/blob/master/pep-0444.txt">https://github.com/python/peps/blob/master/pep-0444.txt</a></span><div class="zero-height line"><br /></div>
<span>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/master/pep-0444.txt">2021-06-28T11:16:08Z</a></span>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../contents/">PEPs</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">PEP Table of Contents (needed for Sphinx):</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pep-0000/">PEP 0 – Index of Python Enhancement Proposals (PEPs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0001/">PEP 1 – PEP Purpose and Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0002/">PEP 2 – Procedure for Adding New Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0003/">PEP 3 – Guidelines for Handling Bug Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0004/">PEP 4 – Deprecation of Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0005/">PEP 5 – Guidelines for Language Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0006/">PEP 6 – Bug Fix Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0007/">PEP 7 – Style Guide for C Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0008/">PEP 8 – Style Guide for Python Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0009/">PEP 9 – Sample Plaintext PEP Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0010/">PEP 10 – Voting Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0011/">PEP 11 – Removing support for little used platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0012/">PEP 12 – Sample reStructuredText PEP Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0013/">PEP 13 – Python Language Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0020/">PEP 20 – The Zen of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0042/">PEP 42 – Feature Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0100/">PEP 100 – Python Unicode Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0101/">PEP 101 – Doing Python Releases 101</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0102/">PEP 102 – Doing Python Micro Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0103/">PEP 103 – Collecting information about git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0160/">PEP 160 – Python 1.6 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0200/">PEP 200 – Python 2.0 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0201/">PEP 201 – Lockstep Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0202/">PEP 202 – List Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0203/">PEP 203 – Augmented Assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0204/">PEP 204 – Range Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0205/">PEP 205 – Weak References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0206/">PEP 206 – Python Advanced Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0207/">PEP 207 – Rich Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0208/">PEP 208 – Reworking the Coercion Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0209/">PEP 209 – Multi-dimensional Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0210/">PEP 210 – Decoupling the Interpreter Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0211/">PEP 211 – Adding A New Outer Product Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0212/">PEP 212 – Loop Counter Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0213/">PEP 213 – Attribute Access Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0214/">PEP 214 – Extended Print Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0215/">PEP 215 – String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0216/">PEP 216 – Docstring Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0217/">PEP 217 – Display Hook for Interactive Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0218/">PEP 218 – Adding a Built-In Set Object Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0219/">PEP 219 – Stackless Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0220/">PEP 220 – Coroutines, Generators, Continuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0221/">PEP 221 – Import As</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0222/">PEP 222 – Web Library Enhancements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0223/">PEP 223 – Change the Meaning of ``\x`` Escapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0224/">PEP 224 – Attribute Docstrings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0225/">PEP 225 – Elementwise/Objectwise Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0226/">PEP 226 – Python 2.1 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0227/">PEP 227 – Statically Nested Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0228/">PEP 228 – Reworking Python’s Numeric Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0229/">PEP 229 – Using Distutils to Build Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0230/">PEP 230 – Warning Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0231/">PEP 231 – __findattr__()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0232/">PEP 232 – Function Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0233/">PEP 233 – Python Online Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0234/">PEP 234 – Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0235/">PEP 235 – Import on Case-Insensitive Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0236/">PEP 236 – Back to the __future__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0237/">PEP 237 – Unifying Long Integers and Integers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0238/">PEP 238 – Changing the Division Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0239/">PEP 239 – Adding a Rational Type to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0240/">PEP 240 – Adding a Rational Literal to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0241/">PEP 241 – Metadata for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0242/">PEP 242 – Numeric Kinds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0243/">PEP 243 – Module Repository Upload Mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0244/">PEP 244 – The ``directive`` statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0245/">PEP 245 – Python Interface Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0246/">PEP 246 – Object Adaptation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0247/">PEP 247 – API for Cryptographic Hash Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0248/">PEP 248 – Python Database API Specification v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0249/">PEP 249 – Python Database API Specification v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0250/">PEP 250 – Using site-packages on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0251/">PEP 251 – Python 2.2 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0252/">PEP 252 – Making Types Look More Like Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0253/">PEP 253 – Subtyping Built-in Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0254/">PEP 254 – Making Classes Look More Like Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0255/">PEP 255 – Simple Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0256/">PEP 256 – Docstring Processing System Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0257/">PEP 257 – Docstring Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0258/">PEP 258 – Docutils Design Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0259/">PEP 259 – Omit printing newline after newline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0260/">PEP 260 – Simplify xrange()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0261/">PEP 261 – Support for “wide” Unicode characters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0262/">PEP 262 – A Database of Installed Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0263/">PEP 263 – Defining Python Source Code Encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0264/">PEP 264 – Future statements in simulated shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0265/">PEP 265 – Sorting Dictionaries by Value</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0266/">PEP 266 – Optimizing Global Variable/Attribute Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0267/">PEP 267 – Optimized Access to Module Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0268/">PEP 268 – Extended HTTP functionality and WebDAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0269/">PEP 269 – Pgen Module for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0270/">PEP 270 – uniq method for list objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0271/">PEP 271 – Prefixing sys.path by command line option</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0272/">PEP 272 – API for Block Encryption Algorithms v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0273/">PEP 273 – Import Modules from Zip Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0274/">PEP 274 – Dict Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0275/">PEP 275 – Switching on Multiple Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0276/">PEP 276 – Simple Iterator for ints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0277/">PEP 277 – Unicode file name support for Windows NT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0278/">PEP 278 – Universal Newline Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0279/">PEP 279 – The enumerate() built-in function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0280/">PEP 280 – Optimizing access to globals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0281/">PEP 281 – Loop Counter Iteration with range and xrange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0282/">PEP 282 – A Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0283/">PEP 283 – Python 2.3 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0284/">PEP 284 – Integer for-loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0285/">PEP 285 – Adding a bool type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0286/">PEP 286 – Enhanced Argument Tuples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0287/">PEP 287 – reStructuredText Docstring Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0288/">PEP 288 – Generators Attributes and Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0289/">PEP 289 – Generator Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0290/">PEP 290 – Code Migration and Modernization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0291/">PEP 291 – Backward Compatibility for the Python 2 Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0292/">PEP 292 – Simpler String Substitutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0293/">PEP 293 – Codec Error Handling Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0294/">PEP 294 – Type Names in the types Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0295/">PEP 295 – Interpretation of multiline string constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0296/">PEP 296 – Adding a bytes Object Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0297/">PEP 297 – Support for System Upgrades</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0298/">PEP 298 – The Locked Buffer Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0299/">PEP 299 – Special __main__() function in modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0301/">PEP 301 – Package Index and Metadata for Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0302/">PEP 302 – New Import Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0303/">PEP 303 – Extend divmod() for Multiple Divisors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0304/">PEP 304 – Controlling Generation of Bytecode Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0305/">PEP 305 – CSV File API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0306/">PEP 306 – How to Change Python’s Grammar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0307/">PEP 307 – Extensions to the pickle protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0308/">PEP 308 – Conditional Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0309/">PEP 309 – Partial Function Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0310/">PEP 310 – Reliable Acquisition/Release Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0311/">PEP 311 – Simplified Global Interpreter Lock Acquisition for Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0312/">PEP 312 – Simple Implicit Lambda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0313/">PEP 313 – Adding Roman Numeral Literals to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0314/">PEP 314 – Metadata for Python Software Packages v1.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0315/">PEP 315 – Enhanced While Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0316/">PEP 316 – Programming by Contract for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0317/">PEP 317 – Eliminate Implicit Exception Instantiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0318/">PEP 318 – Decorators for Functions and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0319/">PEP 319 – Python Synchronize/Asynchronize Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0320/">PEP 320 – Python 2.4 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0321/">PEP 321 – Date/Time Parsing and Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0322/">PEP 322 – Reverse Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0323/">PEP 323 – Copyable Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0324/">PEP 324 – subprocess - New process module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0325/">PEP 325 – Resource-Release Support for Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0326/">PEP 326 – A Case for Top and Bottom Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0327/">PEP 327 – Decimal Data Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0328/">PEP 328 – Imports: Multi-Line and Absolute/Relative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0329/">PEP 329 – Treating Builtins as Constants in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0330/">PEP 330 – Python Bytecode Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0331/">PEP 331 – Locale-Independent Float/String Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0332/">PEP 332 – Byte vectors and String/Unicode Unification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0333/">PEP 333 – Python Web Server Gateway Interface v1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0334/">PEP 334 – Simple Coroutines via SuspendIteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0335/">PEP 335 – Overloadable Boolean Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0336/">PEP 336 – Make None Callable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0337/">PEP 337 – Logging Usage in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0338/">PEP 338 – Executing modules as scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0339/">PEP 339 – Design of the CPython Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0340/">PEP 340 – Anonymous Block Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0341/">PEP 341 – Unifying try-except and try-finally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0342/">PEP 342 – Coroutines via Enhanced Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0343/">PEP 343 – The “with” Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0344/">PEP 344 – Exception Chaining and Embedded Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0345/">PEP 345 – Metadata for Python Software Packages 1.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0346/">PEP 346 – User Defined (“``with``”) Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0347/">PEP 347 – Migrating the Python CVS to Subversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0348/">PEP 348 – Exception Reorganization for Python 3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0349/">PEP 349 – Allow str() to return unicode strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0350/">PEP 350 – Codetags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0351/">PEP 351 – The freeze protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0352/">PEP 352 – Required Superclass for Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0353/">PEP 353 – Using ssize_t as the index type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0354/">PEP 354 – Enumerations in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0355/">PEP 355 – Path - Object oriented filesystem paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0356/">PEP 356 – Python 2.5 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0357/">PEP 357 – Allowing Any Object to be Used for Slicing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0358/">PEP 358 – The “bytes” Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0359/">PEP 359 – The “make” Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0360/">PEP 360 – Externally Maintained Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0361/">PEP 361 – Python 2.6 and 3.0 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0362/">PEP 362 – Function Signature Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0363/">PEP 363 – Syntax For Dynamic Attribute Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0364/">PEP 364 – Transitioning to the Py3K Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0365/">PEP 365 – Adding the pkg_resources module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0366/">PEP 366 – Main module explicit relative imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0367/">PEP 367 – New Super</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0368/">PEP 368 – Standard image protocol and class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0369/">PEP 369 – Post import hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0370/">PEP 370 – Per user site-packages directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0371/">PEP 371 – Addition of the multiprocessing package to the standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0372/">PEP 372 – Adding an ordered dictionary to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0373/">PEP 373 – Python 2.7 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0374/">PEP 374 – Choosing a distributed VCS for the Python project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0375/">PEP 375 – Python 3.1 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0376/">PEP 376 – Database of Installed Python Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0377/">PEP 377 – Allow __enter__() methods to skip the statement body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0378/">PEP 378 – Format Specifier for Thousands Separator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0379/">PEP 379 – Adding an Assignment Expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0380/">PEP 380 – Syntax for Delegating to a Subgenerator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0381/">PEP 381 – Mirroring infrastructure for PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0382/">PEP 382 – Namespace Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0383/">PEP 383 – Non-decodable Bytes in System Character Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0384/">PEP 384 – Defining a Stable ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0385/">PEP 385 – Migrating from Subversion to Mercurial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0386/">PEP 386 – Changing the version comparison module in Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0387/">PEP 387 – Backwards Compatibility Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0389/">PEP 389 – argparse - New Command Line Parsing Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0390/">PEP 390 – Static metadata for Distutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0391/">PEP 391 – Dictionary-Based Configuration For Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0392/">PEP 392 – Python 3.2 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0393/">PEP 393 – Flexible String Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0394/">PEP 394 – The “python” Command on Unix-Like Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0395/">PEP 395 – Qualified Names for Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0396/">PEP 396 – Module Version Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0397/">PEP 397 – Python launcher for Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0398/">PEP 398 – Python 3.3 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0399/">PEP 399 – Pure Python/C Accelerator Module Compatibility Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0400/">PEP 400 – Deprecate codecs.StreamReader and codecs.StreamWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0401/">PEP 401 – BDFL Retirement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0402/">PEP 402 – Simplified Package Layout and Partitioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0403/">PEP 403 – General purpose decorator clause (aka “&#64;in” clause)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0404/">PEP 404 – Python 2.8 Un-release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0405/">PEP 405 – Python Virtual Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0406/">PEP 406 – Improved Encapsulation of Import State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0407/">PEP 407 – New release cycle and introducing long-term support versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0408/">PEP 408 – Standard library __preview__ package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0409/">PEP 409 – Suppressing exception context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0410/">PEP 410 – Use decimal.Decimal type for timestamps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0411/">PEP 411 – Provisional packages in the Python standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0412/">PEP 412 – Key-Sharing Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0413/">PEP 413 – Faster evolution of the Python Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0414/">PEP 414 – Explicit Unicode Literal for Python 3.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0415/">PEP 415 – Implement context suppression with exception attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0416/">PEP 416 – Add a frozendict builtin type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0417/">PEP 417 – Including mock in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0418/">PEP 418 – Add monotonic time, performance counter, and process time functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0419/">PEP 419 – Protecting cleanup statements from interruptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0420/">PEP 420 – Implicit Namespace Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0421/">PEP 421 – Adding sys.implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0422/">PEP 422 – Simpler customisation of class creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0423/">PEP 423 – Naming conventions and recipes related to packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0424/">PEP 424 – A method for exposing a length hint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0425/">PEP 425 – Compatibility Tags for Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0426/">PEP 426 – Metadata for Python Software Packages 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0427/">PEP 427 – The Wheel Binary Package Format 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0428/">PEP 428 – The pathlib module – object-oriented filesystem paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0429/">PEP 429 – Python 3.4 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0430/">PEP 430 – Migrating to Python 3 as the default online documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0431/">PEP 431 – Time zone support improvements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0432/">PEP 432 – Restructuring the CPython startup sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0433/">PEP 433 – Easier suppression of file descriptor inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0434/">PEP 434 – IDLE Enhancement Exception for All Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0435/">PEP 435 – Adding an Enum type to the Python standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0436/">PEP 436 – The Argument Clinic DSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0437/">PEP 437 – A DSL for specifying signatures, annotations and argument converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0438/">PEP 438 – Transitioning to release-file hosting on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0439/">PEP 439 – Inclusion of implicit pip bootstrap in Python installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0440/">PEP 440 – Version Identification and Dependency Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0441/">PEP 441 – Improving Python ZIP Application Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0442/">PEP 442 – Safe object finalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0443/">PEP 443 – Single-dispatch generic functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PEP 444 – Python Web3 Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0445/">PEP 445 – Add new APIs to customize Python memory allocators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0446/">PEP 446 – Make newly created file descriptors non-inheritable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0447/">PEP 447 – Add __getdescriptor__ method to metaclass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0448/">PEP 448 – Additional Unpacking Generalizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0449/">PEP 449 – Removal of the PyPI Mirror Auto Discovery and Naming Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0450/">PEP 450 – Adding A Statistics Module To The Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0451/">PEP 451 – A ModuleSpec Type for the Import System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0452/">PEP 452 – API for Cryptographic Hash Functions v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0453/">PEP 453 – Explicit bootstrapping of pip in Python installations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0454/">PEP 454 – Add a new tracemalloc module to trace Python memory allocations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0455/">PEP 455 – Adding a key-transforming dictionary to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0456/">PEP 456 – Secure and interchangeable hash algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0457/">PEP 457 – Notation For Positional-Only Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0458/">PEP 458 – Secure PyPI downloads with signed repository metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0459/">PEP 459 – Standard Metadata Extensions for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0460/">PEP 460 – Add binary interpolation and formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0461/">PEP 461 – Adding % formatting to bytes and bytearray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0462/">PEP 462 – Core development workflow automation for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0463/">PEP 463 – Exception-catching expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0464/">PEP 464 – Removal of the PyPI Mirror Authenticity API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0465/">PEP 465 – A dedicated infix operator for matrix multiplication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0466/">PEP 466 – Network Security Enhancements for Python 2.7.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0467/">PEP 467 – Minor API improvements for binary sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0468/">PEP 468 – Preserving the order of \*\*kwargs in a function.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0469/">PEP 469 – Migration of dict iteration code to Python 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0470/">PEP 470 – Removing External Hosting Support on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0471/">PEP 471 – os.scandir() function – a better and faster directory iterator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0472/">PEP 472 – Support for indexing with keyword arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0473/">PEP 473 – Adding structured data to built-in exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0474/">PEP 474 – Creating forge.python.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0475/">PEP 475 – Retry system calls failing with EINTR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0476/">PEP 476 – Enabling certificate verification by default for stdlib http clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0477/">PEP 477 – Backport ensurepip (PEP 453) to Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0478/">PEP 478 – Python 3.5 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0479/">PEP 479 – Change StopIteration handling inside generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0480/">PEP 480 – Surviving a Compromise of PyPI: End-to-end signing of packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0481/">PEP 481 – Migrate CPython to Git, Github, and Phabricator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0482/">PEP 482 – Literature Overview for Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0483/">PEP 483 – The Theory of Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0484/">PEP 484 – Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0485/">PEP 485 – A Function for testing approximate equality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0486/">PEP 486 – Make the Python Launcher aware of virtual environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0487/">PEP 487 – Simpler customisation of class creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0488/">PEP 488 – Elimination of PYO files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0489/">PEP 489 – Multi-phase extension module initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0490/">PEP 490 – Chain exceptions at C level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0491/">PEP 491 – The Wheel Binary Package Format 1.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0492/">PEP 492 – Coroutines with async and await syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0493/">PEP 493 – HTTPS verification migration tools for Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0494/">PEP 494 – Python 3.6 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0495/">PEP 495 – Local Time Disambiguation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0496/">PEP 496 – Environment Markers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0497/">PEP 497 – A standard mechanism for backward compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0498/">PEP 498 – Literal String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0499/">PEP 499 – ``python -m foo`` should bind ``sys.modules[‘foo’]`` in addition to ``sys.modules[‘__main__’]``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0500/">PEP 500 – A protocol for delegating datetime methods to their
tzinfo implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0501/">PEP 501 – General purpose string interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0502/">PEP 502 – String Interpolation - Extended Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0503/">PEP 503 – Simple Repository API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0504/">PEP 504 – Using the System RNG by default</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0505/">PEP 505 – None-aware operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0506/">PEP 506 – Adding A Secrets Module To The Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0507/">PEP 507 – Migrate CPython to Git and GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0508/">PEP 508 – Dependency specification for Python Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0509/">PEP 509 – Add a private version to dict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0510/">PEP 510 – Specialize functions with guards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0511/">PEP 511 – API for code transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0512/">PEP 512 – Migrating from hg.python.org to GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0513/">PEP 513 – A Platform Tag for Portable Linux Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0514/">PEP 514 – Python registration in the Windows registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0515/">PEP 515 – Underscores in Numeric Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0516/">PEP 516 – Build system abstraction for pip/conda etc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0517/">PEP 517 – A build-system independent format for source trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0518/">PEP 518 – Specifying Minimum Build System Requirements for Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0519/">PEP 519 – Adding a file system path protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0520/">PEP 520 – Preserving Class Attribute Definition Order</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0521/">PEP 521 – Managing global context via ‘with’ blocks in generators and coroutines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0522/">PEP 522 – Allow BlockingIOError in security sensitive APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0523/">PEP 523 – Adding a frame evaluation API to CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0524/">PEP 524 – Make os.urandom() blocking on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0525/">PEP 525 – Asynchronous Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0526/">PEP 526 – Syntax for Variable Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0527/">PEP 527 – Removing Un(der)used file types/extensions on PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0528/">PEP 528 – Change Windows console encoding to UTF-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0529/">PEP 529 – Change Windows filesystem encoding to UTF-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0530/">PEP 530 – Asynchronous Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0531/">PEP 531 – Existence checking operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0532/">PEP 532 – A circuit breaking protocol and binary operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0533/">PEP 533 – Deterministic cleanup for iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0534/">PEP 534 – Improved Errors for Missing Standard Library Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0535/">PEP 535 – Rich comparison chaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0536/">PEP 536 – Final Grammar for Literal String Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0537/">PEP 537 – Python 3.7 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0538/">PEP 538 – Coercing the legacy C locale to a UTF-8 based locale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0539/">PEP 539 – A New C-API for Thread-Local Storage in CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0540/">PEP 540 – Add a new UTF-8 Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0541/">PEP 541 – Package Index Name Retention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0542/">PEP 542 – Dot Notation Assignment In Function Header</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0543/">PEP 543 – A Unified TLS API for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0544/">PEP 544 – Protocols: Structural subtyping (static duck typing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0545/">PEP 545 – Python Documentation Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0546/">PEP 546 – Backport ssl.MemoryBIO and ssl.SSLObject to Python 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0547/">PEP 547 – Running extension modules using the -m option</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0548/">PEP 548 – More Flexible Loop Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0549/">PEP 549 – Instance Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0550/">PEP 550 – Execution Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0551/">PEP 551 – Security transparency in the Python runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0552/">PEP 552 – Deterministic pycs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0553/">PEP 553 – Built-in breakpoint()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0554/">PEP 554 – Multiple Interpreters in the Stdlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0555/">PEP 555 – Context-local variables (contextvars)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0556/">PEP 556 – Threaded garbage collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0557/">PEP 557 – Data Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0558/">PEP 558 – Defined semantics for locals()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0559/">PEP 559 – Built-in noop()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0560/">PEP 560 – Core support for typing module and generic types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0561/">PEP 561 – Distributing and Packaging Type Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0562/">PEP 562 – Module __getattr__ and __dir__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0563/">PEP 563 – Postponed Evaluation of Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0564/">PEP 564 – Add new time functions with nanosecond resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0565/">PEP 565 – Show DeprecationWarning in __main__</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0566/">PEP 566 – Metadata for Python Software Packages 2.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0567/">PEP 567 – Context Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0568/">PEP 568 – Generator-sensitivity for Context Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0569/">PEP 569 – Python 3.8 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0570/">PEP 570 – Python Positional-Only Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0571/">PEP 571 – The manylinux2010 Platform Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0572/">PEP 572 – Assignment Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0573/">PEP 573 – Module State Access from C Extension Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0574/">PEP 574 – Pickle protocol 5 with out-of-band data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0575/">PEP 575 – Unifying function/method classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0576/">PEP 576 – Rationalize Built-in function classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0577/">PEP 577 – Augmented Assignment Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0578/">PEP 578 – Python Runtime Audit Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0579/">PEP 579 – Refactoring C functions and methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0580/">PEP 580 – The C call protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0581/">PEP 581 – Using GitHub Issues for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0582/">PEP 582 – Python local packages directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0583/">PEP 583 – A Concurrency Memory Model for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0584/">PEP 584 – Add Union Operators To dict</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0585/">PEP 585 – Type Hinting Generics In Standard Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0586/">PEP 586 – Literal Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0587/">PEP 587 – Python Initialization Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0588/">PEP 588 – GitHub Issues Migration Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0589/">PEP 589 – TypedDict: Type Hints for Dictionaries with a Fixed Set of Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0590/">PEP 590 – Vectorcall: a fast calling protocol for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0591/">PEP 591 – Adding a final qualifier to typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0592/">PEP 592 – Adding “Yank” Support to the Simple API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0593/">PEP 593 – Flexible function and variable annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0594/">PEP 594 – Removing dead batteries from the standard library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0595/">PEP 595 – Improving bugs.python.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0596/">PEP 596 – Python 3.9 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0597/">PEP 597 – Add optional EncodingWarning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0598/">PEP 598 – Introducing incremental feature releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0599/">PEP 599 – The manylinux2014 Platform Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0600/">PEP 600 – Future ‘manylinux’ Platform Tags for Portable Linux Built Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0601/">PEP 601 – Forbid return/break/continue breaking out of finally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0602/">PEP 602 – Annual Release Cycle for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0603/">PEP 603 – Adding a frozenmap type to collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0604/">PEP 604 – Allow writing union types as ``X | Y``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0605/">PEP 605 – A rolling feature release stream for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0606/">PEP 606 – Python Compatibility Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0607/">PEP 607 – Reducing CPython’s Feature Delivery Latency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0608/">PEP 608 – Coordinated Python release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0609/">PEP 609 – PyPA Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0610/">PEP 610 – Recording the Direct URL Origin of installed distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0611/">PEP 611 – The one million limit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0612/">PEP 612 – Parameter Specification Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0613/">PEP 613 – Explicit Type Aliases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0614/">PEP 614 – Relaxing Grammar Restrictions On Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0615/">PEP 615 – Support for the IANA Time Zone Database in the Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0616/">PEP 616 – String methods to remove prefixes and suffixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0617/">PEP 617 – New PEG parser for CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0618/">PEP 618 – Add Optional Length-Checking To zip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0619/">PEP 619 – Python 3.10 Release Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0620/">PEP 620 – Hide implementation details from the C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0621/">PEP 621 – Storing project metadata in pyproject.toml</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0622/">PEP 622 – Structural Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0623/">PEP 623 – Remove wstr from Unicode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0624/">PEP 624 – Remove Py_UNICODE encoder APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0625/">PEP 625 – File name of a Source Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0626/">PEP 626 – Precise line numbers for debugging and other tools.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0627/">PEP 627 – Recording installed projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0628/">PEP 628 – Add ``math.tau``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0629/">PEP 629 – Versioning PyPI’s Simple API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0630/">PEP 630 – Isolating Extension Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0631/">PEP 631 – Dependency specification in pyproject.toml based on PEP 508</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0632/">PEP 632 – Deprecate distutils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0633/">PEP 633 – Dependency specification in pyproject.toml using an exploded TOML table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0634/">PEP 634 – Structural Pattern Matching: Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0635/">PEP 635 – Structural Pattern Matching: Motivation and Rationale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0636/">PEP 636 – Structural Pattern Matching: Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0637/">PEP 637 – Support for indexing with keyword arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0638/">PEP 638 – Syntactic Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0639/">PEP 639 – Metadata for Python Software Packages 2.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0640/">PEP 640 – Unused variable syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0641/">PEP 641 – Using an underscore in the version portion of Python 3.10 compatibility tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0642/">PEP 642 – Explicit Pattern Syntax for Structural Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0643/">PEP 643 – Metadata for Package Source Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0644/">PEP 644 – Require OpenSSL 1.1.1 or newer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0645/">PEP 645 – Allow writing optional types as ``x?``</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0646/">PEP 646 – Variadic Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0647/">PEP 647 – User-Defined Type Guards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0648/">PEP 648 – Extensible customizations of the interpreter at startup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0649/">PEP 649 – Deferred Evaluation Of Annotations Using Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0650/">PEP 650 – Specifying Installer Requirements for Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0651/">PEP 651 – Robust Stack Overflow Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0652/">PEP 652 – Maintaining the Stable ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0653/">PEP 653 – Precise Semantics for Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0654/">PEP 654 – Exception Groups and except*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0655/">PEP 655 – Marking individual TypedDict items as required or potentially-missing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0656/">PEP 656 – Platform Tag for Linux Distributions Using Musl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0657/">PEP 657 – Include Fine Grained Error Locations in Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0658/">PEP 658 – Serve Distribution Metadata in the Simple Repository API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0659/">PEP 659 – Specializing Adaptive Interpreter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0660/">PEP 660 – Editable installs for pyproject.toml based builds (wheel based)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0661/">PEP 661 – Sentinel Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0662/">PEP 662 – Editable installs via virtual wheels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0666/">PEP 666 – Reject Foolish Indentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0754/">PEP 754 – IEEE 754 Floating Point Special Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-0801/">PEP 801 – Reserved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3000/">PEP 3000 – Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3001/">PEP 3001 – Procedure for reviewing and improving standard library modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3002/">PEP 3002 – Procedure for Backwards-Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3003/">PEP 3003 – Python Language Moratorium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3099/">PEP 3099 – Things that will Not Change in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3100/">PEP 3100 – Miscellaneous Python 3.0 Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3101/">PEP 3101 – Advanced String Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3102/">PEP 3102 – Keyword-Only Arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3103/">PEP 3103 – A Switch/Case Statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3104/">PEP 3104 – Access to Names in Outer Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3105/">PEP 3105 – Make print a function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3106/">PEP 3106 – Revamping dict.keys(), .values() and .items()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3107/">PEP 3107 – Function Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3108/">PEP 3108 – Standard Library Reorganization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3109/">PEP 3109 – Raising Exceptions in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3110/">PEP 3110 – Catching Exceptions in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3111/">PEP 3111 – Simple input built-in in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3112/">PEP 3112 – Bytes literals in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3113/">PEP 3113 – Removal of Tuple Parameter Unpacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3114/">PEP 3114 – Renaming iterator.next() to iterator.__next__()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3115/">PEP 3115 – Metaclasses in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3116/">PEP 3116 – New I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3117/">PEP 3117 – Postfix type declarations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3118/">PEP 3118 – Revising the buffer protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3119/">PEP 3119 – Introducing Abstract Base Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3120/">PEP 3120 – Using UTF-8 as the default source encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3121/">PEP 3121 – Extension Module Initialization and Finalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3122/">PEP 3122 – Delineation of the main module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3123/">PEP 3123 – Making PyObject_HEAD conform to standard C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3124/">PEP 3124 – Overloading, Generic Functions, Interfaces, and Adaptation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3125/">PEP 3125 – Remove Backslash Continuation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3126/">PEP 3126 – Remove Implicit String Concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3127/">PEP 3127 – Integer Literal Support and Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3128/">PEP 3128 – BList: A Faster List-like Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3129/">PEP 3129 – Class Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3130/">PEP 3130 – Access to Current Module/Class/Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3131/">PEP 3131 – Supporting Non-ASCII Identifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3132/">PEP 3132 – Extended Iterable Unpacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3133/">PEP 3133 – Introducing Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3134/">PEP 3134 – Exception Chaining and Embedded Tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3135/">PEP 3135 – New Super</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3136/">PEP 3136 – Labeled break and continue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3137/">PEP 3137 – Immutable Bytes and Mutable Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3138/">PEP 3138 – String representation in Python 3000</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3139/">PEP 3139 – Cleaning out sys and the “interpreter” module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3140/">PEP 3140 – str(container) should call str(item), not repr(item)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3141/">PEP 3141 – A Type Hierarchy for Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3142/">PEP 3142 – Add a “while” clause to generator expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3143/">PEP 3143 – Standard daemon process library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3144/">PEP 3144 – IP Address Manipulation Library for the Python Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3145/">PEP 3145 – Asynchronous I/O For subprocess.Popen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3146/">PEP 3146 – Merging Unladen Swallow into CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3147/">PEP 3147 – PYC Repository Directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3148/">PEP 3148 – futures - execute computations asynchronously</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3149/">PEP 3149 – ABI version tagged .so files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3150/">PEP 3150 – Statement local namespaces (aka “given” clause)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3151/">PEP 3151 – Reworking the OS and IO exception hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3152/">PEP 3152 – Cofunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3153/">PEP 3153 – Asynchronous IO support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3154/">PEP 3154 – Pickle protocol version 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3155/">PEP 3155 – Qualified name for classes and functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3156/">PEP 3156 – Asynchronous IO Support Rebooted: the “asyncio” Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-3333/">PEP 3333 – Python Web Server Gateway Interface v1.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8000/">PEP 8000 – Python Language Governance Proposal Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8001/">PEP 8001 – Python Governance Voting Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8002/">PEP 8002 – Open Source Governance Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8010/">PEP 8010 – The Technical Leader Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8011/">PEP 8011 – Python Governance Model Lead by Trio of Pythonistas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8012/">PEP 8012 – The Community Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8013/">PEP 8013 – The External Council Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8014/">PEP 8014 – The Commons Governance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8015/">PEP 8015 – Organization of the Python community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8016/">PEP 8016 – The Steering Council Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8100/">PEP 8100 – January 2019 steering council election</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8101/">PEP 8101 – 2020 Term steering council election</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pep-8102/">PEP 8102 – 2021 Term steering council election</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents/">Documentation overview</a><ul>
      <li>Previous: <a href="../pep-0443/" title="previous chapter">PEP 443 – Single-dispatch generic functions</a></li>
      <li>Next: <a href="../pep-0445/" title="next chapter">PEP 445 – Add new APIs to customize Python memory allocators</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/pep-0444.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>